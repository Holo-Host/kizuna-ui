(this.webpackJsonpui=this.webpackJsonpui||[]).push([[1],[,,,,,function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var a,r,c=n(11),s={USERNAME:"username",PROFILES:"profiles",PREFERENCE:"preference",P2PMESSAGE:"p2pmessage",CONTACTS:"contacts",GROUP:"group",AGGREGATOR:"aggregator"},o=(a={},Object(c.a)(a,s.GROUP,{ADDED_TO_GROUP:"ADDED_TO_GROUP",GROUP_MESSAGE_DATA:"GROUP_MESSAGE_DATA",GROUP_TYPING_DETAIL:"GROUP_TYPING_DETAIL",GROUP_MESSAGE_READ:"GROUP_MESSAGE_READ"}),Object(c.a)(a,s.P2PMESSAGE,{RECEIVE_P2P_MESSAGE:"RECEIVE_P2P_MESSAGE",RECEIVE_P2P_RECEIPT:"RECEIVE_P2P_RECEIPT",SYNC_P2P_PINS:"SYNC_P2P_PINS",TYPING_P2P:"TYPING_P2P"}),a),i=(r={},Object(c.a)(r,s.USERNAME,{SET_USERNAME:"set_username",GET_USERNAMES:"get_usernames",GET_ALL_USERNAMES:"get_all_usernames",GET_AGENT_PUBKEY_FROM_USERNAME:"get_agent_pubkey_from_username",GET_MY_USERNAME:"get_my_username"}),Object(c.a)(r,s.PROFILES,{CREATE_PROFILE:"create_profile",SEARCH_PROFILES:"search_profiles",GET_AGENT_PROFILE:"get_agent_profile",GET_AGENTS_PROFILES:"get_agents_profile",GET_MY_PROFILE:"get_my_profile",GET_ALL_PROFILES:"get_all_profiles"}),Object(c.a)(r,s.CONTACTS,{ADD_CONTACTS:"add_contacts",REMOVE_CONTACTS:"remove_contacts",BLOCK_CONTACTS:"block_contacts",UNBLOCK_CONTACTS:"unblock_contacts",LIST_ADDED:"list_added",LIST_BLOCKED:"list_blocked",IN_CONTACTS:"in_contacts",IN_BLOCKED:"in_blocked"}),Object(c.a)(r,s.PREFERENCE,{GET_PREFERENCE:"get_preference",SET_PREFERENCE:"set_preference",SET_PER_AGENT_PREFERENCE:"set_per_agent_preference",GET_PER_AGENT_PREFERENCE:"get_per_agent_preference",SET_PER_GROUP_PREFERENCE:"set_per_group_preference",GET_PER_GROUP_PREFERENCE:"get_per_group_preference"}),Object(c.a)(r,s.GROUP,{CREATE_GROUP:"create_group",ADD_MEMBERS:"add_members",REMOVE_MEMBERS:"remove_members",UPDATE_GROUP_NAME:"update_group_name",SEND_MESSAGE:"send_message",GET_ALL_MY_GROUPS:"get_all_my_groups",GET_PREVIOUS_GROUP_MESSAGES:"get_previous_group_messages",GET_SUBSEQUENT_GROUP_MESSAGES:"get_subsequent_group_messages",GET_ADJACENT_GROUP_MESSAGES:"get_adjacent_group_messages",GET_MESSAGES_BY_GROUP_BY_TIMESTAMP:"get_messages_by_group_by_timestamp",GET_GROUP_LATEST_VERSION:"get_group_latest_version",INDICATE_GROUP_TYPING:"indicate_group_typing",READ_GROUP_MESSAGE:"read_group_message",GET_FILES_BYTES:"get_files_bytes",PIN_MESSAGE:"pin_message",UNPIN_MESSAGE:"unpin_message",FETCH_PINNED_MESSAGES:"get_pinned_messages"}),Object(c.a)(r,s.AGGREGATOR,{RETRIEVE_LATEST_DATA:"retrieve_latest_data"}),Object(c.a)(r,s.P2PMESSAGE,{SEND_MESSAGE:"send_message",SEND_MESSAGE_WITH_TIMESTAMP:"send_message_with_timestamp",GET_LATEST_MESSAGES:"get_latest_messages",GET_MESSAGES_BY_AGENT_BY_TIMESTAMP:"get_messages_by_agent_by_timestamp",GET_NEXT_BATCH_MESSAGES:"get_next_batch_messages",GET_ALL_MESSAGES:"get_all_messages",READ_MESSAGE:"read_message",GET_FILE_BYTES:"get_file_bytes",TYPING:"typing",PIN_MESSAGE:"pin_message",GET_PINNED_MESSAGES:"get_pinned_messages",GET_NEXT_MESSAGES:"get_next_messages",GET_ADJACENT_MESSAGES:"get_adjacent_messages"}),r)},,,,function(e,t,n){"use strict";(function(e){n.d(t,"h",(function(){return o})),n.d(t,"g",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"i",(function(){return l})),n.d(t,"e",(function(){return p})),n.d(t,"k",(function(){return d})),n.d(t,"d",(function(){return b})),n.d(t,"a",(function(){return j})),n.d(t,"j",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"f",(function(){return O})),n.d(t,"l",(function(){return h}));var a=n(7),r=n(6),c=n(2),s=n(13),o=function(e,t,n){return Object.keys(e).reduce((function(a,r){var c;return n&&(c=n(r)),c?a[c]=t(e[r]):a[r]=t(e[r]),a}),{})},i=function(e,t){switch(e){case 0:return t.formatMessage({id:"app.group-chat.media.month.1"});case 1:return t.formatMessage({id:"app.group-chat.media.month.2"});case 2:return t.formatMessage({id:"app.group-chat.media.month.3"});case 3:return t.formatMessage({id:"app.group-chat.media.month.4"});case 4:return t.formatMessage({id:"app.group-chat.media.month.5"});case 5:return t.formatMessage({id:"app.group-chat.media.month.6"});case 6:return t.formatMessage({id:"app.group-chat.media.month.7"});case 7:return t.formatMessage({id:"app.group-chat.media.month.8"});case 8:return t.formatMessage({id:"app.group-chat.media.month.9"});case 9:return t.formatMessage({id:"app.group-chat.media.month.10"});case 10:return t.formatMessage({id:"app.group-chat.media.month.11"});case 11:return t.formatMessage({id:"app.group-chat.media.month.12"})}},u=function(e){var t=e.getUTCFullYear(),n=e.getMonth()+1,a=e.getDate(),r=n<10?"0".concat(n):n,c=a<10?"0".concat(a):a;return"".concat(t,"-").concat(r,"-").concat(c)},l=function(e){var t=e.split("-"),n=Object(a.a)(t,3),r=n[0],c=n[1],s=n[2],o=c,i=s;return"0"===c.charAt(0)&&(o=c.substring(1)),"0"===s.charAt(0)&&(i=s.substring(1)),new Date(Date.UTC(parseInt(r),parseInt(o)-1,parseInt(i)))},p=function(e){var t={};if(e.length>0){var n=e[0].username.charAt(0).toUpperCase();t[n]=[],e.forEach((function(e){var a=e.username.charAt(0).toUpperCase();a!==n&&(t[n=a]=[]),t[a].push(e)}))}return Object.keys(t).sort().reduce((function(e,n){return e[n]=t[n],e}),{})},d=function(){return Object(s.b)()},b=function(t){return e.from(Object(r.a)(t).buffer)},j=function(e){return e/1024/1024>=1?"".concat((e/1024/1024).toFixed(2),"mb"):"".concat((e/1024).toFixed(2),"kb")},m=function(e){return new Date(.001*e)},f=function(e){return 1e3*e.getTime()},O=function(e){return"TEXT"===e.type},h=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.shouldPreventDefault,s=void 0===r||r,o=n.delay,i=void 0===o?300:o,u=Object(c.useState)(!1),l=Object(a.a)(u,2),p=l[0],d=l[1],b=Object(c.useRef)(),j=Object(c.useRef)(),m=Object(c.useCallback)((function(t){s&&t.target&&(t.target.addEventListener("touchend",g,{passive:!1}),j.current=t.target),t.persist(),b.current=setTimeout((function(){e(t),d(!0)}),i)}),[e,i,s]),f=Object(c.useCallback)((function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];b.current&&clearTimeout(b.current),n&&!p&&t(e),d(!1),s&&j.current&&j.current.removeEventListener("touchend",g)}),[s,t,p]);return{onMouseDown:function(e){return m(e)},onTouchStart:function(e){return m(e)},onMouseUp:function(e){return f(e)},onMouseLeave:function(e){return f(e,!1)},onTouchEnd:function(e){return f(e)}}},g=function(e){(function(e){return"touches"in e})(e)&&e.touches.length<2&&e.preventDefault&&e.preventDefault()}}).call(this,n(47).Buffer)},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return s}));var a=n(18),r=n(74),c=function(e,t,n){return function(a){"TOAST"===e&&a({type:r.a,error:{type:"TOAST",options:t,intl:n}})}},s=function(){return function(e,t){var n=Object(a.a)(t().error.errors);n.length>0&&(n.shift(),e({type:r.b,errors:n}))}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"m",(function(){return r})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"g",(function(){return o})),n.d(t,"h",(function(){return i})),n.d(t,"e",(function(){return u})),n.d(t,"k",(function(){return l})),n.d(t,"f",(function(){return p})),n.d(t,"j",(function(){return d})),n.d(t,"i",(function(){return b})),n.d(t,"l",(function(){return j})),n.d(t,"d",(function(){return m}));var a="ADD_GROUP",r="UPDATE_GROUP_NAME",c="REMOVE_MEMBERS",s="ADD_MEMBERS",o="SET_GROUP_MESSAGE",i="SET_GROUP_MESSAGES",u="SET_ERR_GROUP_MESSAGE",l="SET_LATEST_GROUP_STATE",p="SET_FILES_BYTES",d="SET_GROUP_TYPING_INDICATOR",b="SET_GROUP_READ_MESSAGE",j="SET_PINNNED_MESSAGES",m="SET_CONVERSATIONS"},,,,,,,,,function(e,t,n){"use strict";function a(e){return"TEXT"===e.type}function r(e){return"OTHER"===e.type}function c(e){return"IMAGE"===e.type}function s(e){return"VIDEO"===e.type}function o(e){return void 0!==e.p2pMessageEntryHash}n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return c})),n.d(t,"e",(function(){return s})),n.d(t,"c",(function(){return o}))},,function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"g",(function(){return r})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return s})),n.d(t,"h",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"i",(function(){return l})),n.d(t,"f",(function(){return p}));var a="SET_MESSAGES",r="SET_RECEIPTS",c="SET_ERR_MESSAGE",s="SET_FILES",o="SET_TYPING",i="APPEND_RECEIPT",u="PIN_MESSAGE",l="UNPIN_MESSAGE",p="SET_PINNED"},,,function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}));var a="SET_CONTACTS",r="SET_BLOCKED"},,,,,,function(e,t,n){e.exports={read:"style_read__3GeUO",bubble:"style_bubble__b3vlV",text:"style_text__3mW4k",file:"style_file__2E9_r",space:"style_space__1IgoE","author-name":"style_author-name__2wbPZ",picture:"style_picture__2lzdL","me-container":"style_me-container__1SA7U",me:"style_me__dv2Iw","others-container":"style_others-container__19SEV",others:"style_others__QcKpe",avatar:"style_avatar__3eiPZ","not-delivered":"style_not-delivered__3sCqu","not-delivered-container":"style_not-delivered-container__gnnKW"}},,,,,,function(e,t,n){e.exports={reply:"style_reply__1alfg",row:"style_row__2lZL5",column:"style_column__2fUOQ",author:"style_author__3RrBq",text:"style_text__-M__Q",thumbnail:"style_thumbnail__2NKmm"}},,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}));var a="SET_USERNAME",r="SET_PROFILE"},function(e,t,n){e.exports={mediarow:"style_mediarow__2Kl-B",month:"style_month__G0kAs",mediacard:"style_mediacard__tGTBA"}},,function(e,t,n){e.exports={"content-container":"style_content-container__1pYC1",header:"style_header__3oN7M",author:"style_author__1no5c",date:"style_date__3fX4m",thumbnail:"style_thumbnail__2jeYz",video:"style_video__2c8Ip",other:"style_other__3Q1FT","file-details":"style_file-details__14BgG","file-size":"style_file-size__2Qbcp"}},,,function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return j}));var a=n(4),r=n.n(a),c=n(8),s=n(11),o=n(3),i=n(7),u=n(6),l=n(5),p=n(9),d=n(91),b=function(e,t,n){var a,r=Object(i.a)(e,2),c=r[0],l=r[1],d=Object(i.a)(c,2),b=d[0],j=d[1],m=l,f=Object(i.a)(m,2),O=f[0],h=f[1],g=Object(u.b)(b),y=Object(u.b)(O);switch(j.payload.type){case"TEXT":a=j.payload;break;case"FILE":a={type:"FILE",fileName:j.payload.payload.metadata.fileName,fileSize:j.payload.payload.metadata.fileSize,fileType:j.payload.payload.fileType.type,fileHash:Object(u.b)(j.payload.payload.metadata.fileHash),thumbnail:"OTHER"!==j.payload.payload.fileType.type?j.payload.payload.fileType.payload.thumbnail:null}}var v=Object(o.a)(Object(o.a)({},t),{},Object(s.a)({},n.id,{id:n.id,username:n.username})),x=void 0,_=void 0;if(null!==j.replyTo){switch(j.replyTo.payload.type){case"TEXT":_=j.replyTo.payload;break;case"FILE":_={type:"FILE",fileName:j.replyTo.payload.payload.metadata.fileName,fileSize:j.replyTo.payload.payload.metadata.fileSize,fileType:j.replyTo.payload.payload.fileType.type,fileHash:Object(u.b)(j.replyTo.payload.payload.metadata.fileHash),thumbnail:"OTHER"!==j.replyTo.payload.payload.fileType.type?j.replyTo.payload.payload.fileType.payload.thumbnail:null}}x={p2pMessageEntryHash:Object(u.b)(j.replyTo.hash),author:v[Object(u.b)(j.replyTo.author)],receiver:v[Object(u.b)(j.replyTo.receiver)],payload:_||j.replyTo.payload,timestamp:Object(p.j)(j.replyTo.timeSent),receipts:[]}}var E={p2pMessageEntryHash:g,author:v[Object(u.b)(j.author)],receiver:v[Object(u.b)(j.receiver)],payload:a,timestamp:Object(p.j)(j.timeSent),replyTo:x||void 0,receipts:[y]},T=Object(u.b)(h.id[0]);return{message:E,receipt:{p2pMessageReceiptEntryHash:Object(u.b)(O),p2pMessageEntryHashes:[T],timestamp:Object(p.j)(h.status.timestamp),status:h.status.status},file:void 0}},j=function(t,n,a,s,i){return function(){var p=Object(c.a)(r.a.mark((function c(p,j,m){var f,O,h,g,y,v,x,_,E,T,S,N,I,k,M,w,R;return r.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return f=m.callZome,O=m.retry,"TEXT"===a?(g={type:"TEXT",payload:{payload:n.trim()}},h=g):(y={type:i.fileType.type,payload:"OTHER"!==i.fileType.type?{thumbnail:i.fileType.payload.thumbnail}:null},v={type:"FILE",payload:{metadata:i.metadata,fileType:y,fileBytes:i.fileBytes}},h=v),x={receiver:e.from(Object(u.a)(t)),payload:h,reply_to:s?e.from(Object(u.a)(s)):void 0},r.prev=3,r.next=6,f({zomeName:l.c.P2PMESSAGE,fnName:l.a[l.c.P2PMESSAGE].SEND_MESSAGE,payload:x});case 6:if("error"===(null===(_=r.sent)||void 0===_?void 0:_.type)){r.next=15;break}return E=Object(o.a)({},j().contacts.contacts),T=Object(o.a)({},j().profile),S=b(_,E,T),N="FILE"===a?{fileHash:S.message.payload.fileHash,fileBytes:i.fileBytes}:void 0,S.file=N,p(Object(d.a)(S)),r.abrupt("return",!0);case 15:r.next=30;break;case 17:if(r.prev=17,r.t0=r.catch(3),r.prev=19,r.t0.message.includes("Timed out")){r.next=25;break}return r.next=23,O({zomeName:l.c.P2PMESSAGE,fnName:l.a[l.c.P2PMESSAGE].SEND_MESSAGE,payload:x});case 23:"error"!==(null===(I=r.sent)||void 0===I?void 0:I.type)&&(k=Object(o.a)({},j().contacts.contacts),M=Object(o.a)({},j().profile),w=b(I,k,M),R="FILE"===a?{fileHash:w.message.payload.fileHash,fileBytes:i.fileBytes}:void 0,w.file=R,p(Object(d.a)(w)));case 25:r.next=30;break;case 27:return r.prev=27,r.t1=r.catch(19),r.abrupt("return",!1);case 30:case"end":return r.stop()}}),c,null,[[3,17],[19,27]])})));return function(e,t,n){return p.apply(this,arguments)}}()}}).call(this,n(47).Buffer)},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return s}));var a="HOLO",r=function(){return"HC"===a||"HCDEV"===a?"kizuna":"HCC"===a?"uhCkkHSLbocQFSn5hKAVFc_L34ssLD52E37kq6Gw9O3vklQ3Jv7eL":void 0},c=function(){return"HC"===a?"ws://localhost:8888":"HCDEV"===a?"ws://127.0.0.1:8888/":"HCC"===a?"http://localhost:24273":"HOLO"===a?"https://devnet-chaperone.holo.host":null},s=function(){return"HCC"===a||"HOLO"===a}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(7),r=n(6),c=n(9),s=function(e,t){for(var n=Object.values(e),s=n[0],o=n[1],i=n[2],u={},l=0,p=Object.entries(s);l<p.length;l++){var d=Object(a.a)(p[l],2),b=d[0],j={messages:d[1],pinned:s[b]?s[b].pinned:[]};u[b]=j}for(var m={},f=0,O=Object.entries(o);f<O.length;f++){var h=Object(a.a)(O[f],2),g=h[0],y=h[1],v=Object(y),x=v[0],_=v[1],E=void 0;switch(x.payload.type){case"TEXT":E=x.payload;break;case"FILE":E={type:"FILE",fileName:x.payload.payload.metadata.fileName,fileSize:x.payload.payload.metadata.fileSize,fileType:x.payload.payload.fileType.type,fileHash:Object(r.b)(x.payload.payload.metadata.fileHash),thumbnail:"OTHER"!==x.payload.payload.fileType.type?x.payload.payload.fileType.payload.thumbnail:null}}var T=t[Object(r.b)(x.author)],S=void 0,N=void 0;if(null!==x.replyTo){switch(x.replyTo.payload.type){case"TEXT":S=x.replyTo.payload;break;case"FILE":S={type:"FILE",fileName:x.replyTo.payload.payload.metadata.fileName,fileSize:x.replyTo.payload.payload.metadata.fileSize,fileType:x.replyTo.payload.payload.fileType.type,fileHash:Object(r.b)(x.replyTo.payload.payload.metadata.fileHash),thumbnail:"OTHER"!==x.replyTo.payload.payload.fileType.type?x.replyTo.payload.payload.fileType.payload.thumbnail:null}}N={p2pMessageEntryHash:Object(r.b)(x.replyTo.hash),author:t[Object(r.b)(x.replyTo.author)],receiver:t[Object(r.b)(x.replyTo.receiver)],payload:S||x.replyTo.payload,timestamp:Object(c.j)(x.replyTo.timeSent),replyTo:x.replyTo,receipts:x.replyTo.receipts}}var I={p2pMessageEntryHash:g,author:T,receiver:t[Object(r.b)(x.receiver)],payload:E,timestamp:Object(c.j)(x.timeSent),replyTo:N||void 0,receipts:_};m[g]=I}for(var k={},M=0,w=Object.entries(i);M<w.length;M++){var R=Object(a.a)(w[M],2),P=R[0],G=R[1],C=Object(G),A=C.id,L=C.status,D=L.status,H=L.timestamp,F={p2pMessageReceiptEntryHash:P,p2pMessageEntryHashes:A,timestamp:Object(c.j)(H),status:D};k[P]=F}return{conversations:u,messages:m,receipts:k,files:{},typing:{},pinned:{},errMsgs:{}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a="SET_PREFERENCE"},,,,,,function(e,t,n){e.exports={"reply-to":"style_reply-to__1ZpXG","content-me":"style_content-me__14mTi","content-others":"style_content-others__2kxSL",thumbnail:"style_thumbnail__2u4oc","vertical-divider-me":"style_vertical-divider-me__3eT7d","vertical-divider-others":"style_vertical-divider-others__dj7Rl"}},,function(e,t,n){e.exports={page:"style_page__22EBt","language-container":"style_language-container__2begU",language:"style_language__28kvF",selected:"style_selected__3wGAX"}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));var a="PUSH_ERROR",r="SHIFT_ERROR"},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return j}));var a=n(4),r=n.n(a),c=n(11),s=n(3),o=n(8),i=n(6),u=n(5),l=n(15),p=n(9),d=n(61),b=n(104),j=function(t,n,a,j,m){return function(){var f=Object(o.a)(r.a.mark((function o(f,O,h){var g,y,v,x,_,E,T;return r.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return g=h.callZome,y={conversant:e.from(Object(i.a)(t)),batch_size:n,payload_type:a,last_fetched_timestamp:j?Object(p.c)(j):void 0,last_fetched_message_id:m?e.from(Object(i.a)(m)):void 0},r.prev=2,r.next=5,g({zomeName:u.c.P2PMESSAGE,fnName:u.a[u.c.P2PMESSAGE].GET_NEXT_BATCH_MESSAGES,payload:y});case 5:if("error"===(null===(v=r.sent)||void 0===v?void 0:v.type)){r.next=13;break}return x=Object(s.a)({},O().contacts.contacts),_=Object(s.a)({},O().profile),E=Object(s.a)(Object(s.a)({},x),{},Object(c.a)({},_.id,{id:_.id,username:_.username})),T=Object(d.a)(v,E),Object.values(v[1]).length>0&&f(Object(b.a)(T)),r.abrupt("return",v);case 13:r.next=18;break;case 15:r.prev=15,r.t0=r.catch(2),f(Object(l.a)("TOAST",{},{id:"redux.err.generic"}));case 18:case"end":return r.stop()}}),o,null,[[2,15]])})));return function(e,t,n){return f.apply(this,arguments)}}()}}).call(this,n(47).Buffer)},function(e,t,n){e.exports={header:"style_header__3FlxA",groupname:"style_groupname__olSXj"}},function(e,t,n){e.exports={list:"style_list__N7t6V","contacts-list":"style_contacts-list__20Yc_",warning:"style_warning__3mGhB","warning-icon":"style_warning-icon__3lrr_"}},,,function(e,t,n){"use strict";n.d(t,"b",(function(){return a}));n(2);var a,r=n(13),c=n(3),s=n(92),o=n(189),i=n(84),u=n(30),l={contacts:{},blocked:{}},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u.b:return Object(c.a)(Object(c.a)({},e),{},{contacts:t.contacts});case u.a:return Object(c.a)(Object(c.a)({},e),{},{blocked:t.blocked});default:return e}},d=n(16),b={conversations:{},messages:{},groupFiles:{},members:{},typing:{},pinnedMessages:{},errMsgs:{}},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case d.a:case d.b:case d.c:return Object(c.a)(Object(c.a)({},e),{},{conversations:t.conversations,members:t.members});case d.m:return Object(c.a)(Object(c.a)({},e),{},{conversations:t.conversations});case d.g:return Object(c.a)(Object(c.a)({},e),{},{conversations:t.conversations,messages:t.messages,groupFiles:t.groupFiles});case d.e:return Object(c.a)(Object(c.a)({},e),{},{errMsgs:t.errMsgs});case d.f:return Object(c.a)(Object(c.a)({},e),{},{groupFiles:t.filesBytes});case d.h:return Object(c.a)(Object(c.a)({},e),{},{messages:t.messages,conversations:t.conversations});case d.k:return Object(c.a)(Object(c.a)({},e),{},{conversations:t.conversations,messages:t.messages,members:t.members});case d.j:return Object(c.a)(Object(c.a)({},e),{},{typing:t.typing});case d.i:return Object(c.a)(Object(c.a)({},e),{},{messages:Object(c.a)({},t.messages)});case d.l:var n=Object(c.a)({},t),a=n.conversations,r=n.pinnedMessages;return Object(c.a)(Object(c.a)({},e),{},{conversations:a,pinnedMessages:r});case d.d:var s=t.conversations;return Object(c.a)(Object(c.a)({},e),{},{conversations:s});default:return e}},m=n(62),f={readReceipt:!1,typingIndicator:!1,agentReadReceipt:{},agentTypingIndicator:{},groupReadReceipt:{},groupTypingIndicator:{}},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m.a:return Object(c.a)(Object(c.a)({},e),t.preference);default:return e}},h=n(48),g={id:null,username:null},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h.b:return Object(c.a)(Object(c.a)({},e),{},{username:t.username,id:t.id});case h.a:return Object(c.a)(Object(c.a)({},e),{},{username:t.nickname,id:t.id});default:return e}},v=n(27),x={conversations:{},messages:{},receipts:{},files:{},typing:{},pinned:{},errMsgs:{}},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v.e:return Object(c.a)(Object(c.a)({},e),{},{conversations:t.state.conversations,messages:t.state.messages,receipts:t.state.receipts});case v.c:return Object(c.a)(Object(c.a)({},e),{},{errMsgs:t.state.errMsgs});case v.g:return Object(c.a)(Object(c.a)({},e),{},{receipts:t.state});case v.d:return Object(c.a)(Object(c.a)({},e),{},{files:t.state});case v.h:return Object(c.a)(Object(c.a)({},e),{},{typing:t.state});case v.f:return Object(c.a)(Object(c.a)({},e),{},{conversations:t.state.conversations,pinned:t.state.pinned});default:return e}},E=n(105),T={language:null},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case E.a:return localStorage.setItem("language",t.language),Object(c.a)(Object(c.a)({},e),{},{language:t.language});default:return e}},N=n(18),I=n(74),k={errors:[]},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case I.a:var n=[].concat(Object(N.a)(e.errors),[t.error]);return Object(c.a)(Object(c.a)({},e),{},{errors:n});case I.b:return Object(c.a)(Object(c.a)({},e),{},{errors:t.errors});default:return e}},w=Object(s.b)({profile:y,contacts:p,preference:O,groups:j,p2pmessages:_,language:S,error:M}),R=function(e){var t=o.a.withExtraArgument(Object(c.a)({callZome:i.a,getAgentId:i.c,retry:i.e,client:i.b,init:i.d},e));return Object(s.c)(w,Object(s.a)(t))},P=n(0);a=R();t.a=function(e){var t=e.children;return Object(P.jsx)(r.a,{store:a,children:t})}},function(e,t,n){e.exports={controls:"style_controls__2gscS","play-pause":"style_play-pause__2Bgys","range-slider-expand":"style_range-slider-expand__1y37Y","range-slider":"style_range-slider__1leiI","slider-volume":"style_slider-volume__1u5c4"}},function(e,t,n){e.exports={content:"style_content__U_pdz","play-pause":"style_play-pause__1sBQt","modal-control":"style_modal-control__2LLvX","slider-volume":"style_slider-volume__37ujv",toolbar:"style_toolbar__3aY0h"}},function(e,t,n){e.exports={"member-page":"style_member-page__2gB0m",icon:"style_icon__7xzbp","member-title":"style_member-title__2-_Xp","member-name":"style_member-name__1hzQW"}},function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return b})),n.d(t,"d",(function(){return f})),n.d(t,"c",(function(){return O})),n.d(t,"e",(function(){return g})),n.d(t,"a",(function(){return y}));var a=n(3),r=n(4),c=n.n(r),s=n(8),o=n(144),i=n(192),u=n(80),l=n(193),p=n(58);e.COMB=void 0;var d=n(240).Connection;window.COMB=n(127).COMB;var b=null,j=function(e){return null===u.b||void 0===u.b?void 0:u.b.dispatch(Object(l.a)(e.data.payload.name,e.data.payload.payload))},m=function(){var e=Object(s.a)(c.a.mark((function e(t){var n,a,r,s,u,l,b;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next="HOLO"===e.t0||"HCC"===e.t0?3:"HCDEV"===e.t0||"HC"===e.t0?17:26;break;case 3:return a=new d("https://devnet-chaperone.holo.host",j,n={logo_url:"assets/icon/kizuna_logo.png",app_name:"Kizuna Messaging App"}),e.next=7,a.ready();case 7:return e.next=9,a.signIn();case 9:return e.next=11,a.appInfo(Object(p.b)());case 11:if((r=e.sent).cell_data){e.next=14;break}throw new Error("Holo appInfo() failed: ".concat(JSON.stringify(r)));case 14:return(s=r.cell_data[0]).cell_id[0]instanceof Uint8Array||(s.cell_id=[new Uint8Array(s.cell_id[0].data),new Uint8Array(s.cell_id[1].data)]),e.abrupt("return",new o.a(a,s,n));case 17:return e.next=19,i.AppWebsocket.connect(Object(p.c)(),15e3,j);case 19:return u=e.sent,e.next=22,u.appInfo({installed_app_id:Object(p.b)()});case 22:return l=e.sent,console.log(Object(p.b)()),b=l.cell_data[0],e.abrupt("return",new o.b(u,b));case 26:return e.abrupt("return",null);case 27:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(s.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!b){e.next=2;break}return e.abrupt("return",b);case 2:return e.prev=2,console.log("ENV : ",p.a),console.log("production"),e.next=7,m(p.a);case 7:return b=e.sent,console.log("ENV : ",b),e.abrupt("return",b);case 12:throw e.prev=12,e.t0=e.catch(2),Object.values(e.t0).forEach((function(e){return console.error(e)})),console.error(e.t0),e.t0;case 17:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(){return e.apply(this,arguments)}}(),O=function(){var e=Object(s.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;break;case 2:return e.next=4,f();case 4:return e.prev=4,e.next=7,null===(t=b)||void 0===t?void 0:t.cellId[1];case 7:if(!(n=e.sent)){e.next=10;break}return e.abrupt("return",n);case 10:return e.abrupt("return",null);case 13:e.prev=13,e.t0=e.catch(4),console.warn(e.t0);case 16:return e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(){return e.apply(this,arguments)}}(),h=function(e){var t=1e3*(Math.pow(2,e)+Math.random());return console.log("Retrying after ",t),new Promise((function(e){return setTimeout(e,t)}))},g=function(){var e=Object(s.a)(c.a.mark((function e(t){var n,r,s,o,i,u,l,p,d,j,m,O,g,y;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("entering backoff"),e.next=3,f();case 3:n=t.zomeName,r=t.fnName,s=t.payload,o=void 0===s?null:s,i=5,u=0,l=!0;case 7:if(!(l&&u<i)){e.next=56;break}return e.prev=8,e.next=11,null===(p=b)||void 0===p?void 0:p.callZome(n,r,o);case 11:return e.abrupt("return",e.sent);case 14:if(e.prev=14,e.t0=e.catch(8),console.warn(e.t0),d=Object(a.a)({},e.t0),j=d.type,m=void 0===j?null:j,O=d.data,g=void 0===O?null:O,"error"!==m){e.next=54;break}console.warn(r),e.t1=null===g||void 0===g?void 0:g.type,e.next="ribosome_error"===e.t1?23:"internal_error"===e.t1?37:46;break;case 23:if(console.log("ribsosome error",e.t0),null===/Network error/.exec(g.data)){e.next=32;break}return e.next=29,h(u);case 29:u+=1,e.next=36;break;case 32:throw l=!1,y=/Guest\("([\s\S]*?)"\)/.exec(g.data),{type:"error",function:r,message:y?y[1]:"Something went wrong"};case 36:return e.abrupt("break",54);case 37:if(console.log("internal error",e.t0),!(u>i)){e.next=42;break}throw{type:"error",function:r,message:"An internal error occured. This is likely a bug in holochain."};case 42:return e.next=44,h(u);case 44:u+=1;case 45:return e.abrupt("break",54);case 46:if(console.log("default error",e.t0),!(u>i)){e.next=51;break}throw e.t0;case 51:return e.next=53,h(u);case 53:u+=1;case 54:e.next=7;break;case 56:case"end":return e.stop()}}),e,null,[[8,14]])})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(s.a)(c.a.mark((function e(t){var n,r,s,o,i,u,l,p,d,j,m;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:return n=t.zomeName,r=t.fnName,s=t.payload,o=void 0===s?null:s,e.prev=3,e.next=6,null===(i=b)||void 0===i?void 0:i.callZome(n,r,o);case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),console.log("zome call has failed in zome: ",n," with call ",r," error: ",e.t0),u=Object(a.a)({},e.t0),l=u.type,p=void 0===l?null:l,d=u.data,j=void 0===d?null:d,"error"!==p){e.next=22;break}e.t1=null===j||void 0===j?void 0:j.type,e.next="ribosome_error"===e.t1?17:"internal_error"===e.t1?20:21;break;case 17:throw m=/Guest\("([\s\S]*?)"\)/.exec(j.data),{type:"error",function:r,message:m?m[1]:"Something went wrong"};case 20:throw{type:"error",function:r,message:"An internal error occured. This is likely a bug in holochain."};case 21:case 22:throw e.t0;case 23:case"end":return e.stop()}}),e,null,[[3,9]])})));return function(t){return e.apply(this,arguments)}}()}).call(this,n(71))},,,,,,function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return j}));var a=n(4),r=n.n(a),c=n(7),s=n(11),o=n(3),i=n(8),u=n(6),l=n(5),p=n(15),d=n(27),b=n(61),j=function(t){return function(){var n=Object(i.a)(r.a.mark((function n(a,i,j){var m,f,O,h,g,y,v,x,_,E,T,S,N,I,k,M,w,R,P,G,C,A;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return m=j.callZome,n.prev=1,n.next=4,m({zomeName:l.c.P2PMESSAGE,fnName:l.a[l.c.P2PMESSAGE].GET_PINNED_MESSAGES,payload:e.from(Object(u.a)(t))});case 4:if("error"===(null===(f=n.sent)||void 0===f?void 0:f.type)){n.next=57;break}if(O=Object(o.a)({},i().contacts.contacts),h=Object(o.a)({},i().profile),g=Object(o.a)(Object(o.a)({},O),{},Object(s.a)({},h.id,{id:h.id,username:h.username})),y=Object(b.a)(f,g),void 0!==(v=Object(o.a)({},i().p2pmessages)).conversations[t]){n.next=27;break}v.conversations[t]={messages:[],pinned:[]},x=0,_=Object.entries(y.messages);case 14:if(!(x<_.length)){n.next=25;break}if(E=Object(c.a)(_[x],2),T=E[0],S=E[1],v.conversations[t].pinned.includes(T)||v.conversations[t].pinned.push(T),void 0!==v.pinned[T]){n.next=21;break}v.pinned[T]=S,n.next=22;break;case 21:return n.abrupt("continue",22);case 22:x++,n.next=14;break;case 25:n.next=55;break;case 27:if(void 0!==v.conversations[t].pinned){n.next=43;break}v.conversations[t].pinned=[],N=0,I=Object.entries(y.messages);case 30:if(!(N<I.length)){n.next=41;break}if(k=Object(c.a)(I[N],2),M=k[0],w=k[1],v.conversations[t].pinned.includes(M)||v.conversations[t].pinned.push(M),void 0!==v.pinned[M]){n.next=37;break}v.pinned[M]=w,n.next=38;break;case 37:return n.abrupt("continue",38);case 38:N++,n.next=30;break;case 41:n.next=55;break;case 43:R=0,P=Object.entries(y.messages);case 44:if(!(R<P.length)){n.next=55;break}if(G=Object(c.a)(P[R],2),C=G[0],A=G[1],v.conversations[t].pinned.includes(C)||v.conversations[t].pinned.push(C),void 0!==v.pinned[C]){n.next=51;break}v.pinned[C]=A,n.next=52;break;case 51:return n.abrupt("continue",52);case 52:R++,n.next=44;break;case 55:return a({type:d.f,state:v}),n.abrupt("return",y);case 57:n.next=62;break;case 59:n.prev=59,n.t0=n.catch(1),a(Object(p.a)("TOAST",{},{id:"redux.err.generic"}));case 62:case"end":return n.stop()}}),n,null,[[1,59]])})));return function(e,t,a){return n.apply(this,arguments)}}()}}).call(this,n(47).Buffer)},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(4),r=n.n(a),c=n(11),s=n(18),o=n(3),i=n(8),u=n(27),l=function(e){return function(){var t=Object(i.a)(r.a.mark((function t(n,a){var i,l,p,d;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=Object(o.a)({},a().p2pmessages),l=e.key?e.key:e.message.receiver.id,p=e.message.p2pMessageEntryHash,d=e.receipt.p2pMessageReceiptEntryHash,i.conversations[l]?i.conversations[l]={pinned:Object(s.a)(i.conversations[l].pinned),messages:[p].concat(Object(s.a)(i.conversations[l].messages))}:i.conversations[l]={messages:[p],pinned:[]},e.file&&(i.files[e.file.fileHash]=e.file.fileBytes),i.messages=Object(o.a)(Object(o.a)({},i.messages),{},Object(c.a)({},p,e.message)),i.receipts=Object(o.a)(Object(o.a)({},i.receipts),{},Object(c.a)({},d,e.receipt)),n({type:u.e,state:i}),t.abrupt("return",!0);case 10:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}},,function(e,t,n){e.exports={file:"style_file__27RDJ","file-name":"style_file-name__3vGib","file-size":"style_file-size__2GKYG","file-icon-dark":"style_file-icon-dark__2I31W","file-icon-light":"style_file-icon-light__1U9Kf"}},function(e,t,n){e.exports={login:"style_login__1hf3N",form:"style_form__1gyhK",label:"style_label__1PI6L",toolbar:"style_toolbar__17MVN"}},function(e,t,n){e.exports={input:"style_input__2l0cM","error-input":"style_error-input__2EDgX","error-container":"style_error-container__2w9sT",error:"style_error__3-HlZ"}},function(e,t,n){e.exports={register:"style_register__1IRba",form:"style_form__2MPyA",label:"style_label__2XMD-",toolbar:"style_toolbar__jcPVP"}},,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(18),r=n(7),c=n(3),s=n(27),o=function(e){return function(t,n){for(var o=Object(c.a)({},n().p2pmessages),i=e.conversations,u=e.messages,l=e.receipts,p=0,d=Object.entries(i);p<d.length;p++){var b=Object(r.a)(d[p],2),j=b[0],m=b[1],f=o.conversations[j];o.conversations[j]=void 0===f?{messages:m.messages,pinned:[]}:{messages:Object(a.a)(new Set(f.messages.concat(m.messages))),pinned:[]}}return o.messages=Object(c.a)(Object(c.a)({},o.messages),u),o.receipts=Object(c.a)(Object(c.a)({},o.receipts),l),t({type:s.e,state:o}),!0}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a="SET_LANGUAGE"},,,,,,,,,,,,,function(e,t,n){e.exports={toolbar:"style_toolbar__2dB4u",content:"style_content__1CXxF"}},function(e,t,n){e.exports={chat:"style_chat__3kLZ6","title-container":"style_title-container__E-R-r",title:"style_title__1l1FZ",avatar:"style_avatar__1SPMS"}},function(e,t,n){e.exports={chatdetails:"style_chatdetails__1PZL-",titlebar:"style_titlebar__3OOiT",title:"style_title__3P2qo",month:"style_month__1RYcT",mediarow:"style_mediarow__1VBzj",mediacard:"style_mediacard__3gdyr",mediadiv:"style_mediadiv__2fS_a",filelist:"style_filelist__1FxpQ",filecard:"style_filecard__29HIk"}},function(e,t,n){e.exports={title:"style_title__37T1W","title-container":"style_title-container__nJyXL",avatar:"style_avatar__I9T18"}},function(e,t,n){e.exports={contacts:"style_contacts__3Y8Wl","close-label":"style_close-label__1yiho","close-button":"style_close-button__3-eYH"}},function(e,t,n){e.exports={header:"style_header__1GbNk",nickname:"style_nickname__36IXj","profile-toolbar":"style_profile-toolbar__3bqXt",content:"style_content__2vCA9","content-icon":"style_content-icon__2luvw"}},function(e,t,n){e.exports={landing:"style_landing__1AJBK",logo:"style_logo__1i6xk",landingImage:"style_landingImage__3JKn5",actions:"style_actions__2DAvl","register-label":"style_register-label__3U74A"}},,,,function(e,t,n){e.exports={menu:"style_menu__C0WwI",container:"style_container__3CTeu",avatar:"style_avatar__2ofpZ"}},,,,function(e,t,n){e.exports={icon:"style_icon__-mJ3j"}},function(e,t,n){e.exports={"video-player":"style_video-player__pxhnt",video:"style_video__10sA-",content:"style_content__3iRlb","modal-control":"style_modal-control__1fdb7","slider-volume":"style_slider-volume__6jcJU"}},function(e,t,n){e.exports={video:"style_video__2ufHy"}},function(e,t,n){e.exports={typing:"style_typing__203NC",dot:"style_dot__1YRwn"}},function(e,t,n){e.exports={row:"style_row__RQQHj",chip:"style_chip__3-Ro1"}},function(e,t,n){e.exports={toolbar:"style_toolbar__3sSyu","file-view":"style_file-view__2lYJo",col:"style_col__3sOY-","close-button":"style_close-button__2AE8Y",textarea:"style_textarea___6FLN"}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return i}));var a=n(4),r=n.n(a),c=n(8),s=n(6),o=n(5),i=function(t,n){return function(){var a=Object(c.a)(r.a.mark((function a(c,i,u){var l,p;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return l=u.callZome,p={agent:e.from(Object(s.a)(t)),isTyping:n},a.next=4,l({zomeName:o.c.P2PMESSAGE,fnName:o.a[o.c.P2PMESSAGE].TYPING,payload:p});case 4:return a.abrupt("return",null);case 5:case"end":return a.stop()}}),a)})));return function(e,t,n){return a.apply(this,arguments)}}()}}).call(this,n(47).Buffer)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return p}));var a=n(4),r=n.n(a),c=n(3),s=n(8),o=n(6),i=n(5),u=n(9),l=n(27),p=function(t){return function(){var n=Object(s.a)(r.a.mark((function n(a,s,p){var d,b,j,m,f,O,h,g,y,v;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return d=p.callZome,b=Object(u.c)(new Date),j=Object(c.a)({},s().p2pmessages),m=[],t.map((function(e){return m.push(Object(o.a)(e.p2pMessageEntryHash))})),f=[e.from(Object(o.a)(t[0].author.id)),e.from(Object(o.a)(t[0].receiver.id))],O={message_hashes:m,conversants:f,timestamp:b,status:j.pinned[t[0].p2pMessageEntryHash]?"Unpinned":"Pinned"},n.prev=7,n.next=10,d({zomeName:i.c.P2PMESSAGE,fnName:i.a[i.c.P2PMESSAGE].PIN_MESSAGE,payload:O});case 10:return h=n.sent,g=Object.values(h)[0],y=g.status,v=s().profile.id===g.conversants[0]?Object(o.b)(g.conversants[0]):Object(o.b)(g.conversants[1]),g.id.forEach((function(e){var t=Object(o.b)(e),n=j.messages[t];if(j.conversations[v]&&(j.conversations[v].pinned||(j.conversations[v].pinned=[]),"pinned"===y&&(j.conversations[v].pinned.includes(t)||j.conversations[v].pinned.push(t),j.pinned[t]||(j.pinned[t]=n)),"unpined"===y)){if(j.conversations[v].pinned.includes(t)){var a=j.conversations[v].pinned.indexOf(t);a>-1&&j.conversations[v].pinned.splice(a,1)}j.pinned[t]&&delete j.pinned[t]}})),a({type:l.f,state:j}),n.abrupt("return",!0);case 19:n.prev=19,n.t0=n.catch(7);case 21:return n.abrupt("return",!1);case 22:case"end":return n.stop()}}),n,null,[[7,19]])})));return function(e,t,a){return n.apply(this,arguments)}}()}}).call(this,n(47).Buffer)},function(e,t,n){e.exports={container:"style_container__3nacn"}},function(e,t,n){e.exports={search:"style_search__1P1Jo"}},function(e,t,n){e.exports={"contacts-list":"style_contacts-list__2633z","add-label":"style_add-label__3UjKf","my-custom-modal-css":"style_my-custom-modal-css__2_5sM","modal-wrapper":"style_modal-wrapper__1uXqE",modal:"style_modal__3XaVG"}},function(e,t,n){e.exports={recipients:"style_recipients__3Tz9O",to:"style_to__3Gtm8"}},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){e.exports={spinner:"style_spinner__1BA-o"}},,function(e,t,n){e.exports={icon:"style_icon__2nRa9"}},,function(e,t,n){e.exports={chat:"style_chat__2rr5Z","item-inner":"style_item-inner__3Pzc7"}},function(e,t,n){e.exports={image:"style_image__1PE4_"}},function(e,t,n){e.exports={me:"style_me__3fhVY",others:"style_others__1jm3i"}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return p}));var a=n(4),r=n.n(a),c=n(7),s=n(8),o=n(6),i=n(5),u=n(27),l=n(9),p=function(t){return function(){var n=Object(s.a)(r.a.mark((function n(a,s,p){var d,b,j,m,f,O,h,g,y,v,x,_;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return d=p.callZome,b=new Date,j=Object(l.c)(b),m=[],t.map((function(e){return m.push(Object(o.a)(e.p2pMessageEntryHash))})),f=e.from(Object(o.a)(t[0].author.id)),O={message_hashes:m,sender:f,timestamp:j},n.next=9,d({zomeName:i.c.P2PMESSAGE,fnName:i.a[i.c.P2PMESSAGE].READ_MESSAGE,payload:O});case 9:if("error"===(null===(h=n.sent)||void 0===h?void 0:h.type)){n.next=17;break}return g=Object.keys(h),y=Object(c.a)(g,1),v=y[0],x=[],h[v].id.forEach((function(e){x.push(Object(o.b)(e))})),_={p2pMessageReceiptEntryHash:v,p2pMessageEntryHashes:x,timestamp:Object(l.j)(h[v].status.timestamp),status:h[v].status.status},a({type:u.a,state:_}),n.abrupt("return",!0);case 17:return n.abrupt("return",!1);case 18:case"end":return n.stop()}}),n)})));return function(e,t,a){return n.apply(this,arguments)}}()}}).call(this,n(47).Buffer)},function(e,t,n){e.exports={label:"style_label__2yePJ"}},function(e,t,n){e.exports={"contacts-list":"style_contacts-list__1o7GN"}},function(e,t,n){e.exports={"contacts-list":"style_contacts-list__3gSNv"}},function(e,t,n){e.exports={"empty-contacts":"style_empty-contacts__JmFbZ"}},function(e,t,n){e.exports={avatar:"style_avatar__1CVEO"}},function(e,t,n){e.exports={"empty-conversations":"style_empty-conversations__2L30A"}},function(e,t,n){e.exports={conversation:"style_conversation__28KWI","empty-conversations":"style_empty-conversations__1_1Ss"}},function(e,t,n){e.exports={"home-tab-bar":"style_home-tab-bar__2vOP6"}},function(e,t,n){e.exports={header:"style_header__3PkRv"}},function(e,t,n){e.exports={"popover-list":"style_popover-list__14lHb"}},function(e,t,n){e.exports={"settings-list":"style_settings-list__i3vNl"}},function(e){e.exports=JSON.parse('{"app.chat.chat-details.files":"FILES","app.chat.chat-details.info":"INFO","app.chat.chat-details.media":"MEDIA","app.chat.header-details":"Details","app.chat.header-pinned-messages":"Pinned Messages","app.chat.header-search":"Search","app.chat.pinned-message-title":"Pinned Messages","app.contacts.add":"Add to contacts","app.contacts.add-message":"{name} has been added to your contacts","app.contacts.block":"Block profile","app.contacts.empty-contact-list":"Your contact list is empty as of the moment","app.contacts.remove":"Remove from contacts","app.contacts.search":"Search with minimum 3 characters...","app.contacts.search-nickname-warning":"The minimum length for search is 3 characters","app.contacts.unblock":"Unblock profile","app.conversations.empty-conversations":"You have no conversations yet...","app.conversations.no-group-messages":"No message has been sent yet...","app.group-chat.add-member":"Add","app.group-chat.add-member-close":"Close","app.group-chat.add-member-contacts":"Contacts","app.group-chat.add-members":"Add Members","app.group-chat.admin-role":"admin","app.group-chat.fetching":"Fetching...","app.group-chat.files.fetching":"Fetching files...","app.group-chat.files.no-files":"There is no file sent in the chat yet...","app.group-chat.header-details":"Details","app.group-chat.header-pinned-message":"Pinned Messages","app.group-chat.header-search":"Search","app.group-chat.label-files":"FILES","app.group-chat.label-info":"INFO","app.group-chat.label-media":"MEDIA","app.group-chat.media.fetching":"Fetching media...","app.group-chat.media.month.1":"January","app.group-chat.media.month.2":"February","app.group-chat.media.month.3":"March","app.group-chat.media.month.4":"April","app.group-chat.media.month.5":"May","app.group-chat.media.month.6":"June","app.group-chat.media.month.7":"July","app.group-chat.media.month.8":"August","app.group-chat.media.month.9":"Septmember","app.group-chat.media.month.10":"October","app.group-chat.media.month.11":"November","app.group-chat.media.month.12":"December","app.group-chat.media.no-media":"There is no media sent in the chat yet...","app.group-chat.member-role":"member","app.group-chat.members":"{length} members","app.group-chat.members-label":"Members","app.group-chat.minimum-member-required-reached":"The group must at leaset have 3 members","app.group-chat.no-member-to-add":"You have no one to add right now...","app.group-chat.oldest-message-fetched":"You have already fetched the oldest message","app.group-chat.pinned-message-title":"Pinned Messages","app.group-chat.remove-member":"REMOVE","app.group-chat.sending":"Sending...","app.group-chat.update-group-name-cancel":"Cancel","app.group-chat.update-group-name-placeholder":"Group Name","app.group-chat.update-group-name-save":"Save","app.group-chat.update-group-name-title":"Edit Group","app.home.contacts-tab-bar":"Contacts","app.home.messaging-tab-bar":"Messaging","app.landing.login":"Start Messaging","app.landing.register":"Register Nickname","app.login.login":"Login","app.login.username-label":"Username","app.login.username-placeholder":"Please enter your username...","app.menu.blocked-label":"Blocked","app.menu.logout-label":"Logout","app.menu.settings-label":"Settings","app.new-conversation.header-title":"New Message","app.new-conversation.message-placeholder":"Compose message...","app.new-conversation.no-contacts-toast":"Please select a contact...","app.new-conversation.problem-occured-toast":"A problem occurred...","app.new-conversation.search-placeholder":"Search contacts...","app.new-conversation.to":"To","app.profile.to-be-implemented":"Page under construction","app.profile.to-be-implemented-header":"Oops!","app.register.error-existing-username":"Sorry! That username is already taken","app.register.error-invalid-username":"Nickname must be at least 3 characters and contain 1 alphanumberic character","app.register.register":"Register nickname","app.register.username-label":"Nickname","app.register.username-placeholder":"Type your nickname here...","app.settings.language-label":"Language","app.settings.preference-label":"Preference","app.settings.read-receipt-label":"Read Receipt","app.settings.typing-indicator-label":"Typing Indicator","components.chat.chat-list.today":"Today","components.chat.chat-modal-delete":"Delete","components.chat.chat-modal-pin":"Pin","components.chat.chat-modal-reply":"Reply","components.chat.chat-modal-resend":"Resend","components.chat.chat-modal-unpin":"Unpin","components.chat.media-modal-download":"Download","components.conversation.me-file-string":"You sent {fileName}","components.conversation.other-file-string":"{name} has sent {fileName}","components.message-input.over-size-limit":"{fileName} exceeds the 15mb file limit","components.profile-info.id":"ID","components.profile-info.identicon":"Identicon","components.profile-info.nickname":"Nickname","components.typing.is-typing":"{user} is typing","redux.err.contacts.add-contact.1":"{username} has already been added","redux.err.contacts.add-contact.2":"{username} is blocked","redux.err.contacts.block-contact.1":"{username} is already blocked","redux.err.contacts.fetch-blocked.1":"Unable to fetch username of this user","redux.err.contacts.fetch-blocked.2":"This user don\'t have a username","redux.err.contacts.fetch-my-contacts.1":"Unable to fetch username of this user","redux.err.generic":"Sorry, something went wrong...","redux.err.group.add-members.1":"Oops, you tried to add members without providing who should be added","redux.err.group.add-members.2":"Oops, you won\'t be able to add agents you blocked","redux.err.group.add-members.3":"Sorry, member/s were not added due to failure in getting group id","redux.err.group.create-group.1":"Oops, you cannot create a group with agents you blocked","redux.err.group.get-latest-group-version.1":"Sorry, failed to get the latest version of the group","redux.err.group.remove-members.1":"Oops, you tried to remove members without providing who should be removed","redux.err.group.remove-members.2":"Sorry, member/s were not removed due to failure in getting group id","redux.err.group.send-group-message.1":"Sorry, \\"{payload}\\" was not sent due to failure in getting group id","redux.err.group.set-files-bytes.1":"Sorry, failed to get the file/media bytes","redux.err.group.update-group-name.1":"Oops, you can\'t update group name with same name","redux.err.group.update-group-name.2":"Sorry, failed updating the group name due to failure in getting group id","redux.err.profile.fetch-profile-from-username.1":"This username does not exist","redux.err.profile.set-username.1":"This username has already been taken","redux.err.profile.set-username.2":"You already have a username"}')},function(e){e.exports=JSON.parse('{"app.chat.chat-details.files":"\u30d5\u30a1\u30a4\u30eb","app.chat.chat-details.info":"\u30c1\u30e3\u30c3\u30c8\u60c5\u5831","app.chat.chat-details.media":"\u30e1\u30c7\u30a3\u30a2","app.chat.header-details":"\u30c1\u30e3\u30c3\u30c8\u60c5\u5831","app.chat.header-pinned-messages":"\u63b2\u793a\u677f","app.chat.header-search":"\u691c\u7d22","app.chat.pinned-message-title":"\u63b2\u793a\u677f","app.contacts.search":"3\u6587\u5b57\u4ee5\u4e0a\u3067\u691c\u7d22","app.contacts.add":"\u9023\u7d61\u5148\u306b\u8ffd\u52a0","app.contacts.add-message":"{name}\u304c\u9023\u7d61\u5148\u306b\u8ffd\u52a0\u3055\u308c\u307e\u3057\u305f","app.contacts.block":"\u9023\u7d61\u5148\u3092\u30d6\u30ed\u30c3\u30af","app.contacts.empty-contact-list":"\u9023\u7d61\u5148\u306f\u307e\u3060\u3042\u308a\u307e\u305b\u3093","app.contacts.remove":"\u9023\u7d61\u5148\u304b\u3089\u524a\u9664","app.contacts.search-nickname-warning":"\u691c\u7d22\u306f\uff13\u6587\u5b57\u4ee5\u4e0a\u3067\u53ef\u80fd\u3067\u3059","app.contacts.unblock":"\u9023\u7d61\u5148\u306e\u30d6\u30ed\u30c3\u30af\u3092\u89e3\u9664","app.conversations.empty-conversations":"\u307e\u3060\u4f1a\u8a71\u304c\u306a\u3044\u3088\u3046\u3067\u3059...","app.conversations.no-group-messages":"\u307e\u3060\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u9001\u4fe1\u3055\u308c\u3066\u3044\u307e\u305b\u3093...","app.group-chat.add-member":"\u8ffd\u52a0","app.group-chat.add-member-close":"\u9589\u3058\u308b","app.group-chat.add-member-contacts":"\u9023\u7d61\u5148","app.group-chat.add-members":"\u30e1\u30f3\u30d0\u30fc\u8ffd\u52a0","app.group-chat.admin-role":"\u7ba1\u7406\u8005","app.group-chat.fetching":"\u53d6\u5f97\u4e2d...","app.group-chat.files.fetching":"\u30d5\u30a1\u30a4\u30eb\u53d6\u5f97\u4e2d...","app.group-chat.files.no-files":"\u30d5\u30a1\u30a4\u30eb\u306f\u3053\u306e\u30c1\u30e3\u30c3\u30c8\u3067\u306f\u307e\u3060\u5171\u6709\u3055\u308c\u3066\u3044\u307e\u305b\u3093","app.group-chat.header-details":"\u30c1\u30e3\u30c3\u30c8\u60c5\u5831","app.group-chat.header-pinned-message":"\u63b2\u793a\u677f","app.group-chat.header-search":"\u691c\u7d22","app.group-chat.label-files":"\u30d5\u30a1\u30a4\u30eb","app.group-chat.label-info":"\u30b0\u30eb\u30fc\u30d7\u60c5\u5831","app.group-chat.label-media":"\u30e1\u30c7\u30a3\u30a2","app.group-chat.media.fetching":"\u30e1\u30c7\u30a3\u30a2\u53d6\u5f97\u4e2d...","app.group-chat.media.month.1":"1\u6708","app.group-chat.media.month.2":"2\u6708","app.group-chat.media.month.3":"3\u6708","app.group-chat.media.month.4":"4\u6708","app.group-chat.media.month.5":"5\u6708","app.group-chat.media.month.6":"6\u6708","app.group-chat.media.month.7":"7\u6708","app.group-chat.media.month.8":"8\u6708","app.group-chat.media.month.9":"9\u6708","app.group-chat.media.month.10":"10\u6708","app.group-chat.media.month.11":"11\u6708","app.group-chat.media.month.12":"12\u6708","app.group-chat.media.no-media":"\u30e1\u30c7\u30a3\u30a2\u30d5\u30a1\u30a4\u30eb\u306f\u3053\u306e\u30c1\u30e3\u30c3\u30c8\u3067\u306f\u307e\u3060\u5171\u6709\u3055\u308c\u3066\u3044\u307e\u305b\u3093","app.group-chat.member-role":"\u30e1\u30f3\u30d0\u30fc","app.group-chat.members":"{length}\u4eba","app.group-chat.members-label":"\u30e1\u30f3\u30d0\u30fc","app.group-chat.minimum-member-required-reached":"\u30b0\u30eb\u30fc\u30d7\u306e\u30e1\u30f3\u30d0\u30fc\u306f\u6700\u4f4e\uff13\u540d\u3067\u3059","app.group-chat.no-member-to-add":"\u8ffd\u52a0\u3067\u304d\u308b\u30e6\u30fc\u30b6\u30fc\u304c\u3044\u307e\u305b\u3093","app.group-chat.oldest-message-fetched":"\u5168\u3066\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d6\u5f97\u3057\u307e\u3057\u305f","app.group-chat.pinned-message-title":"\u63b2\u793a\u677f","app.group-chat.remove-member":"\u30b0\u30eb\u30fc\u30d7\u9000\u4f1a","app.group-chat.sending":"\u9001\u4fe1\u4e2d...","app.group-chat.update-group-name-cancel":"\u30ad\u30e3\u30f3\u30bb\u30eb","app.group-chat.update-group-name-placeholder":"\u30b0\u30eb\u30fc\u30d7\u540d","app.group-chat.update-group-name-save":"\u4fdd\u5b58","app.group-chat.update-group-name-title":"\u30b0\u30eb\u30fc\u30d7\u540d\u5909\u66f4","app.home.contacts-tab-bar":"\u9023\u7d61\u5148","app.home.messaging-tab-bar":"\u30c1\u30e3\u30c3\u30c8","app.landing.login":"\u30c1\u30e3\u30c3\u30c8\u3092\u958b\u59cb\u3059\u308b","app.landing.register":"\u30cb\u30c3\u30af\u30cd\u30fc\u30e0\u3092\u767b\u9332","app.login.login":"\u30ed\u30b0\u30a4\u30f3","app.login.username-label":"\u30e6\u30fc\u30b6\u30fc\u540d","app.login.username-placeholder":"\u30e6\u30fc\u30b6\u30fc\u540d\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044...","app.menu.blocked-label":"\u30d6\u30ed\u30c3\u30af","app.menu.logout-label":"\u30ed\u30b0\u30a2\u30a6\u30c8","app.menu.settings-label":"\u8a2d\u5b9a","app.new-conversation.header-title":"\u65b0\u3057\u3044\u30e1\u30c3\u30bb\u30fc\u30b8","app.new-conversation.message-placeholder":"\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044...","app.new-conversation.no-contacts-toast":"\u9023\u7d61\u5148\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044...","app.new-conversation.problem-occured-toast":"\u554f\u984c\u304c\u767a\u751f\u3057\u307e\u3057\u305f...","app.new-conversation.search-placeholder":"\u9023\u7d61\u5148\u304b\u3089\u9078\u3093\u3067\u304f\u3060\u3055\u3044","app.new-conversation.to":"\u53d7\u4fe1\u8005","app.profile.to-be-implemented":"\u5de5\u4e8b\u4e2d...","app.profile.to-be-implemented-header":"\u304a\u3063\u3068!","app.register.error-existing-username":"\u3053\u306e\u30e6\u30fc\u30b6\u30fc\u540d\u306f\u3059\u3067\u306b\u767b\u9332\u3055\u308c\u3066\u3044\u307e\u3059","app.register.error-invalid-username":"\u30cb\u30c3\u30af\u30cd\u30fc\u30e0\u306f3\u82f1\u6570\u5b57\u4ee5\u4e0a\u3067\u3001\u6700\u4f4e1\u82f1\u5b57\u3092\u542b\u3081\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059","app.register.register":"\u30cb\u30c3\u30af\u30cd\u30fc\u30e0\u3092\u767b\u9332\u3059\u308b","app.register.username-label":"\u30cb\u30c3\u30af\u30cd\u30fc\u30e0","app.register.username-placeholder":"\u30cb\u30c3\u30af\u30cd\u30fc\u30e0\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044...","app.settings.language-label":"\u8a00\u8a9e","app.settings.preference-label":"\u74b0\u5883\u8a2d\u5b9a","app.settings.read-receipt-label":"\u65e2\u8aad\u901a\u77e5","app.settings.typing-indicator-label":"\u5165\u529b\u4e2d\u901a\u77e5","components.chat.chat-list.today":"\u4eca\u65e5","components.chat.chat-modal-pin":"\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u30d4\u30f3\u7559\u3081","components.chat.chat-modal-reply":"\u8fd4\u4fe1","components.chat.chat-modal-unpin":"\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u30d4\u30f3\u7559\u3081\u3092\u89e3\u9664","components.chat.media-modal-download":"\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9","components.conversation.me-file-string":"\u3042\u306a\u305f\u306f{fileName}\u3092\u9001\u308a\u307e\u3057\u305f","components.conversation.other-file-string":"{name}\u304c{fileName}\u3092\u9001\u4fe1\u3057\u307e\u3057\u305f","components.message-input.over-size-limit":"{fileName}\u306f15MB\u306e\u30d5\u30a1\u30a4\u30eb\u5236\u9650\u3092\u8d85\u3048\u3066\u3044\u307e\u3059","components.profile-info.id":"ID","components.profile-info.identicon":"\u30a2\u30a4\u30c7\u30f3\u30c6\u30a3\u30b3\u30f3","components.profile-info.nickname":"\u30cb\u30c3\u30af\u30cd\u30fc\u30e0","components.typing.is-typing":"{user}\u304c\u5165\u529b\u3057\u3066\u3044\u307e\u3059","redux.err.contacts.add-contact.1":"{username}\u306f\u3059\u3067\u306b\u9023\u7d61\u5148\u306b\u8ffd\u52a0\u3055\u308c\u3066\u3044\u307e\u3059","redux.err.contacts.add-contact.2":"{username}\u306f\u30d6\u30ed\u30c3\u30af\u3055\u308c\u3066\u3044\u307e\u3059","redux.err.contacts.block-contact.1":"{username}\u306f\u3059\u3067\u306b\u30d6\u30ed\u30c3\u30af\u3055\u308c\u3066\u3044\u307e\u3059","redux.err.contacts.fetch-blocked.1":"\u3053\u306e\u30e6\u30fc\u30b6\u30fc\u306e\u30e6\u30fc\u30b6\u30fc\u30cd\u30fc\u30e0\u306e\u53d6\u5f97\u306b\u5931\u6557\u3057\u307e\u3057\u305f","redux.err.contacts.fetch-blocked.2":"\u3053\u306e\u30e6\u30fc\u30b6\u30fc\u306f\u30e6\u30fc\u30b6\u30fc\u30cd\u30fc\u30e0\u304c\u3042\u308a\u307e\u305b\u3093","redux.err.contacts.fetch-my-contacts.1":"\u3053\u306e\u30e6\u30fc\u30b6\u30fc\u306e\u30e6\u30fc\u30b6\u30fc\u30cd\u30fc\u30e0\u306e\u53d6\u5f97\u306b\u5931\u6557\u3057\u307e\u3057\u305f","redux.err.generic":"\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f","redux.err.group.add-members.1":"\u304a\u3063\u3068, \u8ffd\u52a0\u3059\u308b\u30e1\u30f3\u30d0\u30fc\u3092\u6307\u5b9a\u305b\u305a\u306b\u30e1\u30f3\u30d0\u30fc\u3092\u8ffd\u52a0\u3057\u3088\u3046\u3068\u3057\u3066\u3044\u307e\u3059","redux.err.group.add-members.2":"\u304a\u3063\u3068, \u30d6\u30ed\u30c3\u30af\u3055\u308c\u305f\u30e6\u30fc\u30b6\u30fc\u306f\u30b0\u30eb\u30fc\u30d7\u306b\u8ffd\u52a0\u3067\u304d\u307e\u305b\u3093","redux.err.group.add-members.3":"\u30b0\u30eb\u30fc\u30d7ID\u306e\u53d6\u5f97\u306b\u5931\u6557\u3057\u305f\u305f\u3081\u3001\u30e1\u30f3\u30d0\u30fc\u306e\u8ffd\u52a0\u306b\u5931\u6557\u3057\u307e\u3057\u305f","redux.err.group.create-group.1":"\u30d6\u30ed\u30c3\u30af\u3055\u308c\u305f\u30e6\u30fc\u30b6\u30fc\u3068\u306f\u30b0\u30eb\u30fc\u30d7\u306f\u4f5c\u6210\u3067\u304d\u307e\u305b\u3093","redux.err.group.get-latest-group-version.1":"\u30b0\u30eb\u30fc\u30d7\u306e\u6700\u65b0\u60c5\u5831\u306e\u53d6\u5f97\u306b\u5931\u6557\u3057\u307e\u3057\u305f","redux.err.group.remove-members.1":"\u304a\u3063\u3068, \u524a\u9664\u3059\u308b\u30e1\u30f3\u30d0\u30fc\u3092\u6307\u5b9a\u305b\u305a\u306b\u30e1\u30f3\u30d0\u30fc\u524a\u9664\u3092\u3057\u3088\u3046\u3068\u3057\u3066\u3044\u307e\u3059","redux.err.group.remove-members.2":"\u30b0\u30eb\u30fc\u30d7ID\u306e\u53d6\u5f97\u306b\u5931\u6557\u3057\u305f\u305f\u3081\u3001\u30e1\u30f3\u30d0\u30fc\u306e\u524a\u9664\u306b\u5931\u6557\u3057\u307e\u3057\u305f","redux.err.group.send-group-message.1":"\u30b0\u30eb\u30fc\u30d7ID\u306e\u53d6\u5f97\u306b\u5931\u6557\u3057\u305f\u305f\u3081\u3001\\"{payload}\\"\u306f\u9001\u4fe1\u3055\u308c\u307e\u305b\u3093\u3067\u3057\u305f","redux.err.group.set-files-bytes.1":"\u30d5\u30a1\u30a4\u30eb/\u30e1\u30c7\u30a3\u30a2\u306e\u53d6\u5f97\u306b\u5931\u6557\u3057\u307e\u3057\u305f","redux.err.group.update-group-name.1":"\u304a\u3063\u3068\u3001\u540c\u3058\u540d\u524d\u3067\u306f\u30b0\u30eb\u30fc\u30d7\u540d\u306f\u66f4\u65b0\u3067\u304d\u307e\u305b\u3093","redux.err.group.update-group-name.2":"\u30b0\u30eb\u30fc\u30d7ID\u306e\u53d6\u5f97\u306b\u5931\u6557\u3057\u305f\u305f\u3081\u3001\u30b0\u30eb\u30fc\u30d7\u540d\u306e\u66f4\u65b0\u306b\u5931\u6557\u3057\u307e\u3057\u305f","redux.err.profile.fetch-profile-from-username.1":"\u3053\u306e\u30e6\u30fc\u30b6\u30fc\u30cd\u30fc\u30e0\u306f\u5b58\u5728\u3057\u307e\u305b\u3093","redux.err.profile.set-username.1":"\u3053\u306e\u30e6\u30fc\u30b6\u30fc\u30cd\u30fc\u30e0\u306f\u3059\u3067\u306b\u4f7f\u7528\u3055\u308c\u3066\u3044\u307e\u3059","redux.err.profile.set-username.2":"\u3042\u306a\u305f\u306f\u3059\u3067\u306b\u30e6\u30fc\u30b6\u30fc\u30cd\u30fc\u30e0\u3092\u304a\u6301\u3061\u3067\u3059"}')},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return N}));var a=n(4),r=n.n(a),c=n(8),s=n(5),o=n(3),i=n(11),u=n(18),l=n(6),p=n(9),d=n(16),b=function(e){return function(){var t=Object(c.a)(r.a.mark((function t(n,a,c){var b,j,m,f,O,h,g,y,v,x,_,E,T,S,N,I;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return b=c.callZome,j=c.getAgentId,m=e.payload,f=a(),O=f.contacts.contacts,h=f.profile.username,t.next=7,j();case 7:if(g=t.sent,y=Object(l.b)(g),v={originalGroupId:Object(l.b)(m.groupId),originalGroupRevisionId:Object(l.b)(m.groupRevisionId),name:m.latestName,members:m.members.map((function(e){return Object(l.b)(e)})),createdAt:Object(p.j)(m.created),creator:Object(l.b)(m.creator),messages:[],pinnedMessages:[]},x=[].concat(Object(u.a)(v.members),[v.creator]),_={},!(null===(E=x.reduce((function(e,t){var n=O[t]?O[t]:t===y?{id:y,username:h}:null;if(n)_[t]=n;else{var a=Object(p.d)(t);e.push(a)}return e}),[]))||void 0===E?void 0:E.length)){t.next=18;break}return t.next=16,b({zomeName:s.c.PROFILES,fnName:s.a[s.c.PROFILES].GET_AGENTS_PROFILES,payload:E});case 16:t.sent.forEach((function(e){var t=e.agent_pub_key;_[t]={id:t,username:e.profile.nickname}}));case 18:T=v.originalGroupId,S=Object(i.a)({},T,v),N=f.groups.conversations,N=Object(o.a)(Object(o.a)({},N),S),I=f.groups.members,I=Object(o.a)(Object(o.a)({},I),_),n({type:d.a,conversations:N,members:I});case 25:case"end":return t.stop()}}),t)})));return function(e,n,a){return t.apply(this,arguments)}}()},j=n(25),m=function(e){return Object(j.d)(e)?e:{type:"FILE",fileName:e.payload.metadata.fileName,fileSize:e.payload.metadata.fileSize,fileType:Object(j.b)(e.payload.fileType)?"OTHER":Object(j.a)(e.payload.fileType)?"IMAGE":"VIDEO",fileHash:Object(l.b)(e.payload.metadata.fileHash),thumbnail:Object(j.b)(e.payload.fileType)?void 0:e.payload.fileType.payload.thumbnail}},f=function(e){return function(){var t=Object(c.a)(r.a.mark((function t(n,a){var c,s,b,j,f,O,h,g,y,v,x;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c=e.payload,s=a(),b={groupMessageId:Object(l.b)(c.messageId),groupId:Object(l.b)(c.groupHash),author:Object(l.b)(c.sender),payload:m(c.payload),timestamp:Object(p.j)(c.created),replyTo:c.replyTo?{groupId:Object(l.b)(c.replyTo.content.groupHash),author:Object(l.b)(c.replyTo.content.sender),payload:m(c.replyTo.content.payload),timestamp:Object(p.j)(c.replyTo.content.created),replyTo:void 0,readList:{}}:void 0,readList:{}},j=b.groupId,f=b.groupMessageId,O=s.groups.conversations[j],h=[b.groupMessageId].concat(Object(u.a)(O.messages)),g=Object(i.a)({},f,b),y=s.groups.messages,y=Object(o.a)(Object(o.a)({},y),g),v=s.groups.groupFiles,x=Object(o.a)(Object(o.a)({},s.groups.conversations),{},Object(i.a)({},j,Object(o.a)(Object(o.a)({},O),{},{messages:h}))),n({type:d.g,conversations:x,messages:y,groupFiles:v});case 13:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},O=function(e){return function(){var t=Object(c.a)(r.a.mark((function t(n,a){var c,s,u,b,j,m;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c=e.payload,s=a(),u=c.messageIds.map((function(e){return Object(l.b)(e)})).filter((function(e){return s.groups.messages[e]})),b=Object(l.b)(c.reader),j=Object(p.j)(c.timestamp),m=Object(o.a)({},a().groups.messages),u.forEach((function(e){m[e].readList=Object(o.a)(Object(o.a)({},m[e].readList),{},Object(i.a)({},b,j))})),n({type:d.i,messages:m});case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},h=function(){var e=Object(c.a)(r.a.mark((function e(t,n){var a,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n({zomeName:s.c.PROFILES,fnName:s.a[s.c.PROFILES].GET_AGENT_PROFILE,payload:t});case 2:return a=e.sent,c=a.agent_pub_key,e.abrupt("return",{id:c,username:a.profile.nickname});case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),g=function(e){return function(){var t=Object(c.a)(r.a.mark((function t(n,a,c){var s,u,p,b,j,m,f,O,g,y,v,x,_;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=c.callZome,u=e.payload,p=Object(l.b)(u.groupId),b=a(),j=b.groups.typing[p]?b.groups.typing[p]:[],m=b.contacts.contacts,f=Object(l.b)(u.indicatedBy),O=j.map((function(e){return e.id})),!(u.isTyping&&!O.includes(f)||!u.isTyping&&O.includes(f))){t.next=24;break}if(!m[f]){t.next=13;break}t.t0=m[f],t.next=16;break;case 13:return t.next=15,h(f,s);case 15:t.t0=t.sent;case 16:g=t.t0,y={groupId:p,indicatedBy:g,isTyping:u.isTyping},v=b.groups.typing,x=v[y.groupId]?v[y.groupId]:[],_=x.map((function(e){return e.id})),y.isTyping?_.includes(y.indicatedBy.id)||x.push(y.indicatedBy):x=x.filter((function(e){return e.id!==y.indicatedBy.id})),v=Object(o.a)(Object(o.a)({},v),{},Object(i.a)({},y.groupId,x)),n({type:d.j,typing:v});case 24:case"end":return t.stop()}}),t)})));return function(e,n,a){return t.apply(this,arguments)}}()},y=n(7),v=n(91),x=function(e){return function(){var t=Object(c.a)(r.a.mark((function t(n,a,c){var s,u,d,b,j,m,f,O,h,g,x,_,E,T,S,N,I,k,M;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c.callZome,s=e.message,u=Object(o.a)({},a().contacts.contacts),d=Object(o.a)({},a().profile),b=Object(o.a)(Object(o.a)({},u),{},Object(i.a)({},d.id,{id:d.id,username:d.username})),j=Object(y.a)(s,2),m=j[0],f=j[1],O=Object(y.a)(m,2),h=O[0],g=O[1],x=f,_=Object(y.a)(x,2),E=_[0],T=_[1],Object.keys(u).includes(Object(l.b)(g.author))){t.next=10;break}return t.abrupt("return");case 10:t.t0=g.payload.type,t.next="TEXT"===t.t0?13:"FILE"===t.t0?15:17;break;case 13:return S=g.payload,t.abrupt("break",18);case 15:return S={type:"FILE",fileName:g.payload.payload.metadata.fileName,fileSize:g.payload.payload.metadata.fileSize,fileType:g.payload.payload.fileType.type,fileHash:Object(l.b)(g.payload.payload.metadata.fileHash),thumbnail:"OTHER"!==g.payload.payload.fileType.type?g.payload.payload.fileType.payload.thumbnail:null},t.abrupt("break",18);case 17:return t.abrupt("break",18);case 18:if(N=void 0,I=void 0,null===g.replyTo){t.next=30;break}t.t1=g.replyTo.payload.type,t.next="TEXT"===t.t1?24:"FILE"===t.t1?26:28;break;case 24:return I=g.replyTo.payload,t.abrupt("break",29);case 26:return I={type:"FILE",fileName:g.replyTo.payload.payload.metadata.fileName,fileSize:g.replyTo.payload.payload.metadata.fileSize,fileType:g.replyTo.payload.payload.fileType.type,fileHash:Object(l.b)(g.replyTo.payload.payload.metadata.fileHash),thumbnail:"OTHER"!==g.replyTo.payload.payload.fileType.type?g.replyTo.payload.payload.fileType.payload.thumbnail:null},t.abrupt("break",29);case 28:return t.abrupt("break",29);case 29:N={p2pMessageEntryHash:Object(l.b)(g.replyTo.hash),author:b[Object(l.b)(g.replyTo.author)],receiver:b[Object(l.b)(g.replyTo.receiver)],payload:I||g.replyTo.payload,timestamp:Object(p.j)(g.replyTo.timeSent),receipts:[]};case 30:k={p2pMessageEntryHash:Object(l.b)(h),author:b[Object(l.b)(g.author)],receiver:b[Object(l.b)(g.receiver)],payload:S,timestamp:Object(p.j)(g.timeSent),replyTo:N||void 0,receipts:[Object(l.b)(E)]},M={p2pMessageReceiptEntryHash:Object(l.b)(E),p2pMessageEntryHashes:[Object(l.b)(T.id[0])],timestamp:Object(p.j)(T.status.timestamp),status:T.status.status},n(Object(v.a)({message:k,receipt:M,key:k.author.id}));case 33:case"end":return t.stop()}}),t)})));return function(e,n,a){return t.apply(this,arguments)}}()},_=n(27),E=function(e){return function(){var t=Object(c.a)(r.a.mark((function t(n,a,c){var s,o,i;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c.callZome,s=Object.keys(e.receipt)[0],o=[],e.receipt[s].id.forEach((function(e){o.push(Object(l.b)(e))})),i={p2pMessageReceiptEntryHash:s,p2pMessageEntryHashes:o,timestamp:Object(p.j)(e.receipt[s].status.timestamp),status:e.receipt[s].status.status},n({type:_.a,state:i});case 6:case"end":return t.stop()}}),t)})));return function(e,n,a){return t.apply(this,arguments)}}()},T=function(e){return function(){var t=Object(c.a)(r.a.mark((function t(n,a,c){var s,o,i,u,p,d,b;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c.callZome,s=Object.keys(e.pin)[0],o=e.pin[s],i=o.status,u=o.conversants,p=a().p2pmessages.messages,d={},o.id.forEach((function(e){var t=Object(l.b)(e),n=p[t];d[t]=n})),b=a().profile.id,"pinned"===i.pinstatus?n({type:_.b,state:{conversant:Object(l.b)(u[0])===b?Object(l.b)(u[1]):Object(l.b)(u[0]),messages:d}}):n({type:_.i,state:{conversant:Object(l.b)(u[0])===b?Object(l.b)(u[1]):Object(l.b)(u[0]),messages:d}});case 10:case"end":return t.stop()}}),t)})));return function(e,n,a){return t.apply(this,arguments)}}()},S=function(e){return function(){var t=Object(c.a)(r.a.mark((function t(n,a){var c,s,i,u;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=a().contacts.contacts,s=Object(l.b)(e.agent),!!!c[s]){t.next=9;break}return i=Object(o.a)({},a().p2pmessages.typing),u=c[s],!i[u.id]&&e.is_typing?i[u.id]=u:e.is_typing||delete i[u.id],n({type:_.h,state:i}),t.abrupt("return",!0);case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},N=function(e,t){return function(){var n=Object(c.a)(r.a.mark((function n(a){return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:n.t0=e,n.next=n.t0===s.b[s.c.GROUP].ADDED_TO_GROUP?3:n.t0===s.b[s.c.GROUP].GROUP_MESSAGE_DATA?5:n.t0===s.b[s.c.GROUP].GROUP_TYPING_DETAIL?7:n.t0===s.b[s.c.GROUP].GROUP_MESSAGE_READ?9:n.t0===s.b[s.c.P2PMESSAGE].RECEIVE_P2P_MESSAGE?11:n.t0===s.b[s.c.P2PMESSAGE].RECEIVE_P2P_RECEIPT?13:n.t0===s.b[s.c.P2PMESSAGE].TYPING_P2P?15:n.t0===s.b[s.c.P2PMESSAGE].SYNC_P2P_PINS?17:19;break;case 3:return a(b(t)),n.abrupt("break",19);case 5:return a(f(t)),n.abrupt("break",19);case 7:return a(g(t)),n.abrupt("break",19);case 9:return a(O(t)),n.abrupt("break",19);case 11:return a(x(t)),n.abrupt("break",19);case 13:return a(E(t)),n.abrupt("break",19);case 15:return a(S(t)),n.abrupt("break",19);case 17:return a(T(t)),n.abrupt("break",19);case 19:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}},,,,,,,,,,,,,,function(e,t,n){var a={"./ion-action-sheet.entry.js":[246,5],"./ion-alert.entry.js":[247,6],"./ion-app_8.entry.js":[248,7],"./ion-avatar_3.entry.js":[249,17],"./ion-back-button.entry.js":[250,18],"./ion-backdrop.entry.js":[251,43],"./ion-button_2.entry.js":[252,19],"./ion-card_5.entry.js":[253,20],"./ion-checkbox.entry.js":[254,21],"./ion-chip.entry.js":[255,22],"./ion-col_3.entry.js":[256,44],"./ion-datetime_3.entry.js":[257,10],"./ion-fab_3.entry.js":[258,23],"./ion-img.entry.js":[259,45],"./ion-infinite-scroll_2.entry.js":[260,46],"./ion-input.entry.js":[261,24],"./ion-item-option_3.entry.js":[262,25],"./ion-item_8.entry.js":[263,26],"./ion-loading.entry.js":[264,27],"./ion-menu_3.entry.js":[265,28],"./ion-modal.entry.js":[266,8],"./ion-nav_2.entry.js":[267,14],"./ion-popover.entry.js":[268,9],"./ion-progress-bar.entry.js":[269,29],"./ion-radio_2.entry.js":[270,30],"./ion-range.entry.js":[271,31],"./ion-refresher_2.entry.js":[272,11],"./ion-reorder_2.entry.js":[273,16],"./ion-ripple-effect.entry.js":[274,47],"./ion-route_4.entry.js":[275,32],"./ion-searchbar.entry.js":[276,33],"./ion-segment_2.entry.js":[277,34],"./ion-select_3.entry.js":[278,35],"./ion-slide_2.entry.js":[279,48],"./ion-spinner.entry.js":[280,13],"./ion-split-pane.entry.js":[281,49],"./ion-tab-bar_2.entry.js":[282,36],"./ion-tab_2.entry.js":[283,15],"./ion-text.entry.js":[284,37],"./ion-textarea.entry.js":[285,38],"./ion-toast.entry.js":[286,39],"./ion-toggle.entry.js":[287,12],"./ion-virtual-scroll.entry.js":[288,50]};function r(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return n.e(t[1]).then((function(){return n(r)}))}r.keys=function(){return Object.keys(a)},r.id=207,e.exports=r},,function(e,t,n){var a={"./ion-icon.entry.js":[289,57]};function r(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return n.e(t[1]).then((function(){return n(r)}))}r.keys=function(){return Object.keys(a)},r.id=209,e.exports=r},,,,,,,,,,,function(e,t,n){},,,,,,,,,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),c=n(60),s=n.n(c),o=n(1),i=(n(210),n(211),n(212),n(213),n(214),n(215),n(216),n(217),n(218),n(219),n(220),n(7)),u=n(13),l=n(3),p=n(168),d=n.n(p),b=n(0),j=function(e){return Object(b.jsx)("div",{className:d.a.spinner,children:Object(b.jsx)(o.T,Object(l.a)({},e))})},m=n(4),f=n.n(m),O=n(8),h=n(6),g=n(5),y=n(15),v=n(48),x=function(e){return function(){var t=Object(O.a)(f.a.mark((function t(n,a,r){var c,s,o,i,u;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.callZome,s=r.getAgentId,t.prev=1,t.next=4,s();case 4:return o=t.sent,i=Object(h.b)(o),t.next=8,c({zomeName:g.c.PROFILES,fnName:g.a[g.c.PROFILES].CREATE_PROFILE,payload:{nickname:e,fields:{}}});case 8:return u=t.sent,n({type:v.a,id:i,nickname:u.profile.nickname}),t.abrupt("return",u);case 13:t.prev=13,t.t0=t.catch(1),n(Object(y.a)("TOAST",{},{id:"redux.err.generic"}));case 16:case"end":return t.stop()}}),t,null,[[1,13]])})));return function(e,n,a){return t.apply(this,arguments)}}()},_=function(){return function(){var e=Object(O.a)(f.a.mark((function e(t,n,a){var r,c,s,o,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.callZome,c=a.getAgentId,e.prev=1,e.next=4,r({zomeName:g.c.PROFILES,fnName:g.a[g.c.PROFILES].GET_MY_PROFILE});case 4:return s=e.sent,console.warn("Agent's profile: ",s),e.next=8,c();case 8:return o=e.sent,i=Object(h.b)(o),t({type:v.a,nickname:s.profile.nickname,id:i}),e.abrupt("return",!0);case 14:e.prev=14,e.t0=e.catch(1);case 16:return e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t,n,a){return e.apply(this,arguments)}}()},E=function(e){return function(){var t=Object(O.a)(f.a.mark((function t(n,a,r){var c,s,o,i,u,p;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.callZome,s=a(),o=Object(l.a)({},s.contacts.contacts),i=s.profile.id,t.prev=4,t.next=7,c({zomeName:g.c.PROFILES,fnName:g.a[g.c.PROFILES].SEARCH_PROFILES,payload:{nickname_prefix:e}});case 7:return u=t.sent,p=u.filter((function(e){return!Object.keys(o).includes(e.agent_pub_key)&&e.agent_pub_key!==i})).map((function(e){return{id:e.agent_pub_key,username:e.profile.nickname}})),t.abrupt("return",p);case 12:t.prev=12,t.t0=t.catch(4);case 14:return t.abrupt("return",!1);case 15:case"end":return t.stop()}}),t,null,[[4,12]])})));return function(e,n,a){return t.apply(this,arguments)}}()},T=function(){return function(){var e=Object(O.a)(f.a.mark((function e(t,n,a){var r,c,s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.client,c=a.init,!r){e.next=5;break}e.t0=r,e.next=8;break;case 5:return e.next=7,c();case 7:e.t0=e.sent;case 8:return s=e.t0,e.next=11,s.connection.signOut();case 11:return e.next=13,s.connection.signIn();case 13:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}()},S=n(9),N=n(12),I=n(10),k=n(171),M=n(58),w=n(169),R=n(170),P=n.n(R),G=function(e){var t=e.hash,n=e.size,r=void 0===n?32:n,c=Object(a.useRef)(null),s={hash:Object(h.a)(t),size:r};return Object(a.useEffect)((function(){c.current&&Object(w.a)(s,c.current)})),Object(b.jsx)("div",{children:Object(b.jsx)("canvas",{ref:c,className:P.a.icon,id:"identicon",width:"20",height:"20"})})},C=n(128),A=n.n(C),L=function(){var e=Object(N.f)(),t=Object(u.c)((function(e){return e.profile})),n=t.username,r=t.id,c=Object(S.k)(),s=Object(k.a)(),i=Object(a.useRef)(null),l=[{onClick:function(){e.push("/settings")},label:s.formatMessage({id:"app.menu.settings-label"}),icon:I.t},{onClick:function(){e.push("/blocked")},label:s.formatMessage({id:"app.menu.blocked-label"}),icon:I.h},{onClick:function(){c(T())},label:s.formatMessage({id:"app.menu.logout-label"}),icon:I.C,disabled:!Object(M.d)()}];return Object(b.jsx)(o.C,{ref:i,contentId:"main",type:"overlay",children:Object(b.jsx)(o.j,{className:"".concat(A.a.menu," ion-padding-top"),children:Object(b.jsxs)(o.z,{id:"inbox-list",lines:"none",children:[Object(b.jsxs)(o.x,{className:"ion-no-margin",children:[Object(b.jsx)("span",{className:"".concat(A.a.container," ion-margin"),children:Object(b.jsx)(G,{hash:r,size:50})}),Object(b.jsx)(o.v,{onClick:function(){var t;null===i||void 0===i||null===(t=i.current)||void 0===t||t.close(),e.push({pathname:"/p/".concat(r),state:{profile:{username:n,id:r},prev:"/home"}})},lines:"none",children:Object(b.jsx)(o.y,{children:n})})]}),l.map((function(e){var t=e.onClick,n=e.label,a=e.icon,r=e.disabled,c=void 0!==r&&r;return Object(b.jsxs)(o.v,{onClick:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){var e;null===i||void 0===i||null===(e=i.current)||void 0===e||e.close(),t()})),disabled:c,children:[Object(b.jsx)(o.q,{className:"ion-margin-end",icon:a}),Object(b.jsx)(o.y,{children:n})]},n)}))]})})})},D=n(11),H=n(30),F=n(25),U=function(e){return{messagesByGroup:Object(S.h)(e.messagesByGroup,(function(e){return e.map((function(e){return Object(h.b)(e)}))})),groupMessagesContents:Object(S.h)(e.groupMessagesContents,(function(e){var t=Object(S.h)(e.readList,(function(e){return Object(S.j)(e)}));return{groupMessageId:Object(h.b)(e.groupMessageElement.signedHeader.header.content.entry_hash),groupId:Object(h.b)(e.groupMessageElement.entry.groupHash),author:Object(h.b)(e.groupMessageElement.entry.sender),payload:B(e.groupMessageElement.entry.payload),timestamp:Object(S.j)(e.groupMessageElement.entry.created),replyTo:e.groupMessageElement.entry.replyTo?{groupId:Object(h.b)(e.groupMessageElement.entry.replyTo.content.groupHash),author:Object(h.b)(e.groupMessageElement.entry.replyTo.content.sender),payload:B(e.groupMessageElement.entry.replyTo.content.payload),timestamp:Object(S.j)(e.groupMessageElement.entry.replyTo.content.created),replyTo:e.groupMessageElement.entry.replyTo?Object(h.b)(e.groupMessageElement.entry.replyTo):void 0,readList:{}}:void 0,readList:t}}))}},B=function(e){return Object(F.d)(e)?e:Object(F.b)(e.payload.fileType)?{type:"FILE",fileName:e.payload.metadata.fileName,fileSize:e.payload.metadata.fileSize,fileType:e.payload.metadata.fileType,fileHash:Object(h.b)(e.payload.metadata.fileHash)}:{type:"FILE",fileName:e.payload.metadata.fileName,fileSize:e.payload.metadata.fileSize,fileType:e.payload.metadata.fileType,fileHash:Object(h.b)(e.payload.metadata.fileHash),thumbnail:e.payload.fileType.payload.thumbnail}},z=function(){var e=Object(O.a)(f.a.mark((function e(t,n,a,r){var c,s,o,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=t.contacts.contacts,s=t.profile.username,o=[],i={},n.forEach((function(e){c[e]?i[e]=c[e]:e===r?i[r]={id:r,username:s}:o.push(Object(S.d)(e))})),!(null===o||void 0===o?void 0:o.length)){e.next=10;break}return e.next=8,a({zomeName:g.c.PROFILES,fnName:g.a[g.c.PROFILES].GET_AGENTS_PROFILES,payload:o});case 8:e.sent.forEach((function(e){var t=e.agent_pub_key;i[t]={id:t,username:e.profile.nickname}}));case 10:return e.abrupt("return",i);case 11:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}(),q=n(16),Y=n(104),V=n(61),Z=n(62),X=function(){var e=Object(N.f)(),t=Object(u.c)((function(e){return Object.values(e.contacts.blocked)}));return Object(b.jsxs)(o.G,{children:[Object(b.jsx)(o.p,{children:Object(b.jsx)(o.eb,{children:Object(b.jsx)(o.f,{slot:"start",children:Object(b.jsx)(o.e,{onClick:function(){return e.push({pathname:"/home"})},className:"ion-no-padding",children:Object(b.jsx)(o.q,{slot:"icon-only",icon:I.e})})})})}),Object(b.jsx)(o.j,{children:t.map((function(t){return Object(b.jsx)(o.v,{button:!0,onClick:function(){return n=t,e.push({pathname:"/p/".concat(n.id),state:{profile:n,prev:"/blocked"}});var n},children:Object(b.jsx)(o.y,{children:t.username})},t.username)}))})]})},J=n(172),K=n.n(J),Q=function(e,t){var n=e.children,c=e.type,s=void 0===c?"p2p":c,i=e.onScrollTop,u=e.disabled,l=e.onScrollBottom,p=r.a.Children.toArray(n),d=Object(k.a)(),j=Object(a.useRef)(null),m=Object(a.useRef)(null),f=Object(a.useRef)(null),O=r.a.Children.map(p,(function(e,t){if(r.a.isValidElement(e)){var n=function(e,t,n){var a,r,c,o=!1,i=!1,u=!1,l=0===n,p=0!==(null===(a=Object.values(null===(r=t[n])||void 0===r||null===(c=r.props)||void 0===c?void 0:c.readList))||void 0===a?void 0:a.length);0===n&&(o=!0);var d=t[n-1],b=null===e||void 0===e?void 0:e.props,j=null===d||void 0===d?void 0:d.props;(null===b||void 0===b?void 0:b.author)!==(null===j||void 0===j?void 0:j.author)&&(o=!0,i=!0);var m=null===b||void 0===b?void 0:b.timestamp,f=null===j||void 0===j?void 0:j.timestamp;return m&&f&&(l=!(m.getDate()===f.getDate()&&m.getMonth()===f.getMonth()&&m.getFullYear()===f.getFullYear()))&&(o=!0),"group"===s&&(u=o),{showProfilePicture:o,space:i,showName:u,showDate:l,hasRead:p}}(e,p,t),c=n.showProfilePicture,i=n.showName,u=n.showDate,l=n.hasRead;return Object(b.jsxs)(a.Fragment,{children:[u?Object(b.jsx)(o.Y,{className:"ion-text-center",children:e.props.timestamp.toDateString()===(new Date).toDateString()?d.formatMessage({id:"components.chat.chat-list.today"}):d.formatDate(e.props.timestamp,{year:"numeric",month:"numeric",day:"numeric"})}):null,r.a.cloneElement(e,{isSeen:l,type:s,showProfilePicture:c,showName:i})]},t)}return e}));Object(a.useEffect)((function(){j.current&&setTimeout((function(){var e;null===(e=j.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),500)}),[j]);var h=function(){var e;return null===(e=m.current)||void 0===e?void 0:e.complete()},g=function(){var e;return null===(e=f.current)||void 0===e?void 0:e.complete()};return Object(a.useImperativeHandle)(t,(function(){return{scrollToBottom:function(){setTimeout((function(){var e;return null===(e=j.current)||void 0===e?void 0:e.scrollIntoView({behavior:"smooth"})}),500)}}})),Object(b.jsxs)(o.z,{className:"".concat(K.a.chat," chat-list"),children:[i?Object(b.jsx)(o.s,{disabled:!!u,threshold:"0px",ref:m,position:"top",onIonInfinite:function(e){return setTimeout((function(){return i(h,e)}),1e3)},children:Object(b.jsx)(o.t,{loadingSpinner:"crescent"})}):null,O,Object(b.jsx)("div",{ref:j}),l?Object(b.jsx)(o.s,{disabled:!!u,threshold:"0px",ref:f,position:"top",onIonInfinite:function(e){return setTimeout((function(){return l(g,e)}),1e3)},children:Object(b.jsx)(o.t,{loadingSpinner:"crescent"})}):null]})},W=Object(a.forwardRef)(Q),$=n(132),ee=n.n($),te=function(e){var t=e.onPin,n=e.onReply,a=e.onDelete,r=e.isPinned,c=e.intl,s=e.onRetry,i=e.onHide;return e.err?Object(b.jsxs)(o.z,{children:[Object(b.jsxs)(o.v,{button:!0,lines:"none",onClick:function(){s(),i()},children:[Object(b.jsx)(o.y,{children:c.formatMessage({id:"components.chat.chat-modal-resend"})}),Object(b.jsx)(o.q,{icon:I.A,className:ee.a.icon})]}),Object(b.jsxs)(o.v,{onClick:function(){a(),i()},button:!0,lines:"none",children:[Object(b.jsx)(o.y,{children:c.formatMessage({id:"components.chat.chat-modal-delete"})}),Object(b.jsx)(o.q,{icon:I.r,slot:"end"})]})]}):Object(b.jsxs)(o.z,{children:[Object(b.jsxs)(o.v,{button:!0,lines:"none",onClick:function(){n(),i()},children:[Object(b.jsx)(o.y,{children:c.formatMessage({id:"components.chat.chat-modal-reply"})}),Object(b.jsx)(o.q,{icon:I.f,className:ee.a.icon})]}),Object(b.jsxs)(o.v,{onClick:function(){t(),i()},button:!0,lines:"none",children:[Object(b.jsx)(o.y,{children:r?c.formatMessage({id:"components.chat.chat-modal-unpin"}):c.formatMessage({id:"components.chat.chat-modal-pin"})}),Object(b.jsx)(o.q,{icon:I.N,slot:"end"})]})]})},ne=function(e){return function(){var t=Object(O.a)(f.a.mark((function t(n,a,r){var c,s,o,i,u,p,d,b,j,m,O,v,x;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.callZome,s=r.getAgentId,o=a(),t.next=4,s();case 4:return i=t.sent,u={members:e.members.filter((function(t,n){return e.members.indexOf(t)===n})).map((function(e){return Object(S.d)(e)})),groupId:Object(h.a)(e.groupId),groupRevisionId:Object(h.a)(e.groupRevisionId)},t.prev=6,t.next=9,c({zomeName:g.c.GROUP,fnName:g.a[g.c.GROUP].ADD_MEMBERS,payload:u});case 9:return p=t.sent,d=p.members.map((function(e){return Object(h.b)(e)})),b={members:d,groupId:Object(h.b)(p.groupId),groupRevisionId:Object(h.b)(p.groupRevisionId)},t.next=14,z(o,d,c,Object(h.b)(i));case 14:return j=t.sent,m=b.groupId,(O=o.groups.conversations[m]).members=O.members.concat(b.members),v=o.groups.conversations,v=Object(l.a)(Object(l.a)({},v),{},Object(D.a)({},m,O)),x=o.groups.members,x=Object(l.a)(Object(l.a)({},x),j),n({type:q.b,conversations:v,members:x}),t.abrupt("return",e);case 26:t.prev=26,t.t0=t.catch(6),t.t1=t.t0.message,t.next="members field is empty"===t.t1?31:"cannot create group with blocked agents"===t.t1?33:"failed to get the given group id"===t.t1?35:37;break;case 31:return n(Object(y.a)("TOAST",{},{id:"redux.err.group.add-members.1"})),t.abrupt("return",!1);case 33:return n(Object(y.a)("TOAST",{},{id:"redux.err.group.add-members.2"})),t.abrupt("return",!1);case 35:return n(Object(y.a)("TOAST",{},{id:"redux.err.group.add-members.3"})),t.abrupt("return",!1);case 37:return n(Object(y.a)("TOAST",{},{id:"redux.err.generic"})),t.abrupt("return",!1);case 39:case"end":return t.stop()}}),t,null,[[6,26]])})));return function(e,n,a){return t.apply(this,arguments)}}()},ae=n(18),re=function(e){return function(){var t=Object(O.a)(f.a.mark((function t(n,a,r){var c,s,o,i,u,p,d,b,j,m,O,y,v;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.callZome,s=r.getAgentId,o=a(),t.next=4,s();case 4:return i=t.sent,u={name:e.name,members:e.members.map((function(e){return Object(S.d)(e)}))},t.prev=6,t.next=9,c({zomeName:g.c.GROUP,fnName:g.a[g.c.GROUP].CREATE_GROUP,payload:u});case 9:return p=t.sent,d={originalGroupId:Object(h.b)(p.groupId),originalGroupRevisionId:Object(h.b)(p.groupRevisionId),name:p.content.name,members:p.content.members.map((function(e){return Object(h.b)(e)})),createdAt:p.content.created,creator:Object(h.b)(p.content.creator),messages:[],pinnedMessages:[]},b=[].concat(Object(ae.a)(d.members),[d.creator]),t.next=14,z(o,b,c,Object(h.b)(i));case 14:return j=t.sent,m=d.originalGroupId,O=Object(D.a)({},m,d),y=o.groups.conversations,y=Object(l.a)(Object(l.a)({},y),O),v=o.groups.members,v=Object(l.a)(Object(l.a)({},v),j),n({type:q.a,conversations:y,members:v}),t.abrupt("return",d);case 25:throw t.prev=25,t.t0=t.catch(6),t.t0;case 28:case"end":return t.stop()}}),t,null,[[6,25]])})));return function(e,n,a){return t.apply(this,arguments)}}()},ce=function(e){return function(t,n){var a=n(),r=a.profile.id,c=a.groups.conversations[e],s=a.groups.messages;return c.messages.filter((function(e){return s[e].author!==r})).map((function(e){return s[e].readList})).filter((function(e){return void 0===e[r]})).length}},se=function(e){return function(){var t=Object(O.a)(f.a.mark((function t(n,a,r){var c,s,o,i,u,p,d,b,j,m,O,v,x,_,E;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.callZome,s=r.getAgentId,t.next=3,s();case 3:return o=t.sent,i=a(),t.prev=5,t.next=8,c({zomeName:g.c.GROUP,fnName:g.a[g.c.GROUP].GET_GROUP_LATEST_VERSION,payload:{groupHash:Object(h.a)(e)}});case 8:return u=t.sent,p={groupId:Object(h.a)(e),batchSize:10,payloadType:{type:"ALL",payload:null}},t.next=12,c({zomeName:g.c.GROUP,fnName:g.a[g.c.GROUP].GET_PREVIOUS_GROUP_MESSAGES,payload:p});case 12:return d=t.sent,t.next=15,c({zomeName:g.c.GROUP,fnName:g.a[g.c.GROUP].FETCH_PINNED_MESSAGES,payload:e});case 15:return b=t.sent,j=U(d),m={originalGroupId:Object(h.b)(u.groupId),originalGroupRevisionId:Object(h.b)(u.groupRevisionId),name:u.latestName,members:u.members.map((function(e){return Object(h.b)(e)})),createdAt:Object(S.j)(u.created),creator:Object(h.b)(u.creator),messages:j.messagesByGroup[Object(h.b)(u.groupId)],pinnedMessages:Object.values(b).map((function(e){return Object(h.b)(e.entry.messageId)}))},t.next=20,z(a(),m.members,c,Object(h.b)(o));case 20:return O=t.sent,v=i.groups.conversations,v=Object(l.a)(Object(l.a)({},v),{},Object(D.a)({},m.originalGroupId,m)),x=i.groups.messages,x=Object(l.a)(Object(l.a)({},x),j.groupMessagesContents),_=i.groups.members,Object.keys(O).forEach((function(e){_[e]=O[e]})),n({type:q.k,conversations:v,messages:x,members:_}),t.abrupt("return",m);case 31:if(t.prev=31,t.t0=t.catch(5),!(null===t.t0||void 0===t.t0||null===(E=t.t0.message)||void 0===E?void 0:E.includes("failed to get the given group id"))){t.next=37;break}return t.abrupt("return",n(Object(y.a)("TOAST",{},{id:"redux.err.group.get-latest-group-version.1"})));case 37:return t.abrupt("return",n(Object(y.a)("TOAST",{},{id:"redux.err.generic"})));case 38:case"end":return t.stop()}}),t,null,[[5,31]])})));return function(e,n,a){return t.apply(this,arguments)}}()},oe=function(e){return function(){var t=Object(O.a)(f.a.mark((function t(n,a,r){var c,s,o,i,u,p,d,b,j,m;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.callZome,s=a(),o={groupId:Object(h.a)(e.groupId),lastFetched:e.lastFetched?Object(h.a)(e.lastFetched):void 0,lastMessageTimestamp:e.lastMessageTimestamp?Object(S.c)(e.lastMessageTimestamp):void 0,batchSize:e.batchSize,payloadType:e.payloadType},t.prev=3,t.next=6,c({zomeName:g.c.GROUP,fnName:g.a[g.c.GROUP].GET_PREVIOUS_GROUP_MESSAGES,payload:o});case 6:return i=t.sent,u=U(i),p=s.groups.conversations,(d=p[e.groupId])&&(b=d.messages?Array.from(new Set(d.messages.concat(u.messagesByGroup[e.groupId]))):u.messagesByGroup[e.groupId],p=Object(l.a)(Object(l.a)({},p),{},Object(D.a)({},e.groupId,d)),j=s.groups.messages,j=Object(l.a)(Object(l.a)({},j),u.groupMessagesContents),m=Object(l.a)(Object(l.a)({},p),{},Object(D.a)({},e.groupId,Object(l.a)(Object(l.a)({},d),{},{messages:b}))),n({type:q.h,conversations:m,messages:j})),t.abrupt("return",u);case 14:return t.prev=14,t.t0=t.catch(3),t.abrupt("return",n(Object(y.a)("TOAST",{},{id:"redux.err.generic"})));case 17:case"end":return t.stop()}}),t,null,[[3,14]])})));return function(e,n,a){return t.apply(this,arguments)}}()},ie=function(e){return function(){var t=Object(O.a)(f.a.mark((function t(n,a,r){var c,s,o,i,u,p,d,b,j,m;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.callZome,s=a(),o={groupId:Object(h.a)(e.groupId),date:Object(S.c)(e.date),payloadType:e.payloadType},t.next=5,c({zomeName:g.c.GROUP,fnName:g.a[g.c.GROUP].GET_MESSAGES_BY_GROUP_BY_TIMESTAMP,payload:o});case 5:return i=t.sent,u=U(i),p=s.groups.conversations,(d=p[e.groupId])&&(b=d.messages?Array.from(new Set(d.messages.concat(u.messagesByGroup[e.groupId]))):p[e.groupId].messages,p=Object(l.a)(Object(l.a)({},p),{},Object(D.a)({},e.groupId,d)),j=s.groups.messages,j=Object(l.a)(Object(l.a)({},j),u.groupMessagesContents),m=Object(l.a)(Object(l.a)({},p),{},Object(D.a)({},e.groupId,Object(l.a)(Object(l.a)({},d),{},{messages:b}))),n({type:q.h,conversations:m,messages:j})),t.abrupt("return",u);case 11:case"end":return t.stop()}}),t)})));return function(e,n,a){return t.apply(this,arguments)}}()},ue=function(e,t){return function(n,a){var r=a().groups,c=r.messages,s=r.members,o=r.errMsgs,i=a().profile,u=e.map((function(e){var t=c[e],n=s[t.author];return Object(l.a)(Object(l.a)({},t),{},{author:n||{username:i.username,id:t.author}})}));return o[t]&&(u=u.concat(o[t])),u.sort((function(e,t){return e.timestamp.getTime()-t.timestamp.getTime()})),u}},le=function(e){return function(){var t=Object(O.a)(f.a.mark((function t(n,a,r){var c,s;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.callZome,s={groupId:Object(h.a)(e.groupId),indicatedBy:Object(S.d)(e.indicatedBy),members:e.members.map((function(e){return Object(S.d)(e)})),isTyping:e.isTyping},t.next=4,c({zomeName:g.c.GROUP,fnName:g.a[g.c.GROUP].INDICATE_GROUP_TYPING,payload:s});case 4:return t.abrupt("return",null);case 5:case"end":return t.stop()}}),t)})));return function(e,n,a){return t.apply(this,arguments)}}()},pe=function(e){return function(){var t=Object(O.a)(f.a.mark((function t(n,a,r){var c,s;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.callZome,s={groupId:Object(h.a)(e.groupId),messageIds:e.messageIds.map((function(e){return Object(h.a)(e)})),reader:e.reader,timestamp:Object(S.c)(e.timestamp),members:e.members},t.prev=2,t.next=5,c({zomeName:g.c.GROUP,fnName:g.a[g.c.GROUP].READ_GROUP_MESSAGE,payload:s});case 5:t.next=9;break;case 7:t.prev=7,t.t0=t.catch(2);case 9:return t.abrupt("return",null);case 10:case"end":return t.stop()}}),t,null,[[2,7]])})));return function(e,n,a){return t.apply(this,arguments)}}()},de=function(e){return function(){var t=Object(O.a)(f.a.mark((function t(n,a,r){var c,s,o,i,u,p,d,b,j,m;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.callZome,s={members:e.members.map((function(e){return Object(S.d)(e)})),groupId:Object(h.a)(e.groupId),groupRevisionId:Object(h.a)(e.groupRevisionId)},o=a(),t.prev=3,t.next=6,c({zomeName:g.c.GROUP,fnName:g.a[g.c.GROUP].REMOVE_MEMBERS,payload:s});case 6:return i=t.sent,u={members:i.members.map((function(e){return Object(h.b)(e)})),groupId:Object(h.b)(i.groupId),groupRevisionId:Object(h.b)(i.groupRevisionId)},p=u.groupId,d=u.members,(b=o.groups.conversations[p]).members=b.members.filter((function(e){return!d.includes(e)})),j=o.groups.conversations,j=Object(l.a)(Object(l.a)({},j),{},Object(D.a)({},p,b)),m=o.groups.members,d.forEach((function(e){delete m[e]})),n({type:q.c,conversations:j,members:m}),t.abrupt("return",e);case 20:t.prev=20,t.t0=t.catch(3),t.t1=t.t0.message,t.next="members field is empty"===t.t1?25:"failed to get the given group id"===t.t1?27:29;break;case 25:return n(Object(y.a)("TOAST",{},{id:"redux.err.group.remove-members.1"})),t.abrupt("return",!1);case 27:return n(Object(y.a)("TOAST",{},{id:"redux.err.group.remove-members.2"})),t.abrupt("return",!1);case 29:return n(Object(y.a)("TOAST",{},{id:"redux.err.generic"})),t.abrupt("return",!1);case 31:case"end":return t.stop()}}),t,null,[[3,20]])})));return function(e,n,a){return t.apply(this,arguments)}}()},be=function(){var e=Object(O.a)(f.a.mark((function e(t,n,a,r,c){var s,o,i,u,p,d,b,j,m,O,y,v,x,_,E,T,N;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(F.d)(n.payloadInput)){e.next=4;break}s=t.content.payload,e.next=14;break;case 4:if(i=t.content.payload.payload.fileType,u=Object(F.b)(i)?void 0:Object(F.a)(i)||Object(F.e)(i)?i.payload.thumbnail:void 0,o=n.payloadInput.payload.fileBytes,"VIDEO"!==i.type){e.next=12;break}return e.next=10,a({zomeName:g.c.GROUP,fnName:g.a[g.c.GROUP].GET_FILES_BYTES,payload:[t.content.payload.payload.metadata.fileHash]});case 10:"error"!==(null===(p=e.sent)||void 0===p?void 0:p.type)&&c(ge(Object(l.a)({},p)));case 12:d={type:"FILE",fileName:t.content.payload.payload.metadata.fileName,fileSize:t.content.payload.payload.metadata.fileSize,fileType:t.content.payload.payload.metadata.fileType,fileHash:Object(h.b)(t.content.payload.payload.metadata.fileHash),thumbnail:u},s=d;case 14:return b=t.content.replyTo?r().groups.messages[Object(h.b)(t.content.replyTo)]:null,j={groupMessageId:Object(h.b)(t.id),groupId:Object(h.b)(t.content.groupHash),author:Object(h.b)(t.content.sender),payload:s,timestamp:Object(S.j)(t.content.created),replyTo:b?{groupId:b.groupId,author:b.author,payload:b.payload,timestamp:b.timestamp,replyTo:void 0,readList:{}}:void 0,readList:{}},m=j.groupId,O=j.groupMessageId,y=r().groups.conversations[m],v=[j.groupMessageId].concat(Object(ae.a)(y.messages)),x=Object(D.a)({},O,j),_=r().groups.messages,_=Object(l.a)(Object(l.a)({},_),x),E=r().groups.groupFiles,Object(F.d)(j.payload)||(T=Object(D.a)({},j.payload.fileHash,o),E=Object(l.a)(Object(l.a)({},E),T)),N=Object(l.a)(Object(l.a)({},r().groups.conversations),{},Object(D.a)({},m,Object(l.a)(Object(l.a)({},y),{},{messages:v}))),c({type:q.g,conversations:N,messages:_,groupFiles:E}),e.abrupt("return",j);case 28:case"end":return e.stop()}}),e)})));return function(t,n,a,r,c){return e.apply(this,arguments)}}(),je=function(e){return function(){var t=Object(O.a)(f.a.mark((function t(n,a,r){var c,s,o,i,u,l;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.callZome,s=r.retry,Object(F.d)(e.payloadInput)&&(o=e.payloadInput.payload.payload,e.payloadInput.payload={payload:o.trim()}),i={groupHash:Object(h.a)(e.groupId),payloadInput:e.payloadInput,sender:Object(h.a)(e.sender),replyTo:e.replyTo?Object(h.a)(e.replyTo):void 0},t.prev=3,t.next=6,c({zomeName:g.c.GROUP,fnName:g.a[g.c.GROUP].SEND_MESSAGE,payload:i});case 6:return u=t.sent,t.next=9,be(u,e,c,a,n);case 9:return t.abrupt("return",t.sent);case 12:if(t.prev=12,t.t0=t.catch(3),!t.t0.message.includes("failed to get the given group id")){t.next=18;break}n(Object(y.a)("TOAST",{},{id:"redux.err.group.send-group-message.1",value:{payload:Object(F.d)(e.payloadInput)?e.payloadInput.payload:e.payloadInput.payload.metadata.fileName}})),t.next=30;break;case 18:if(t.prev=18,t.t0.includes("Timed out")){t.next=24;break}return l=s({zomeName:g.c.GROUP,fnName:g.a[g.c.GROUP].SEND_MESSAGE,payload:i}),t.next=23,be(l,e,c,a,n);case 23:return t.abrupt("return",t.sent);case 24:t.next=30;break;case 26:return t.prev=26,t.t1=t.catch(18),console.log("sending of group message has failed",t.t1),t.abrupt("return",!1);case 30:return t.abrupt("return",!1);case 31:case"end":return t.stop()}}),t,null,[[3,12],[18,26]])})));return function(e,n,a){return t.apply(this,arguments)}}()},me=function(e){return function(){var t=Object(O.a)(f.a.mark((function t(n,a){var r,c,s,o,i,u,p,d,b;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=a().profile,c=r.id,s=r.username,o=a().groups,i=Object(F.d)(e.payloadInput)?{type:"TEXT",payload:{payload:e.payloadInput.payload.payload}}:{type:"FILE",fileName:e.payloadInput.payload.metadata.fileName,fileSize:e.payloadInput.payload.metadata.fileSize,fileType:e.payloadInput.payload.fileType.type,fileBytes:e.payloadInput.payload.fileBytes,thumbnail:null===(u=e.payloadInput.payload.fileType.payload)||void 0===u?void 0:u.thumbnail},p={groupMessageId:"error message",groupId:e.groupId,author:{username:s,id:c},payload:i,timestamp:new Date,replyTo:e.replyTo&&o.messages[e.replyTo]?{groupId:o.messages[e.replyTo].groupId,author:o.messages[e.replyTo].author,payload:o.messages[e.replyTo].payload,timestamp:o.messages[e.replyTo].timestamp,replyTo:void 0,readList:o.messages[e.replyTo].readList}:void 0,replyToId:e.replyTo?e.replyTo:void 0,readList:{},err:!0},d=o.errMsgs,b=d[p.groupId]?o.errMsgs[p.groupId]:[],d=Object(l.a)(Object(l.a)({},d),{},Object(D.a)({},p.groupId,[p].concat(Object(ae.a)(b)))),n({type:q.e,errMsgs:d});case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},fe=function(e,t,n){return function(){var a=Object(O.a)(f.a.mark((function a(r,c){var s,o,i,u;return f.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return(s=e.map((function(e){return e.username}))).push(c().profile.username),a.prev=2,a.next=5,r(re({name:s.join(","),members:e.map((function(e){return e.id}))}));case 5:return o=a.sent,i=[],n.forEach((function(e){var t={type:"FILE",payload:{metadata:{fileName:e.payload.metadata.fileName,fileSize:e.payload.metadata.fileSize,fileType:e.payload.metadata.fileType},fileType:e.payload.fileType,fileBytes:e.payload.fileBytes}},n={groupId:o.originalGroupId,payloadInput:t,sender:o.creator,replyTo:void 0};i.push(n)})),t.length&&i.push({groupId:o.originalGroupId,payloadInput:{type:"TEXT",payload:{payload:t}},sender:o.creator,replyTo:void 0}),u=[],i.forEach(function(){var e=Object(O.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(je(t)).then((function(e){e?u.push(e):r(me(t))}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),a.abrupt("return",{groupResult:o,messageResults:u});case 14:a.prev=14,a.t0=a.catch(2),a.t0.message.includes("cannot create group with blocked agents")?r(Object(y.a)("TOAST",{},{id:"redux.err.group.create-group.1"})):r(Object(y.a)("TOAST",{},{id:"redux.err.generic"}));case 17:return a.abrupt("return",!1);case 18:case"end":return a.stop()}}),a,null,[[2,14]])})));return function(e,t){return a.apply(this,arguments)}}()},Oe=function(e){return function(){var t=Object(O.a)(f.a.mark((function t(n,a){var r,c,s,o;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.err&&(r=a().groups,c=r.errMsgs[e.groupId]?r.errMsgs[e.groupId]:[],s=c.map((function(e){return JSON.stringify(e)})),(o=s.indexOf(JSON.stringify(e)))>-1&&c.splice(o,1),n({type:q.e,errMsgs:Object(l.a)(Object(l.a)({},r.errMsgs),{},Object(D.a)({},e.groupId,c))}));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},he=function(e){return function(){var t=Object(O.a)(f.a.mark((function t(n,a,r){var c,s,o,i;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.callZome,s=e.map((function(e){return Object(h.a)(e)})),t.prev=2,t.next=5,c({zomeName:g.c.GROUP,fnName:g.a[g.c.GROUP].GET_FILES_BYTES,payload:s});case 5:return o=t.sent,i=a().groups.groupFiles,n(ge(Object(l.a)(Object(l.a)({},i),o))),t.abrupt("return",o);case 11:if(t.prev=11,t.t0=t.catch(2),!t.t0.message.includes("The file bytes were not found")){t.next=17;break}return t.abrupt("return",n(Object(y.a)("TOAST",{},{id:"redux.err.group.set-files-bytes.1"})));case 17:return t.abrupt("return",n(Object(y.a)("TOAST",{},{id:"redux.err.generic"})));case 18:case"end":return t.stop()}}),t,null,[[2,11]])})));return function(e,n,a){return t.apply(this,arguments)}}()},ge=function(e){return function(){var t=Object(O.a)(f.a.mark((function t(n,a){var r;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=a().groups.groupFiles,n({type:q.f,filesBytes:Object(l.a)(Object(l.a)({},r),e)});case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},ye=function(e){return function(){var t=Object(O.a)(f.a.mark((function t(n,a,r){var c,s,o,i,u,p,d,b;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=r.callZome,s=a(),s.groups.conversations[e.groupId].name!==e.name){t.next=5;break}return t.abrupt("return",n(Object(y.a)("TOAST",{},{id:"redux.err.group.update-group-name.1"})));case 5:return o={name:e.name,groupId:Object(h.a)(e.groupId),groupRevisionId:Object(h.a)(e.groupRevisionId)},t.prev=6,t.next=9,c({zomeName:g.c.GROUP,fnName:g.a[g.c.GROUP].UPDATE_GROUP_NAME,payload:o});case 9:return i=t.sent,u={name:i.name,groupId:Object(h.b)(i.groupId),groupRevisionId:Object(h.b)(i.groupRevisionId)},p=u.groupId,(d=s.groups.conversations[p]).name=u.name,b=s.groups.conversations,b=Object(l.a)(Object(l.a)({},b),{},Object(D.a)({},p,d)),n({type:q.m,conversations:b}),t.abrupt("return",e);case 20:if(t.prev=20,t.t0=t.catch(6),"failed to get the given group id"!==t.t0.message){t.next=26;break}return t.abrupt("return",n(Object(y.a)("TOAST",{},{id:"redux.err.group.update-group-name.2"})));case 26:return t.abrupt("return",n(Object(y.a)("TOAST",{},{id:"redux.err.generic"})));case 27:case"end":return t.stop()}}),t,null,[[6,20]])})));return function(e,n,a){return t.apply(this,arguments)}}()},ve=n(27),xe=function(e){return function(){var t=Object(O.a)(f.a.mark((function t(n,a,r){var c,s,o,i;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.callZome,s=e.map((function(e){return Object(h.a)(e)})),t.prev=2,t.next=5,c({zomeName:g.c.P2PMESSAGE,fnName:g.a[g.c.P2PMESSAGE].GET_FILE_BYTES,payload:s});case 5:if(o=t.sent,i={},"error"===(null===o||void 0===o?void 0:o.type)){t.next=11;break}return Object.keys(o).forEach((function(e){i[e]=o[e]})),Object.entries(i).length>0&&n({type:ve.d,state:i}),t.abrupt("return",i);case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(2),n(Object(y.a)("TOAST",{},{id:"redux.err.generic"}));case 16:case"end":return t.stop()}}),t,null,[[2,13]])})));return function(e,n,a){return t.apply(this,arguments)}}()},_e=n(93),Ee=n.n(_e),Te=function(e){var t=e.file,n=e.onDownload,a=e.darken,r=void 0!==a&&a,c=e.err,s=t.fileName,i=t.fileSize,l=Object(u.c)((function(e){return Object.assign({},e.groups.groupFiles,e.p2pmessages.files)[t.fileHash]}));return Object(b.jsx)(o.o,{children:Object(b.jsxs)(o.L,{onClick:c?function(){return null}:n?function(){return n(t)}:function(){if(l){var e=new Blob([l]),n=document.createElement("a");n.href=window.URL.createObjectURL(e),n.download=t.fileName,n.click()}},className:"ion-align-items-center ".concat(Ee.a.file),children:[Object(b.jsx)("div",{className:"ion-padding-end",children:Object(b.jsx)(o.q,{className:Ee.a[r?"file-icon-dark":"file-icon-light"],size:"small",icon:I.u})}),Object(b.jsxs)("div",{className:"ion-align-items-center",children:[Object(b.jsx)(o.L,{children:Object(b.jsx)(o.y,{className:"".concat(Ee.a["file-name"]),children:Object(b.jsx)("p",{className:"ion-no-margin ion-text-wrap",children:s})})}),Object(b.jsx)(o.L,{children:Object(b.jsx)(o.Y,{className:Ee.a["file-size"],children:Object(b.jsx)("span",{children:Object(S.a)(i)})})})]})]})})},Se=n(118),Ne=n.n(Se),Ie=function(e){var t=e.state,n=e.src,r=e.file,c=e.onDownload,s=Object(k.a)(),l=Object(i.a)(t,2),p=l[0],d=l[1],j=Object(a.useRef)(null),m=Object(a.useRef)(null),f=Object(a.useState)("0px"),O=Object(i.a)(f,2),h=O[0],g=O[1],y=Object(a.useState)({isOpen:!1,event:void 0}),v=Object(i.a)(y,2),x=v[0],_=v[1],E=Object(u.c)((function(e){return Object.assign({},e.groups.groupFiles,e.p2pmessages.files)[r.fileHash]}));Object(a.useEffect)((function(){p&&g(j.current&&m.current?"calc(100vh - ".concat(j.current.getBoundingClientRect().height,"px - ").concat(m.current.getBoundingClientRect().height,"px)"):"0px")}),[p]);return Object(b.jsx)(o.E,{isOpen:p,cssClass:"fullscreen",children:Object(b.jsxs)(o.G,{children:[Object(b.jsx)(o.p,{children:Object(b.jsxs)(o.eb,{className:Ne.a.toolbar,ref:m,children:[Object(b.jsx)(o.f,{children:Object(b.jsx)(o.e,{onClick:function(){return d(!1)},children:Object(b.jsx)(o.q,{icon:I.c})})}),Object(b.jsx)(o.f,{slot:"end",children:Object(b.jsx)(o.e,{onClick:function(e){e.persist(),_({isOpen:!0,event:e})},children:Object(b.jsx)(o.q,{icon:I.y})})})]})}),Object(b.jsx)("div",{className:Ne.a.content,style:{height:h},children:Object(b.jsx)("img",{style:Object(D.a)({},window.innerWidth>window.innerHeight?"height":"width","100%"),alt:"Message content",src:n})}),Object(b.jsx)(o.H,{event:x.event,isOpen:x.isOpen,onDidDismiss:function(){return _({isOpen:!1,event:void 0})},children:Object(b.jsx)(o.z,{children:Object(b.jsx)(o.v,{lines:"none",button:!0,onClick:c?function(){return c(r)}:function(){if(E){var e=new Blob([E]),t=document.createElement("a");t.href=window.URL.createObjectURL(e),t.download=r.fileName,t.click(),_({isOpen:!1,event:void 0})}},children:Object(b.jsx)(o.y,{children:s.formatMessage({id:"components.chat.media-modal-download"})})})})}),Object(b.jsx)(o.n,{children:Object(b.jsx)(o.eb,{className:Ne.a.toolbar,ref:j})})]})})},ke=n(173),Me=n.n(ke),we=function(e){var t=e.src,n=e.file,r=e.className,c=e.onDownload,s=e.err,u=Object(a.useState)(!1),l=Object(i.a)(u,2),p=l[0],d=l[1];return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(Ie,{onDownload:c,state:[p,d],src:t,file:n}),Object(b.jsx)("div",{className:"".concat(Me.a.image," ").concat(r||""),children:Object(b.jsx)(o.r,{onClick:function(){s||d(!0)},src:t})})]})},Re=n(26),Pe=n(81),Ge=n.n(Pe),Ce=function(e){var t=e.video,n=e.isPlaying,r=e.duration,c=e.modal,s=e.hasError,u=e.onPlayPauseErrorHandler,l=Object(a.useState)(Object(Re.e)("mobile")),p=Object(i.a)(l,2),d=p[0],j=p[1],m=Object(i.a)(c,2),f=m[0],O=m[1],h=Object(a.useRef)(),g=Object(a.useState)(!1),y=Object(i.a)(g,2),v=y[0],x=y[1];Object(a.useEffect)((function(){s||x(!1)}),[s]);var _=function(){h.current&&clearTimeout(h.current),h.current=setTimeout((function(){j(!1)}),1e3)},E=function(){O(!f)},T=function(){var e,a;s?(x(!0),u&&u()):n?null===(a=t.current)||void 0===a||a.pause():null===(e=t.current)||void 0===e||e.play()};return Object(b.jsxs)("div",{onMouseEnter:function(){j(!0),h.current&&clearTimeout(h.current)},onMouseLeave:_,onClick:function(){j(!0),_()},onDoubleClick:E,className:Ge.a.controls,style:{opacity:d?1:0},children:[Object(b.jsx)("div",{className:Ge.a["play-pause"],onClick:T,onTouchEnd:T,children:v?Object(b.jsx)(o.T,{}):Object(b.jsx)(o.q,{icon:s?n?I.F:I.w:n?I.F:I.P})}),Object(b.jsxs)("div",{className:Ge.a["range-slider-expand"],children:[Object(b.jsx)("div",{className:Ge.a["range-slider"],children:Object(b.jsx)("input",{type:"range",onChange:function(){},value:100*r,min:0,max:100})}),Object(b.jsx)("div",{className:Ge.a.expand,children:Object(b.jsx)(o.q,{onClick:E,onTouchEnd:E,icon:I.z})})]})]})},Ae=n(133),Le=n.n(Ae),De=n(82),He=n.n(De),Fe=function(e){var t=e.open,n=e.src,r=e.download,c=e.onPlayPauseErrorHandler,s=Object(k.a)(),u=Object(i.a)(t,2),l=u[0],p=u[1],d=Object(a.useState)({isOpen:!1,event:void 0}),j=Object(i.a)(d,2),m=j[0],f=j[1],O=Object(a.useRef)(null),h=Object(a.useRef)(null),g=Object(a.useState)("0px"),y=Object(i.a)(g,2),v=y[0],x=y[1],_=Object(a.useState)(0),E=Object(i.a)(_,2),T=E[0],S=E[1],N=Object(a.useState)(!1),M=Object(i.a)(N,2),w=M[0],R=M[1],P=Object(a.useState)(!1),G=Object(i.a)(P,2),C=G[0],A=G[1],L=Object(a.useRef)(),H=Object(a.useState)(!1),F=Object(i.a)(H,2),U=F[0],B=F[1],z=Object(a.useRef)(null),q=Object(a.useState)(!1),Y=Object(i.a)(q,2),V=Y[0],Z=Y[1];Object(a.useEffect)((function(){l&&x(O.current&&h.current?"calc(100vh - ".concat(O.current.getBoundingClientRect().height,"px - ").concat(h.current.getBoundingClientRect().height,"px)"):"0px")}),[l]),Object(a.useEffect)((function(){U||Z(!1)}),[U]);var X=function(){c&&c(B)};return Object(b.jsx)(o.E,{isOpen:l,cssClass:"fullscreen",children:Object(b.jsxs)(o.G,{children:[Object(b.jsx)(o.p,{children:Object(b.jsxs)(o.eb,{ref:h,className:He.a.toolbar,children:[Object(b.jsx)(o.f,{children:Object(b.jsx)(o.e,{onTouchEnd:function(){A(!1),p(!1)},onClick:function(){A(!1),p(!1)},children:Object(b.jsx)(o.q,{icon:I.c})})}),Object(b.jsx)(o.f,{slot:"end",children:Object(b.jsx)(o.e,{onTouchEnd:function(e){e.persist(),f({isOpen:!0,event:e})},onClick:function(e){e.persist(),f({isOpen:!0,event:e})},children:Object(b.jsx)(o.q,{icon:I.y})})})]})}),Object(b.jsxs)("div",{className:He.a.content,style:{height:v},onClick:function(){R(!0),L.current&&clearTimeout(L.current),L.current=setTimeout((function(){R(!1)}),3e3)},children:[Object(b.jsx)("video",{ref:z,style:Object(D.a)({},window.innerWidth>window.innerHeight?"height":"width","100%"),onError:function(){B(!0)},autoPlay:!1,controls:!1,onTimeUpdate:function(){return S(z.current.currentTime/z.current.duration)},onPlay:function(){A(!0)},onPause:function(){A(!1)},loop:!1,src:n}),z.current?Object(b.jsx)("div",{style:{opacity:w?1:0},className:He.a["modal-control"],children:V?Object(b.jsx)(o.T,{}):Object(b.jsx)("div",{className:He.a["play-pause"],onClick:function(){var e,t;U?(Z(!0),c&&X()):C?null===(t=z.current)||void 0===t||t.pause():null===(e=z.current)||void 0===e||e.play()},children:Object(b.jsx)(o.q,{icon:C?I.F:I.P})})}):null]}),Object(b.jsx)(o.n,{children:Object(b.jsx)(o.eb,{ref:O,children:Object(b.jsx)("div",{className:He.a["slider-volume"],children:Object(b.jsx)("input",{step:100*T,value:100*T,min:0,max:100,type:"range"})})})}),Object(b.jsx)(o.H,{event:m.event,isOpen:m.isOpen,onDidDismiss:function(){return f({isOpen:!1,event:void 0})},children:Object(b.jsx)(o.z,{children:r?Object(b.jsx)(o.v,{lines:"none",button:!0,onClick:function(){r(),f({isOpen:!1,event:void 0})},children:Object(b.jsx)(o.y,{children:s.formatMessage({id:"components.chat.media-modal-download"})})}):null})})]})})},Ue=function(e){var t=e.src,n=e.className,r=e.thumbnail,c=e.download,s=e.onPlayPauseErrorHandler,o=e.err,u=[Le.a["video-player"]];n&&u.push(n);var l=Object(a.useRef)(null),p=Object(a.useState)(!1),d=Object(i.a)(p,2),j=d[0],m=d[1],f=Object(a.useState)(0),O=Object(i.a)(f,2),h=O[0],g=O[1],y=Object(a.useState)(!1),v=Object(i.a)(y,2),x=v[0],_=v[1],E=Object(a.useState)(!1),T=Object(i.a)(E,2),S=T[0],N=T[1],I=Object(a.useRef)(null);return Object(b.jsxs)("div",{ref:I,className:u.join(" "),onDoubleClick:function(){m(!1),_(!0)},children:[Object(b.jsx)("video",{className:Le.a.video,onTimeUpdate:function(){return g(isNaN(l.current.currentTime/l.current.duration)?0:l.current.currentTime/l.current.duration)},poster:r,onPlay:function(){m(!0)},onPause:function(){m(!1)},ref:l,controls:!1,loop:!1,autoPlay:!1,src:t,onError:function(e){return N(!0)}}),o?null:Object(b.jsx)(Ce,{isPlaying:j,hasError:S,onPlayPauseErrorHandler:function(){s&&s(N)},duration:h,video:l,modal:[x,_]}),Object(b.jsx)(Fe,{download:c,onPlayPauseErrorHandler:s,src:t,open:[x,_]})]})},Be=n(134),ze=n.n(Be),qe=function(e){var t=e.file,n=e.onDownload,r=e.onPlayPauseErrorHandler,c=e.err,s=Object(u.c)((function(e){return Object.assign({},e.groups.groupFiles,e.p2pmessages.files)[t.fileHash]})),o=function(){if(s){var e=new Blob([s]),n=document.createElement("a");n.href=window.URL.createObjectURL(e),n.download=t.fileName,n.click()}},i=Object(a.useMemo)((function(){return Object(b.jsx)(Ue,{download:c?function(){return null}:n?function(){return n(t)}:o,src:URL.createObjectURL(new Blob([s],{type:"video/mp4"})),className:ze.a.video,thumbnail:URL.createObjectURL(new Blob([t.thumbnail],{type:"image/jpeg"})),onPlayPauseErrorHandler:r,err:c})}),[s]);return Object(b.jsx)("div",{className:ze.a.video,children:i})},Ye=function(e){e.timestamp;var t=e.file,n=(e.type,e.onDownload),a=e.chatType,r=e.err,c=new TextDecoder("utf-8"),s=Object(S.k)();return function(){switch(null===t||void 0===t?void 0:t.fileType){case"IMAGE":return Object(b.jsx)(we,{onDownload:n,file:t,src:c.decode(t.thumbnail),err:r});case"OTHER":return Object(b.jsx)(Te,{onDownload:n,file:t,err:r});case"VIDEO":return Object(b.jsx)(qe,{onDownload:n,file:t,onPlayPauseErrorHandler:function(e){"p2p"===a?s(xe([t.fileHash])).then((function(t){t&&e(!1)})):s(he([t.fileHash])).then((function(t){t&&e(!1)}))},err:r});default:return null}}()},Ve=n(68),Ze=n.n(Ve),Xe=function(e){var t,n,a,r,c,s,i,u=e.me,l=e.message,p=Object(S.f)(null===l||void 0===l?void 0:l.payload),d=new TextDecoder,j=["".concat(Ze.a["reply-to"])];return Object(b.jsxs)("div",{className:j.join(" "),children:[Object(b.jsx)("div",{className:"".concat(u?Ze.a["vertical-divider-me"]:Ze.a["vertical-divider-others"]," ion-margin-end")}),p?null:"OTHER"===(null===(t=l.payload)||void 0===t?void 0:t.fileType)?Object(b.jsx)(o.q,{className:"ion-margin-end",icon:I.u}):Object(b.jsx)(o.ab,{className:"".concat(Ze.a.thumbnail," ion-margin-end"),children:Object(b.jsx)("img",{alt:"Thumbnail",src:"VIDEO"===(null===l||void 0===l||null===(n=l.payload)||void 0===n?void 0:n.fileType)?URL.createObjectURL(new Blob([null===(a=l.payload)||void 0===a?void 0:a.thumbnail])):d.decode(null===l||void 0===l||null===(r=l.payload)||void 0===r?void 0:r.thumbnail)})}),Object(b.jsxs)("div",{className:"".concat(u?Ze.a["content-me"]:Ze.a["content-others"]),children:[Object(b.jsx)(o.y,{children:null===l||void 0===l?void 0:l.author.username}),Object(b.jsx)("p",{className:Ze.a["sub-label"],children:p?null===l||void 0===l||null===(c=l.payload)||void 0===c||null===(s=c.payload)||void 0===s?void 0:s.payload:null===l||void 0===l||null===(i=l.payload)||void 0===i?void 0:i.fileName})]})]})},Je=n(36),Ke=n.n(Je),Qe=n(174),We=n.n(Qe),$e=function(e){var t=e.message,n=e.type;return Object(b.jsx)(o.Y,{className:We.a["me"===n?"me":"others"],children:t.payload.payload})},et=function(e){var t=e.id,n=e.payload,r=e.author,c=e.timestamp,s=e.replyTo,u=e.onReply,p=e.onDelete,d=e.onPinMessage,m=e.isPinned,f=e.type,O=e.showProfilePicture,h=e.isSeen,g=void 0!==h&&h,y=e.onDownload,v=e.onRetry,x=e.err,_=Object(k.a)(),E=Object(a.useState)(!1),T=Object(i.a)(E,2),N=T[0],M=T[1],w=function(e){return G({event:e.nativeEvent})},R=Object(o.ob)(te,{onHide:function(){return C()},onPin:d,onReply:function(){u&&u({author:r,payload:n,id:t})},onDelete:function(){p&&p()},onRetry:function(){v&&v(M)},isPinned:m,intl:_,err:x}),P=Object(i.a)(R,2),G=P[0],C=P[1],A=Object(S.l)(w,(function(){})),L=Object(F.d)(n),D="p2p"===f;return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)(o.v,Object(l.a)(Object(l.a)({lines:"none",className:"".concat(Ke.a["me-container"])},A),{},{onClick:function(e){return x?w(e):null},children:[Object(b.jsxs)("div",{className:"".concat(Ke.a.me," ").concat(Ke.a[L?"text":"file"]," ").concat(Ke.a.bubble),children:[s?Object(b.jsx)(Xe,{me:!0,message:s}):null,L?Object(b.jsx)($e,{type:"me",message:n}):Object(b.jsx)(Ye,{chatType:D?"p2p":"group",onDownload:y,type:"me",timestamp:c,file:n,err:x}),Object(b.jsx)(o.Y,{children:Object(b.jsxs)("h6",{className:"ion-no-margin ion-text-end",children:[_.formatTime(c),Object(b.jsx)(o.q,{size:"medium",icon:g?I.m:I.l})]})})]}),x?N?Object(b.jsx)("div",{className:Ke.a.picture,children:Object(b.jsx)(j,{})}):Object(b.jsx)(o.q,{color:"danger",className:Ke.a.picture,style:{marginLeft:"0.5rem"},icon:I.b}):D?null:Object(b.jsx)("div",{className:Ke.a.picture,style:{marginLeft:"0.5rem"},children:O?Object(b.jsx)("img",{className:Ke.a.avatar,alt:"".concat(r,"'s profile"),src:I.L}):null})]})),x?N?null:Object(b.jsx)(o.v,{lines:"none",className:Ke.a["not-delivered-container"],children:Object(b.jsx)(o.Y,{className:Ke.a["not-delivered"],color:"danger",children:"Not delivered"})}):null]})},tt=function(e){var t=e.timestamp,n=e.onSeen,r=Object(k.a)(),c=Object(a.useRef)(),s=Object(a.useRef)(null),u={root:document.querySelector(".chat-list"),rootMargin:"0px",threshold:1},l=Object(a.useState)(!1),p=Object(i.a)(l,2),d=p[0],j=p[1];Object(a.useEffect)((function(){var e,t;null===(e=c.current)||void 0===e||e.disconnect(),c.current=new IntersectionObserver((function(){n&&(d||(j(!0),n(m)))}),u),s.current&&(null===(t=c.current)||void 0===t||t.observe(s.current))}),[d,s.current]);var m=function(){d&&j(!1)};return Object(b.jsx)(o.Y,{ref:s,children:Object(b.jsx)("h6",{className:"ion-no-margin ion-text-end",children:r.formatTime(t)})})},nt=function(e){var t=e.id,n=e.author,a=e.type,r=e.timestamp,c=e.payload,s=(e.readList,e.onSeen),u=e.showProfilePicture,p=e.showName,d=e.onReply,j=e.isPinned,m=e.onPinMessage,f=e.replyTo,O=(e.isSeen,e.onDownload),h=Object(k.a)(),g=Object(o.ob)(te,{onHide:function(){return x()},onPin:m,onReply:function(){d&&d({author:n,payload:c,id:t})},isPinned:j,intl:h}),y=Object(i.a)(g,2),v=y[0],x=y[1],_=Object(S.l)((function(e){v({event:e.nativeEvent})}),(function(){})),E=Object(F.d)(c),T="p2p"===a;return Object(b.jsxs)(b.Fragment,{children:[T?null:p?Object(b.jsx)(o.v,{lines:"none",className:"".concat(Ke.a["author-name"]),children:Object(b.jsx)(o.Y,{color:"medium",children:n})}):null,Object(b.jsxs)(o.v,Object(l.a)(Object(l.a)({lines:"none",className:"".concat(Ke.a["others-container"])},_),{},{children:[T?null:Object(b.jsx)("div",{className:Ke.a.picture,style:{marginRight:"0.5rem"},children:u?Object(b.jsx)("img",{className:Ke.a.avatar,src:"".concat(I.L),alt:"".concat(n,"'s profile")}):null}),Object(b.jsxs)("div",{className:"".concat(Ke.a.others," ").concat(Ke.a[E?"text":"file"]," ").concat(Ke.a.bubble),children:[f?Object(b.jsx)(Xe,{me:!1,message:f}):null,E?Object(b.jsx)($e,{type:"others",message:c}):Object(b.jsx)(Ye,{chatType:T?"p2p":"group",onDownload:O,type:"others",file:c,timestamp:r}),Object(b.jsx)(tt,{onSeen:s,timestamp:r})]})]}))]})},at={ChatList:W,Me:et,Others:nt},rt=at,ct=n(135),st=n.n(ct),ot=function(e){var t=e.profiles,n=(e.disabled,Object(k.a)()),a=function(e){switch(e.length){case 0:return null;case 1:return", ".concat(e[0].username);default:return Object(b.jsxs)("span",{children:[", ",e.length," others "]})}};return t.length>0?Object(b.jsxs)("div",{className:"".concat(st.a.typing," ion-padding-start"),children:[function(e){if(1===e.length)return Object(b.jsx)("span",{children:n.formatMessage({id:"components.typing.is-typing"},{user:e[0].username})});var t="".concat(e.slice(0,2).map((function(e){return e.username})).join(", ")),r=e.slice(2,e.length);return Object(b.jsxs)("span",{children:[t,a(r)," are typing"]})}(t),[".",".","."].map((function(e,t){return Object(b.jsx)("span",{style:{animationDelay:"".concat(.3*t,"s")},className:st.a.dot,children:e},t)}))]}):null},it=Object(a.createContext)({showToast:function(){},dismissToast:function(){},showErrorToast:function(){}}),ut=function(){var e=Object(a.useContext)(it);if(!e)throw new Error("Cannot get toast context :(");return e},lt=function(e){var t=e.message,n=e.files,a=e.onSend,r=e.loading;return Object(b.jsx)(o.f,{slot:"end",children:Object(b.jsx)(o.e,{type:"submit",onClick:a,disabled:0===t.length&&0===n.length,children:r?Object(b.jsx)(j,{}):Object(b.jsx)(o.q,{color:"medium",icon:I.X})})})},pt=n(136),dt=n.n(pt),bt=function(e){var t=e.file,n=e.files,r=e.setFiles,c=function(e){t.value="",r((function(t){return t.splice(e,1),Object(ae.a)(t)}))},s=new TextDecoder;return Object(b.jsx)(o.L,{className:dt.a.row,children:n.map((function(e,t){return Object(a.createElement)(o.h,Object(l.a)(Object(l.a)({},"IMAGE"===e.fileType.type||"VIDEO"===e.fileType.type?{style:{backgroundImage:"url(".concat((n=e.fileType.type,r=e.fileType.payload.thumbnail,"IMAGE"===n?s.decode(r):URL.createObjectURL(new Blob([r],{type:"image/jpeg"}))),")"),backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"cover"}}:{}),{},{className:dt.a.chip,key:t}),"IMAGE"===e.fileType.type||"VIDEO"===e.fileType.type?null:Object(b.jsx)(o.y,{children:e.metadata.fileName}),Object(b.jsx)(o.q,{icon:I.q,onClick:function(){return c(t)}}));var n,r}))})},jt=n(42),mt=n.n(jt),ft=function(e){var t=e.messageState,n=Object(i.a)(t,2),a=n[0],r=n[1];return Object(b.jsxs)("div",{className:"ion-padding-start ion-padding-end ".concat(mt.a.row," ").concat(mt.a.reply),children:[Object(b.jsx)(o.q,{icon:I.r,onClick:function(){r(null)}}),function(){if("TEXT"===a.payload.type)return Object(b.jsxs)("div",{className:"".concat(mt.a.column," ion-padding-start"),children:[Object(b.jsx)("span",{className:mt.a.author,children:a.author}),Object(b.jsx)("span",{className:mt.a.text,children:a.payload.payload.payload})]});switch(a.payload.fileType){case"OTHER":return Object(b.jsxs)("div",{className:"".concat(mt.a.row," ion-padding-start"),children:[Object(b.jsx)(o.q,{icon:I.v}),Object(b.jsxs)("div",{className:"".concat(mt.a.column," ion-padding-start"),children:[Object(b.jsx)("span",{className:mt.a.author,children:a.author}),Object(b.jsx)("span",{className:mt.a.text,children:a.payload.fileName})]})]});case"IMAGE":case"VIDEO":var e,t=new TextDecoder;return Object(b.jsx)("div",{children:Object(b.jsxs)("div",{className:"".concat(mt.a.row," ion-padding-start"),children:[Object(b.jsx)(o.ab,{className:mt.a.thumbnail,children:Object(b.jsx)("img",{alt:"Thumbnail",src:"VIDEO"===(null===(e=a.payload)||void 0===e?void 0:e.fileType)?URL.createObjectURL(new Blob([a.payload.thumbnail])):t.decode(a.payload.thumbnail)})}),Object(b.jsxs)("div",{className:"".concat(mt.a.column," ion-padding-start"),children:[Object(b.jsx)("span",{className:mt.a.author,children:a.author}),Object(b.jsx)("span",{className:mt.a.text,children:a.payload.fileName})]})]})});default:return null}}()]})},Ot=n(137),ht=n.n(Ot),gt=function(e,t){var n=e.onChange,r=e.onSend,c=e.onFileSelect,s=Object(a.useState)(""),u=Object(i.a)(s,2),l=u[0],p=u[1],d=Object(k.a)(),j=Object(a.useState)(void 0),m=Object(i.a)(j,2),f=m[0],O=m[1],h=Object(a.useState)(!1),g=Object(i.a)(h,2),y=g[0],v=g[1],x=Object(a.useRef)(null),_=Object(a.useState)([]),E=Object(i.a)(_,2),T=E[0],S=E[1],N=Object(a.useCallback)((function(){c&&c(T)}),[T]);Object(a.useImperativeHandle)(t,(function(){return{reply:function(e){O(e)}}}));var M=Object(a.useCallback)((function(){n&&n(l)}),[l]),w=function(){O(void 0),p(""),S([]),x.current&&(x.current.value="")},R=function(e){r&&"Enter"===e.key&&!e.shiftKey&&(0!==l.trim().length||T.length>0)&&(r({files:T,message:l,reply:null===f||void 0===f?void 0:f.id,setIsLoading:v}),w())};Object(a.useEffect)((function(){return document.addEventListener("keydown",R),function(){document.removeEventListener("keydown",R)}}),[r,w]),Object(a.useEffect)((function(){N()}),[T,N]),Object(a.useEffect)((function(){M()}),[l,M]);var P=ut().showToast,G=Object(a.useMemo)((function(){return T.length>0?Object(b.jsx)(bt,{file:x.current,files:T,setFiles:S}):null}),[T]);return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)(o.n,{children:[f?Object(b.jsx)(ft,{messageState:[f,O]}):null,G,Object(b.jsxs)(o.eb,{className:ht.a.toolbar,children:[Object(b.jsx)(o.f,{slot:"start",children:T.length>0?null:Object(b.jsx)(o.e,{onClick:function(){var e;return null===x||void 0===x||null===(e=x.current)||void 0===e?void 0:e.click()},children:Object(b.jsx)(o.q,{color:"medium",icon:I.g})})}),Object(b.jsx)(o.Z,{value:l,onKeyDown:function(e){if("Enter"===e.key&&!e.shiftKey)return e.preventDefault(),!1},className:ht.a.textarea,onIonChange:function(e){return p(e.detail.value)},autoGrow:!0,placeholder:d.formatMessage({id:"app.new-conversation.message-placeholder"})}),Object(b.jsx)(lt,{files:T,onSend:function(){r&&r({files:T,message:l,reply:null===f||void 0===f?void 0:f.id,setIsLoading:v}),w()},message:l,loading:y})]})]}),Object(b.jsx)("input",{ref:x,type:"file",hidden:!0,onChange:function(){Array.from(x.current?x.current.files:new FileList).forEach((function(e){e.arrayBuffer().then((function(t){var n=e.size,a=e.name;if(n<15728640){var r=new Uint8Array(t),c=function(e){switch(e){case"video/mpeg":case"video/mp4":return"VIDEO";case"image/png":case"image/jpeg":return"IMAGE";default:return"OTHER"}}(e.type);if("IMAGE"===c){var s=new TextEncoder,o=new FileReader;o.readAsDataURL(e),o.onload=function(e){var t,o=s.encode(null===(t=e.target)||void 0===t?void 0:t.result),i={metadata:{fileName:a,fileType:c,fileSize:n},fileType:{type:c,payload:{thumbnail:o}},fileBytes:r};S((function(e){return e.push(i),Object(ae.a)(e)}))}}else if("VIDEO"===c){var i=document.createElement("video"),u=URL.createObjectURL(new Blob([r],{type:"video/mp4"})),l=";base64,",p=function(){var e,t=document.createElement("canvas");t.width=i.videoWidth,t.height=i.videoHeight,null===(e=t.getContext("2d"))||void 0===e||e.drawImage(i,0,0,t.width,t.height);var s=t.toDataURL("image/jpeg"),o=s.length>10;if(o){var p,d=document.createElement("img");if(document.getElementsByTagName("div")[0].appendChild(d),URL.revokeObjectURL(u),null===(p=s.split(l)[1])||void 0===p?void 0:p.trim()){for(var b,j=window.atob(null===(b=s.split(l)[1])||void 0===b?void 0:b.trim()),m=new Array(j.length),f=0;f<j.length;f++)m[f]=j.charCodeAt(f);var O=new Uint8Array(m),h={metadata:{fileName:a,fileType:c,fileSize:n},fileType:{type:c,payload:{thumbnail:O}},fileBytes:r};S((function(e){return e.push(h),Object(ae.a)(e)}))}}return o};i.src=u,i.addEventListener("timeupdate",(function e(){p()&&(i.removeEventListener("timeupdate",e),i.pause())})),i.preload="metadata",i.muted=!0,i.play()}else{var b={metadata:{fileName:a,fileType:c,fileSize:n},fileType:{type:c},fileBytes:r};S((function(e){return e.push(b),Object(ae.a)(e)}))}}else P({message:d.formatMessage({id:"components.message-input.over-size-limit"},{fileName:a}),color:"danger",duration:2500})}))}))}})]})},yt=Object(a.forwardRef)(gt),vt=function(e){return function(){var t=Object(O.a)(f.a.mark((function t(n,a,r){var c,s;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.callZome,s=a().contacts.contacts,t.prev=2,t.next=5,c({zomeName:g.c.CONTACTS,fnName:g.a[g.c.CONTACTS].ADD_CONTACTS,payload:[Object(h.a)(e.id)]});case 5:return s[e.id]=e,n({type:H.b,contacts:s}),t.abrupt("return",!0);case 10:t.prev=10,t.t0=t.catch(2),t.t0.message.includes("agent already added")?n(Object(y.a)("TOAST",{},{id:"redux.err.contacts.add-contact.1",value:{username:e.username}})):t.t0.message.includes("agent is blocked")&&n(Object(y.a)("TOAST",{},{id:"redux.err.contacts.add-contact.2",value:{username:e.username}}));case 13:return t.abrupt("return",!1);case 14:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e,n,a){return t.apply(this,arguments)}}()},xt=function(e){return function(){var t=Object(O.a)(f.a.mark((function t(n,a,r){var c,s,o,i;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.callZome,s=a().contacts,o=s.contacts,i=s.blocked,t.prev=2,i[e.id]=e,t.next=6,c({zomeName:g.c.CONTACTS,fnName:g.a[g.c.CONTACTS].BLOCK_CONTACTS,payload:[Object(h.a)(e.id)]});case 6:return delete o[e.id],n({type:H.a,blocked:i}),n({type:H.b,contacts:o}),t.abrupt("return",!0);case 12:t.prev=12,t.t0=t.catch(2),t.t0.message.includes("this agent is already blocked")&&n(Object(y.a)("TOAST",{},{id:"redux.err.contacts.block-contact.1",value:{username:e.username}}));case 15:return t.abrupt("return",!1);case 16:case"end":return t.stop()}}),t,null,[[2,12]])})));return function(e,n,a){return t.apply(this,arguments)}}()},_t=function(){return function(){var e=Object(O.a)(f.a.mark((function e(t,n,a){var r,c,s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.callZome,e.prev=1,e.next=4,r({zomeName:g.c.CONTACTS,fnName:g.a[g.c.CONTACTS].LIST_ADDED});case 4:return c=e.sent,s={},e.prev=6,e.next=9,r({zomeName:g.c.PROFILES,fnName:g.a[g.c.PROFILES].GET_AGENTS_PROFILES,payload:c});case 9:return e.sent.forEach((function(e){var t=e.agent_pub_key;s[t]={id:t,username:e.profile.nickname}})),t({type:H.b,contacts:s}),e.abrupt("return",s);case 15:e.prev=15,e.t0=e.catch(6),t(Object(y.a)("TOAST",{},{id:"redux.err.contacts.fetch-my-contacts.1"}));case 18:e.next=23;break;case 20:e.prev=20,e.t1=e.catch(1),t(Object(y.a)("TOAST",{},{id:"redux.err.generic"}));case 23:return e.abrupt("return",null);case 24:case"end":return e.stop()}}),e,null,[[1,20],[6,15]])})));return function(t,n,a){return e.apply(this,arguments)}}()},Et=function(e){return function(){var t=Object(O.a)(f.a.mark((function t(n,a,r){var c,s;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.callZome,s=a().contacts.contacts,t.prev=2,t.next=5,c({zomeName:g.c.CONTACTS,fnName:g.a[g.c.CONTACTS].REMOVE_CONTACTS,payload:[Object(h.a)(e.id)]});case 5:return delete s[e.id],n({type:H.b,contacts:s}),t.abrupt("return",!0);case 10:t.prev=10,t.t0=t.catch(2),n(Object(y.a)("TOAST",{},{id:"redux.err.generic"}));case 13:return t.abrupt("return",!1);case 14:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e,n,a){return t.apply(this,arguments)}}()},Tt=function(e){return function(){var t=Object(O.a)(f.a.mark((function t(n,a,r){var c,s;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.callZome,s=a().contacts.blocked,t.prev=2,t.next=5,c({zomeName:g.c.CONTACTS,fnName:g.a[g.c.CONTACTS].UNBLOCK_CONTACTS,payload:[Object(h.a)(e.id)]});case 5:return delete s[e.id],n({type:H.a,blocked:s}),t.abrupt("return",!0);case 10:t.prev=10,t.t0=t.catch(2),n(Object(y.a)("TOAST",{},{id:"redux.err.generic"}));case 13:return t.abrupt("return",!1);case 14:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e,n,a){return t.apply(this,arguments)}}()},St=n(75),Nt=n(90),It=n(138),kt=n(139),Mt=(n(175),function(e){return function(){var t=Object(O.a)(f.a.mark((function t(n,a){var r,c,s,o;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.err&&(r=a().p2pmessages.errMsgs,c=r[e.receiver.id]?r[e.receiver.id]:[],s=c.map((function(e){return JSON.stringify(e)})),(o=s.indexOf(JSON.stringify(e)))>-1&&c.splice(o,1),n({type:ve.c,state:{errMsgs:Object(l.a)(Object(l.a)({},r),{},Object(D.a)({},e.receiver.id,c))}}));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}),wt=n(54),Rt=function(e,t,n,a,r){return function(c,s){var o,i,u=s().profile,p=u.id,d=u.username,b=s().contacts.contacts,j=s().p2pmessages.messages;"TEXT"===n?o={type:"TEXT",payload:{payload:t.trim()}}:o={type:"FILE",fileName:r.metadata.fileName,fileSize:r.metadata.fileSize,fileType:r.fileType.type,fileBytes:r.fileBytes,thumbnail:null===(i=r.fileType.payload)||void 0===i?void 0:i.thumbnail};var m={p2pMessageEntryHash:"error message",author:{id:p,username:d},receiver:{id:e,username:b[e].username},payload:o,timestamp:new Date,replyTo:a&&j[a]?{p2pMessageEntryHash:j[a].p2pMessageEntryHash,author:j[a].author,receiver:j[a].receiver,payload:j[a].payload,timestamp:j[a].timestamp,replyTo:void 0,receipts:[]}:void 0,receipts:[],replyToId:a,err:!0},f=s().p2pmessages.errMsgs,O=s().p2pmessages.errMsgs[e]?s().p2pmessages.errMsgs[e]:[];return f=Object(l.a)(Object(l.a)({},f),{},Object(D.a)({},e,[m].concat(Object(ae.a)(O)))),c({type:ve.c,state:{errMsgs:f}}),!0}},Pt=n(176),Gt=n.n(Pt),Ct=function(e){var t=e.nickname,n=e.id,a=e.charToShow,r=e.displayId,c=void 0===r||r,s=n.slice(5);return Object(b.jsxs)(b.Fragment,{children:[t,c?function(e,t){return Object(b.jsx)("span",{className:Gt.a.label,children:t?e.slice(0,t).concat("..."):e})}(s,a):null]})},At=n(119),Lt=n.n(At),Dt=function(e){var t=e.history,n=e.conversant,a=e.onHide,r=e.pathname,c=e.intl;return Object(b.jsxs)(o.z,{children:[Object(b.jsxs)(o.v,{button:!0,onClick:function(){a(),t.push({pathname:"".concat(r,"/details"),state:{conversant:n}})},children:[Object(b.jsx)(o.q,{slot:"start",icon:I.B}),Object(b.jsx)(o.y,{children:c.formatMessage({id:"app.chat.header-details"})})]}),Object(b.jsxs)(o.v,{button:!0,onClick:function(){t.push({pathname:"/u/".concat(n.id,"/search")}),a()},children:[Object(b.jsx)(o.q,{slot:"start",icon:I.U}),Object(b.jsx)(o.y,{children:c.formatMessage({id:"app.chat.header-search"})})]}),Object(b.jsxs)(o.v,{button:!0,onClick:function(){t.push({pathname:"/u/".concat(n.id,"/pinned")}),a()},children:[Object(b.jsx)(o.q,{slot:"start",icon:I.N}),Object(b.jsx)(o.y,{children:c.formatMessage({id:"app.chat.header-pinned-messages"})})]})]})},Ht=function(e){var t=e.id,n=e.username,a=e.pathname,r=e.conversant,c=Object(N.f)(),s=Object(k.a)(),u=Object(o.ob)(Dt,{onHide:function(){return d()},history:c,conversant:r,pathname:a,intl:s}),l=Object(i.a)(u,2),p=l[0],d=l[1];return Object(b.jsx)(o.p,{children:Object(b.jsxs)(o.eb,{children:[Object(b.jsx)(o.f,{slot:"start",children:Object(b.jsx)(o.e,{onClick:function(){return c.push({pathname:"/home"})},className:"ion-no-padding",children:Object(b.jsx)(o.q,{slot:"icon-only",icon:I.e})})}),Object(b.jsxs)("div",{className:Lt.a["title-container"],children:[Object(b.jsx)(o.b,{className:"ion-padding",children:Object(b.jsx)("img",{className:Lt.a.avatar,src:I.L,alt:n})}),Object(b.jsx)(o.bb,{className:Lt.a.title,onClick:function(){return c.push({pathname:"/p/".concat(t),state:{profile:{username:n,id:t},prev:"/u/".concat(t)}})},children:Object(b.jsx)(Ct,{nickname:n,id:t})})]}),Object(b.jsx)(o.f,{slot:"end",children:Object(b.jsx)(o.e,{onClick:function(e){return p({event:e.nativeEvent})},children:Object(b.jsx)(o.q,{icon:I.y})})})]})})},Ft=function(){var e=Object(N.h)().id,t=Object(a.useState)(""),n=Object(i.a)(t,2),r=n[0],c=n[1],s=Object(a.useState)([]),p=Object(i.a)(s,2),d=p[0],j=p[1],m=Object(a.useState)(""),h=Object(i.a)(m,2),g=h[0],y=h[1],v=Object(a.useState)([]),x=Object(i.a)(v,2),_=x[0],E=x[1],T=Object(a.useState)(!1),I=Object(i.a)(T,2),k=I[0],M=I[1],w=Object(u.c)((function(e){return e.p2pmessages})),R=w.conversations,P=w.messages,G=w.receipts,C=w.errMsgs,A=w.files,L=w.pinned,D=Object(u.c)((function(t){var n=t.p2pmessages.typing;return Object.values(n).filter((function(t){return t.id===e}))})),H=Object(u.c)((function(t){var n=t.contacts.contacts;return Object.values(n).filter((function(t){return t.id===e}))[0]})),F=Object(u.c)((function(e){return e.preference})),U=(F.readReceipt,F.typingIndicator),B=Object(S.k)(),z=Object(N.g)(),q=z.pathname,Y=z.state,V=Object(u.c)((function(t){var n,a,r,c;return(null===Y||void 0===Y?void 0:Y.username)?null===Y||void 0===Y?void 0:Y.username:(null===(n=t.contacts)||void 0===n||null===(a=n.contacts[e])||void 0===a?void 0:a.username)?null===(r=t.contacts)||void 0===r||null===(c=r.contacts[e])||void 0===c?void 0:c.username:(_t(),"")})),Z=Object(a.useRef)(null),X=Object(a.useRef)(!1),J=Object(a.useRef)(),K=Object(a.useRef)(null);Object(a.useEffect)((function(){Z.current.scrollToBottom()}),[]),Object(a.useEffect)((function(){Z.current.scrollToBottom()}),[H]),Object(a.useEffect)((function(){void 0!==H&&B(function(e){return function(){var t=Object(O.a)(f.a.mark((function t(n,a){var r,c,s,o;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Object(l.a)({},a().p2pmessages),c=r.conversations[e.id],s=r.errMsgs[e.id]?r.errMsgs[e.id]:[],o=c?c.messages.map((function(e){var t=r.messages[e],n=t.receipts.map((function(e){return r.receipts[e]}));return n.sort((function(e,t){var n=e.timestamp.getTime(),a=t.timestamp.getTime();return n>a?-1:n<a?1:0})),{message:t,receipt:n[0]}})):[],s.forEach((function(e){var t={message:e};o.push(t)})),o.sort((function(e,t){return e.message.timestamp.getTime()-t.message.timestamp.getTime()})),t.abrupt("return",o);case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}(H)).then((function(e){return E(e)}))}),[R,P,G,H,C]),Object(a.useEffect)((function(){B(Object(Nt.a)(e))}),[]);var Q=function(e){void 0!==A[e.fileHash]?$(A[e.fileHash],e.fileName):B(xe([e.fileHash])).then((function(t){t&&Object.keys(t).length>0&&$(t[e.fileHash],e.fileName)}))},$=function(e,t){var n=new Blob([e]),a=document.createElement("a");a.href=window.URL.createObjectURL(n),a.download=t,a.click()},ee=function(e){var t=e.message.p2pMessageEntryHash,n=e.message.author,a=e.message.payload,r=e.message.replyTo?{payload:e.message.replyTo.payload,author:e.message.replyTo.author,id:e.message.replyTo.p2pMessageEntryHash}:null,c=e.message.err?e.message.timestamp:e.receipt.timestamp,s=e.message.err?void 0:"read"===e.receipt.status?{key:c}:void 0;return"FILE"!==a.type||"VIDEO"!==a.fileType||void 0!==A[a.fileHash]||e.message.err||B(xe([a.fileHash])),H.id!==n.id?Object(b.jsx)(et,{id:e.message.p2pMessageEntryHash,type:"p2p",author:n.username,timestamp:c,onRetry:function(t){return function(e,t){if(e(!0),"TEXT"===t.payload.type)B(Object(wt.a)(H.id,t.payload.payload.payload,"TEXT",t.replyToId)).then((function(n){if(e(!1),!n)return null;B(Mt(t))}));else{var n={metadata:{fileName:t.payload.fileName,fileType:t.payload.fileType,fileSize:t.payload.fileSize},fileType:{type:t.payload.fileType,payload:"OTHER"===t.payload.fileType?void 0:{thumbnail:t.payload.thumbnail}},fileBytes:t.payload.fileBytes};B(Object(wt.a)(H.id,"","FILE",""!==g?g:void 0,n)).then((function(n){if(e(!1),!n)return null;B(Mt(t))}))}}(t,e.message)},onDelete:function(){return B(Mt(e.message))},payload:a,readList:s||{},showProfilePicture:!0,showName:!0,onDownload:function(e){return Q(e)},replyTo:r||void 0,onReply:function(e){var t;K.current&&(null===K||void 0===K||null===(t=K.current)||void 0===t||t.reply(e)),y(e.id)},onPinMessage:function(){B(Object(kt.a)([e.message]))},isPinned:!!L[e.message.p2pMessageEntryHash],err:e.message.err},t):Object(b.jsx)(nt,{id:e.message.p2pMessageEntryHash,type:"p2p",author:n.username,timestamp:c,payload:a,readList:s||{},showProfilePicture:!0,onPinMessage:function(){return B(Object(kt.a)([e.message]))},showName:!0,onSeen:function(e){},onDownload:function(e){return Q(e)},replyTo:r||void 0,onReply:function(e){var t;K.current&&(null===K||void 0===K||null===(t=K.current)||void 0===t||t.reply(e)),y(e.id)},isPinned:!!L[e.message.p2pMessageEntryHash]},t)};return Object(b.jsxs)(o.G,{children:[Object(b.jsx)(Ht,{id:e,pathname:q,conversant:H,username:V}),Object(b.jsx)(o.j,{children:Object(b.jsx)(W,{type:"p2p",onScrollTop:function(e){return function(e){if(!1===k){var t=_[0].message;t.err||B(Object(St.a)(H.id,5,"All",t.timestamp,t.p2pMessageEntryHash)).then((function(t){return Object.values(t)[0][H.id].length<=0&&M(!0),e()}))}return e()}(e)},ref:Z,disabled:k,children:_.map((function(e){return ee(e)}))})}),Object(b.jsx)(ot,{profiles:Object.values(D)}),Object(b.jsx)(yt,{ref:K,onSend:function(e){var t=Object(l.a)({},e).setIsLoading;t(!0),""!==r&&B(Object(wt.a)(H.id,r,"TEXT",""!==g?g:void 0)).then((function(e){return e||B(Rt(H.id,r,"TEXT",""!==g?g:void 0)),d.length?d.forEach((function(e){return B(Object(wt.a)(H.id,r,"FILE",""!==g?g:void 0,e)).then((function(n){n||B(Rt(H.id,r,"FILE",""!==g?g:void 0,e)),t(!1)}))})):t(!1)})),""===r&&d.length&&d.forEach((function(e){return B(Object(wt.a)(H.id,r,"FILE",""!==g?g:void 0,e)).then((function(n){n||B(Rt(H.id,r,"FILE",""!==g?g:void 0,e)),t(!1)}))})),Z.current.scrollToBottom(),y("")},onChange:function(e){return function(e,t){!0===X.current?(U&&(B(Object(It.a)(t.id,0!==e.length)),J.current&&clearTimeout(J.current),J.current=setTimeout((function(){return B(Object(It.a)(t.id,!1))}),500)),c(e)):X.current=!0}(e,H)},onFileSelect:function(e){return j(e)}})]})},Ut=n(120),Bt=n.n(Ut),zt=function(e){var t=e.profile,n=Object(N.f)();return Object(b.jsxs)("div",{children:[Object(b.jsx)(o.eb,{className:Bt.a.controls,children:Object(b.jsx)("span",{children:Object(b.jsx)(o.f,{slot:"start",children:Object(b.jsx)(o.e,{onClick:function(){return n.push({pathname:"/u/".concat(t.id)})},className:"ion-no-padding",children:Object(b.jsx)(o.q,{slot:"icon-only",icon:I.e})})})})}),Object(b.jsx)("div",{className:Bt.a.titlebar,children:Object(b.jsx)("p",{className:Bt.a.title,children:Object(b.jsx)(Ct,{displayId:!1,nickname:t.username,id:t.id})})})]})},qt=function(e){var t=e.onSegmentChange,n=e.value,a=Object(k.a)();return Object(b.jsx)(o.eb,{children:Object(b.jsxs)(o.N,{value:n,onIonChange:function(e){return t(e.detail.value)},children:[Object(b.jsx)(o.O,{value:"Info",children:Object(b.jsx)(o.y,{children:a.formatMessage({id:"app.chat.chat-details.info"})})}),Object(b.jsx)(o.O,{value:"Media",children:Object(b.jsx)(o.y,{children:a.formatMessage({id:"app.chat.chat-details.media"})})}),Object(b.jsx)(o.O,{value:"Files",children:Object(b.jsx)(o.y,{children:a.formatMessage({id:"app.chat.chat-details.files"})})})]})})},Yt=n(49),Vt=n.n(Yt),Zt=function(e){var t=e.orderedMediaMessages,n=e.onDownload,c=e.onScrollBottom,s=Object(S.k)(),i=Object(u.c)((function(e){return Object.assign({},e.groups.groupFiles,e.p2pmessages.files)})),l=Object(k.a)(),p=Object(a.useRef)(null),d=function(){var e;return null===(e=p.current)||void 0===e?void 0:e.complete()},j=new TextDecoder,m=-1,f=function(e){return e!==m?(m=e,Object(b.jsx)(o.i,{size:"12",children:Object(b.jsx)("h2",{className:Vt.a.month,children:Object(S.g)(e,l)})})):null},O=function(e){return"VIDEO"===e.payload.fileType?Object(b.jsx)("div",{className:Vt.a.mediadiv,children:Object(b.jsx)(Ue,{download:function(){return n(e.payload)},src:URL.createObjectURL(new Blob([i[e.payload.fileHash]],{type:"video/mp4"})),className:Vt.a.video,thumbnail:URL.createObjectURL(new Blob([e.payload.thumbnail],{type:"image/jpeg"})),onPlayPauseErrorHandler:function(t){Object(F.c)(e)?s(xe([e.payload.fileHash])).then((function(e){e&&t(!1)})):s(he([e.payload.fileHash])).then((function(e){e&&t(!1)}))}})}):Object(b.jsx)("div",{className:Vt.a.mediadiv,children:Object(b.jsx)(we,{file:e.payload,src:j.decode(e.payload.thumbnail),onDownload:n})})};return Object(b.jsx)(o.R,{children:Object(b.jsxs)(o.o,{children:[Object(b.jsx)(o.L,{className:Vt.a.mediarow,children:t.map((function(e,t){var n=e.timestamp.getMonth();return Object(b.jsxs)(r.a.Fragment,{children:[f(n),Object(b.jsx)(o.i,{size:"3",children:Object(b.jsx)(o.g,{className:Vt.a.mediacard,children:O(e)})})]},t)}))}),Object(b.jsx)(o.L,{children:Object(b.jsx)(o.s,{ref:p,position:"bottom",onIonInfinite:function(e){return c(d,t[t.length-1])},children:Object(b.jsx)(o.t,{})})})]})})},Xt=function(e){var t=e.orderedFileMessages,n=e.onDownload,c=e.onScrollBottom,s=Object(k.a)(),i=Object(a.useRef)(null),u=function(){var e;return null===(e=i.current)||void 0===e?void 0:e.complete()},l=-1,p=function(e){return e!==l?(l=e,Object(b.jsx)(o.i,{size:"12",children:Object(b.jsx)("h2",{className:Vt.a.month,children:Object(S.g)(e,s)})})):null};return Object(b.jsx)(o.R,{children:Object(b.jsxs)(o.o,{children:[Object(b.jsx)(o.L,{className:Vt.a.mediarow,children:t.map((function(e){var t=e.timestamp.getMonth();return Object(b.jsxs)(r.a.Fragment,{children:[p(t),Object(b.jsx)(o.i,{size:"12",children:Object(b.jsx)(o.g,{className:Vt.a.mediacard,children:Object(b.jsx)(Te,{file:e.payload,onDownload:n,darken:!0})})})]})}))}),Object(b.jsx)(o.L,{children:Object(b.jsx)(o.s,{ref:i,position:"bottom",onIonInfinite:function(e){return c(u,t[t.length-1])},children:Object(b.jsx)(o.t,{})})})]})})},Jt=n(140),Kt=n.n(Jt),Qt=function(e){var t=e.nickname,n=e.id,a=Object(k.a)(),r=n.slice(5);return Object(b.jsx)(b.Fragment,{children:Object(b.jsxs)(o.x,{className:Kt.a.container,children:[Object(b.jsx)(o.v,{lines:"none",children:Object(b.jsx)("h3",{children:a.formatMessage({id:"components.profile-info.nickname"})})}),Object(b.jsx)(o.v,{lines:"none",children:Object(b.jsx)("p",{children:t})}),Object(b.jsx)(o.v,{lines:"none",children:Object(b.jsx)("h3",{children:a.formatMessage({id:"components.profile-info.id"})})}),Object(b.jsx)(o.v,{lines:"none",children:Object(b.jsx)(o.Y,{children:r})}),Object(b.jsx)(o.v,{lines:"none",children:Object(b.jsx)("h3",{children:a.formatMessage({id:"components.profile-info.identicon"})})}),Object(b.jsx)(o.v,{className:Kt.a.avatar,children:Object(b.jsx)(G,{hash:n,size:40})})]})})},Wt=function(e){var t=e.location,n=Object(l.a)({},t).state,r=Object(u.c)((function(e){return e.p2pmessages})),c=r.conversations,s=r.messages,p=Object(u.c)((function(e){return e.p2pmessages.files})),d=Object(a.useState)(!1),j=Object(i.a)(d,2),m=j[0],f=j[1],O=Object(a.useState)([]),h=Object(i.a)(O,1)[0],g=Object(a.useState)([]),y=Object(i.a)(g,1)[0],v=Object(a.useState)({}),x=Object(i.a)(v,1)[0],_=Object(a.useState)("Info"),E=Object(i.a)(_,2),T=E[0],N=E[1],I=Object(S.k)(),k=Object(a.useRef)(null);Object(a.useEffect)((function(){I(Object(St.a)(n.conversant.id,40,"Other",void 0,void 0)),I(Object(St.a)(n.conversant.id,40,"Media",void 0,void 0))}),[]),Object(a.useEffect)((function(){void 0!==n.conversant&&void 0!==c[n.conversant.id]&&c[n.conversant.id].messages.forEach((function(e){var t=s[e];if("FILE"===t.payload.type){var n=t.payload.fileType;if(!x[e])switch(n){case"IMAGE":case"VIDEO":h.push(t),x[e]=!0;break;case"OTHER":y.push(t),x[e]=!0}}}))}),[c,s]);var M=function(e){void 0!==p[e.fileHash]?w(p[e.fileHash],e.fileName):I(xe([e.fileHash])).then((function(t){t&&Object.keys(t).length>0&&w(t[e.fileHash],e.fileName)}))},w=function(e,t){var n=new Blob([e]),a=document.createElement("a");a.href=window.URL.createObjectURL(n),a.download=t,a.click()},R=function(e,t){if(!m){var a=t;void 0!==a&&I(Object(St.a)(n.conversant.id,10,"IMAGE"===a.payload.fileType||"VIDEO"===a.payload.fileType?"Media":"Other",void 0!==a?a.timestamp:void 0,void 0!==a?a.p2pMessageEntryHash:void 0)).then((function(t){Object.values(t)[0][n.conversant.id].length<=0&&f(!0),e()}))}e()};return Object(b.jsxs)(o.G,{children:[Object(b.jsxs)(o.p,{children:[Object(b.jsx)(zt,{profile:n.conversant}),Object(b.jsx)(qt,{value:T,onSegmentChange:function(e){var t;null===(t=k.current)||void 0===t||t.slideTo(["Info","Media","Files"].indexOf(e))}})]}),Object(b.jsx)(o.j,{children:Object(b.jsxs)(o.S,{ref:k,className:"slides",pager:!1,options:{initialSlide:0,speed:400},onIonSlideDidChange:function(){var e,t=["Info","Media","Files"];null===(e=k.current)||void 0===e||e.getActiveIndex().then((function(e){return N(t[e])}))},children:[Object(b.jsx)(o.R,{children:Object(b.jsx)(Qt,{nickname:n.conversant.username,id:n.conversant.id})}),Object(b.jsx)(Zt,{orderedMediaMessages:h,onDownload:function(e){return M(e)},onScrollBottom:function(e,t){return R(e,t)}}),Object(b.jsx)(Xt,{orderedFileMessages:y,onDownload:function(e){return M(e)},onScrollBottom:function(e,t){return R(e,t)}})]})})]})},$t=function(e,t){var n=e.isVisible,r=void 0===n||n,c=e.onChange,s=Object(a.useState)(new Date((new Date).setDate((new Date).getDate()+1))),u=Object(i.a)(s,2),l=u[0],p=u[1],d=Object(a.useRef)(null);return Object(a.useImperativeHandle)(t,(function(){return{open:function(){var e;null===d||void 0===d||null===(e=d.current)||void 0===e||e.open()}}})),Object(b.jsx)(o.k,{ref:d,value:Object(S.b)(l),style:{display:r?"block":"none"},max:Object(S.b)(new Date((new Date).setDate((new Date).getDate()))),onIonChange:function(e){if(e.detail.value){var t=Object(S.i)(e.detail.value);p(t),c&&c(t)}}})},en=Object(a.forwardRef)($t),tn=n(141),nn=n.n(tn),an=function(e){var t=e.type,n=e.prevHref,r=e.onDateSelect,c=e.messages,s=Object(a.useRef)(null),l=Object(a.useState)(null),p=Object(i.a)(l,2),d=p[0],j=p[1],m=Object(N.f)();Object(a.useEffect)((function(){c&&j(c)}),[c]);var f=Object(u.c)((function(e){return e.profile})),O=function(){var e;null===(e=s.current)||void 0===e||e.open()},h=function(){};return Object(b.jsx)(o.G,{children:d?Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(o.p,{children:Object(b.jsx)(o.eb,{children:Object(b.jsx)(o.f,{children:Object(b.jsx)(o.e,{onClick:function(){return j(null)},children:Object(b.jsx)(o.q,{icon:I.d})})})})}),Object(b.jsx)(o.j,{children:d?Object(b.jsx)(W,{type:t,children:d.map((function(e,t){return e.author.id===f.id?Object(b.jsx)(et,{id:e.id,onDownload:h,author:e.author.username,timestamp:e.timestamp,payload:e.payload,readList:e.readList,replyTo:e.replyTo,type:"group",isPinned:!1,showName:!0,showProfilePicture:!0},t):Object(b.jsx)(nt,{id:e.id,onDownload:h,author:e.author.username,timestamp:e.timestamp,isPinned:!1,payload:e.payload,readList:e.readList,replyTo:e.replyTo,type:"group",showName:!0,showProfilePicture:!0},t)}))}):Object(b.jsxs)(o.z,{className:nn.a.search,children:[Object(b.jsxs)(o.v,{lines:"full",button:!0,onClick:O,children:[Object(b.jsx)(o.q,{slot:"start",icon:I.i}),Object(b.jsx)(o.y,{children:"Search by date"})]}),Object(b.jsx)(en,{ref:s,isVisible:!1,onChange:r})]})})]}):Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(o.p,{children:Object(b.jsx)(o.eb,{children:Object(b.jsx)(o.f,{children:Object(b.jsx)(o.e,{onClick:function(){return m.push({pathname:n})},className:"ion-no-padding",children:Object(b.jsx)(o.q,{slot:"icon-only",icon:I.e})})})})}),Object(b.jsx)(o.j,{children:Object(b.jsxs)(o.z,{className:nn.a.search,children:[Object(b.jsxs)(o.v,{lines:"full",button:!0,onClick:O,children:[Object(b.jsx)(o.q,{slot:"start",icon:I.i}),Object(b.jsx)(o.y,{children:"Search by date"})]}),Object(b.jsx)(en,{ref:s,isVisible:!1,onChange:function(e){r&&r(e)}})]})})]})})},rn=function(){var e=Object(a.useState)(),t=Object(i.a)(e,2),n=t[0],r=t[1],c=Object(N.h)().id,s=Object(S.k)();return Object(b.jsx)(an,{type:"p2p",messages:n,onDateSelect:function(e){s(function(e,t,n){return function(){var a=Object(O.a)(f.a.mark((function a(r,c,s){var o,i,u,p,d,b,j;return f.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return o=s.callZome,i={conversant:Object(h.a)(e),date:Object(S.c)(t),payload_type:n},a.prev=2,a.next=5,o({zomeName:g.c.P2PMESSAGE,fnName:g.a[g.c.P2PMESSAGE].GET_MESSAGES_BY_AGENT_BY_TIMESTAMP,payload:i});case 5:if("error"===(null===(u=a.sent)||void 0===u?void 0:u.type)){a.next=12;break}return p=Object(l.a)({},c().contacts.contacts),d=Object(l.a)({},c().profile),b=Object(l.a)(Object(l.a)({},p),{},Object(D.a)({},d.id,{id:d.id,username:d.username})),j=Object(V.a)(u,b),a.abrupt("return",j);case 12:a.next=17;break;case 14:a.prev=14,a.t0=a.catch(2),r(Object(y.a)("TOAST",{},{id:"redux.err.generic"}));case 17:case"end":return a.stop()}}),a,null,[[2,14]])})));return function(e,t,n){return a.apply(this,arguments)}}()}(c,e,"All")).then((function(e){var t=Object.values(e.messages).map((function(t){var n=t.receipts.map((function(t){return e.receipts[t]}));n.sort((function(e,t){var n=e.timestamp.getTime(),a=t.timestamp.getTime();return n>a?-1:n<a?1:0}));var a=n[0],r="read"===a.status?{key:a.timestamp}:{};return{id:t.p2pMessageEntryHash,author:t.author,payload:t.payload,timestamp:t.timestamp,readList:r}}));r(t.reverse())}))},prevHref:"/u/".concat(c)})},cn=n(51),sn=n.n(cn),on=function(e){var t=e.messages,n=e.onMessageClick,a=e.type,r=void 0===a?"group":a,c=new TextDecoder,s=Object(S.k)(),i=Object(u.c)((function(e){return Object.assign({},e.groups.groupFiles,e.p2pmessages.files)})),l=function(e){switch(e.fileType){case"OTHER":return Object(b.jsxs)("div",{className:"".concat(sn.a.other," ion-padding"),children:[Object(b.jsx)(o.q,{className:"ion-margin-end",icon:I.u}),Object(b.jsxs)("div",{className:sn.a["file-details"],children:[Object(b.jsx)(o.Y,{className:sn.a["file-name"],children:e.fileName}),Object(b.jsx)(o.Y,{className:sn.a["file-size"],children:Object(S.a)(e.fileSize)})]})]});case"IMAGE":return Object(b.jsx)(o.r,{className:"".concat(sn.a.thumbnail," ion-margin-end"),src:c.decode(null===e||void 0===e?void 0:e.thumbnail)});case"VIDEO":var t=i[e.fileHash];return Object(b.jsx)(Ue,{className:sn.a.video,thumbnail:URL.createObjectURL(new Blob([e.thumbnail],{type:"image/jpeg"})),onPlayPauseErrorHandler:function(t){"p2p"===r?s(xe([e.fileHash])).then((function(e){e&&t(!1)})):s(he([e.fileHash])).then((function(e){e&&t(!1)}))},src:URL.createObjectURL(new Blob([t],{type:"video/mp4"})),download:function(){if(t){var n=new Blob([t]),a=document.createElement("a");a.href=window.URL.createObjectURL(n),a.download=e.fileName,a.click()}}})}};return Object(b.jsx)(o.z,{children:t.sort((function(e,t){return e.date>t.date?-1:1})).map((function(e,t){var a=Object(S.f)(e.payload);return Object(b.jsx)(o.v,{button:!0,onClick:function(){n&&n(e)},children:Object(b.jsxs)("div",{className:sn.a["content-container"],children:[Object(b.jsxs)("div",{className:sn.a.header,children:[Object(b.jsx)(o.y,{className:sn.a.author,children:e.author}),Object(b.jsx)(o.F,{className:"".concat(sn.a.date," ion-padding-start"),children:e.date.toDateString()})]}),a?Object(b.jsx)(o.Y,{children:e.payload.payload.payload}):l(e.payload)]})},t)}))})},un=function(){var e=Object(N.h)().id,t=Object(k.a)(),n=Object(N.f)(),r=Object(S.k)();Object(a.useEffect)((function(){r(Object(Nt.a)(e))}),[]);var c=Object(u.c)((function(t){var n=t.p2pmessages.conversations[e];if(n){if(n.pinned&&!(n.pinned.filter((function(e){return!t.p2pmessages.pinned})).length>0))return n.pinned.map((function(e){var n=t.p2pmessages.pinned[e];return{id:n.p2pMessageEntryHash,payload:n.payload,author:n.author.username,date:n.timestamp}}));r(Object(Nt.a)(e))}return[]}));return Object(b.jsxs)(o.G,{children:[Object(b.jsx)(o.p,{children:Object(b.jsx)(o.eb,{children:Object(b.jsxs)(o.f,{children:[Object(b.jsx)(o.e,{onClick:function(){return n.push({pathname:"/u/".concat(e)})},className:"ion-no-padding",children:Object(b.jsx)(o.q,{slot:"icon-only",icon:I.e})}),Object(b.jsx)(o.bb,{children:t.formatMessage({id:"app.chat.pinned-message-title"})})]})})}),Object(b.jsx)(o.j,{children:Object(b.jsx)(on,{onMessageClick:function(e){},messages:Object.values(c)})})]})},ln=function(){return Object(b.jsxs)(N.d,{children:[Object(b.jsx)(N.b,{path:"/u/:id",exact:!0,children:Object(b.jsx)(Ft,{})}),Object(b.jsx)(N.b,{path:"/u/:id/details",exact:!0,component:Wt}),Object(b.jsx)(N.b,{path:"/u/:id/search",exact:!0,component:rn}),Object(b.jsx)(N.b,{path:"/u/:id/pinned",exact:!0,component:un})]})},pn=function(e,t){return function(){var n=Object(O.a)(f.a.mark((function n(a,r,c){var s,o,i,u,p,d;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=c.callZome,n.prev=1,n.next=4,s({zomeName:g.c.GROUP,fnName:g.a[g.c.GROUP].PIN_MESSAGE,payload:{groupHash:e,groupMessageHash:t}});case 4:o=Object(l.a)({},{pinnedMessages:r().groups.pinnedMessages,message:r().groups.messages[t],conversations:r().groups.conversations}),i=o.conversations,u=o.pinnedMessages,p=o.message,d=i[e],u[t]=p,d.pinnedMessages?d.pinnedMessages.push(t):d.pinnedMessages=[t],a({type:q.l,conversations:Object(l.a)(Object(l.a)({},i),{},Object(D.a)({},e,d)),pinnedMessages:Object(l.a)(Object(l.a)({},r().groups.pinnedMessages),u)}),n.next=14;break;case 11:return n.prev=11,n.t0=n.catch(1),n.abrupt("return",a(Object(y.a)("TOAST",{},{id:"redux.err.generic"})));case 14:case"end":return n.stop()}}),n,null,[[1,11]])})));return function(e,t,a){return n.apply(this,arguments)}}()},dn=function(e,t){return function(){var n=Object(O.a)(f.a.mark((function n(a,r,c){var s,o,i,u,p;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=c.callZome,n.prev=1,n.next=4,s({zomeName:g.c.GROUP,fnName:g.a[g.c.GROUP].UNPIN_MESSAGE,payload:{groupHash:e,groupMessageHash:t}});case 4:o=Object(l.a)({},{conversations:r().groups.conversations,pinnedMessages:r().groups.pinnedMessages}),i=o.conversations,u=o.pinnedMessages,p=i[e],delete u[t],p.pinnedMessages=p.pinnedMessages?p.pinnedMessages.filter((function(e){return e!==t})):[],a({type:q.l,conversations:Object(l.a)(Object(l.a)({},i),{},Object(D.a)({},e,p)),pinnedMessages:u}),n.next=14;break;case 11:return n.prev=11,n.t0=n.catch(1),n.abrupt("return",a(Object(y.a)("TOAST",{},{id:"redux.err.generic"})));case 14:case"end":return n.stop()}}),n,null,[[1,11]])})));return function(e,t,a){return n.apply(this,arguments)}}()},bn=function(e){var t=e.messageIds,n=e.members,r=e.onReply,c=e.chatList,s=e.groupId,o=e.readReceipt,l=Object(S.k)(),p=Object(u.c)((function(e){return e.groups.groupFiles})),d=Object(u.c)((function(e){return e.groups})),j=d.messages,m=d.errMsgs,f=d.pinnedMessages,O=Object(u.c)((function(e){return e.groups.members})),h=Object(a.useState)([]),g=Object(i.a)(h,2),y=g[0],v=g[1],x=Object(a.useState)(!1),_=Object(i.a)(x,2),E=_[0],T=_[1],N=Object(u.c)((function(e){return e.profile})),I=function(e){var t=p[e.fileHash];if(t){var n=new Blob([t]),a=document.createElement("a");a.href=window.URL.createObjectURL(n),a.download=e.fileName,a.click()}else l(he([e.fileHash])).then((function(t){if(t&&Object.keys(t).length>0){var n=t[e.fileHash],a=new Blob([n]),r=document.createElement("a");r.href=window.URL.createObjectURL(a),r.download=e.fileName,r.click()}}))};return Object(a.useEffect)((function(){var e=l(ue(t,s));e.sort((function(e,t){return e.timestamp.getTime()-t.timestamp.getTime()})),v(e)}),[t,j,m]),Object(b.jsx)(b.Fragment,{children:Object(b.jsx)(rt.ChatList,{disabled:E,onScrollTop:function(e){return function(e){var t=y[0];return E||t.err||l(oe({groupId:s,lastFetched:t.groupMessageId,lastMessageTimestamp:t.timestamp,batchSize:10,payloadType:{type:"ALL",payload:null}})).then((function(t){return t&&Object.keys(t.groupMessagesContents).length<=0&&T(!0),e()})),e()}(e)},ref:c,type:"group",children:y.map((function(e,t){return e.author.id===N.id?Object(b.jsx)(rt.Me,{id:e.groupMessageId,onDownload:I,onDelete:function(){return l(Oe(e))},onRetry:function(t){return function(e,t){var n={groupId:t.groupId,payloadInput:Object(F.d)(t.payload)?{type:"TEXT",payload:{payload:t.payload.payload.payload}}:{type:"FILE",payload:{metadata:{fileName:t.payload.fileName,fileSize:t.payload.fileSize,fileType:t.payload.fileType},fileType:"IMAGE"===t.payload.fileType?{type:"IMAGE",payload:{thumbnail:t.payload.thumbnail}}:"VIDEO"===t.payload.fileType?{type:"VIDEO",payload:{thumbnail:t.payload.thumbnail}}:{type:"OTHER"},fileBytes:t.payload.fileBytes}},sender:t.author.id,replyTo:t.replyToId};e(!0),l(je(n)).then((function(n){if(e(!1),!n)return null;l(Oe(t))}))}(t,e)},author:e.author.username,isPinned:!!f[e.groupMessageId],timestamp:e.timestamp,payload:e.payload,readList:e.readList,onPinMessage:function(){f[e.groupMessageId]?l(dn(s,e.groupMessageId)):l(pn(s,e.groupMessageId))},replyTo:e.replyTo?{payload:e.replyTo.payload,author:{id:O[e.replyTo.author].id,username:O[e.replyTo.author].username},id:"".concat(t)}:void 0,type:"group",showName:!0,showProfilePicture:!0,onReply:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return r(e)})),err:e.err},t):Object(b.jsx)(rt.Others,{id:e.groupMessageId,onDownload:I,isPinned:!!f[e.groupMessageId],onPinMessage:function(){f[e.groupMessageId]?l(dn(s,e.groupMessageId)):l(pn(s,e.groupMessageId))},author:e.author.username,timestamp:e.timestamp,payload:e.payload,readList:e.readList,type:"group",replyTo:e.replyTo?{payload:e.replyTo.payload,author:{id:O[e.replyTo.author].id,username:O[e.replyTo.author].username},id:"".concat(t)}:void 0,showName:!0,onSeen:function(t){return function(e,t){if(o&&!Object.keys(t.readList).includes(N.id)){var a={groupId:s,messageIds:[t.groupMessageId],reader:N.id,timestamp:t.timestamp,members:n};l(pe(a)).then((function(t){e()}))}}(t,e)},onReply:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return r(e)})),showProfilePicture:!0},t)}))})})},jn=n(121),mn=n.n(jn),fn=function(e){var t=e.groupData,n=e.history,a=e.onHide,r=e.intl;return Object(b.jsxs)(o.z,{children:[Object(b.jsxs)(o.v,{button:!0,onClick:function(){a(),n.push("/g/".concat(t.originalGroupId,"/details"))},children:[Object(b.jsx)(o.q,{slot:"start",icon:I.B}),Object(b.jsx)(o.y,{children:r.formatMessage({id:"app.group-chat.header-details"})})]}),Object(b.jsxs)(o.v,{onClick:function(){n.push({pathname:"/g/".concat(t.originalGroupId,"/search")}),a()},button:!0,children:[Object(b.jsx)(o.q,{slot:"start",icon:I.U}),Object(b.jsx)(o.y,{children:r.formatMessage({id:"app.group-chat.header-search"})})]}),Object(b.jsxs)(o.v,{onClick:function(){n.push({pathname:"/g/".concat(t.originalGroupId,"/pinned")}),a()},button:!0,children:[Object(b.jsx)(o.q,{slot:"start",icon:I.O}),Object(b.jsx)(o.y,{children:r.formatMessage({id:"app.group-chat.header-pinned-message"})})]})]})},On=function(e){var t=e.groupData,n=Object(N.f)(),a=Object(k.a)(),r=Object(o.ob)(fn,{onHide:function(){return u()},groupData:t,history:n,intl:a}),c=Object(i.a)(r,2),s=c[0],u=c[1];return Object(b.jsx)(o.p,{children:Object(b.jsxs)(o.eb,{children:[Object(b.jsx)(o.f,{slot:"start",children:Object(b.jsx)(o.e,{onClick:function(){return n.push({pathname:"/home"})},className:"ion-no-padding",children:Object(b.jsx)(o.q,{slot:"icon-only",icon:I.e})})}),Object(b.jsxs)("div",{className:mn.a["title-container"],children:[Object(b.jsx)(o.b,{className:"ion-padding",children:Object(b.jsx)("img",{className:mn.a.avatar,src:I.H,alt:t.name})}),Object(b.jsx)(o.bb,{className:mn.a.title,children:t.name})]}),Object(b.jsx)(o.f,{slot:"end",children:Object(b.jsx)(o.e,{onClick:function(e){return s({event:e.nativeEvent})},children:Object(b.jsx)(o.q,{icon:I.y})})})]})})},hn=function(e){return function(){var t=Object(O.a)(f.a.mark((function t(n,a,r){var c,s,o,i,u,p,d,b;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.callZome,s=r.getAgentId,t.prev=1,t.next=4,c({zomeName:g.c.GROUP,fnName:g.a[g.c.GROUP].FETCH_PINNED_MESSAGES,payload:e});case 4:if(o=t.sent,i=a().groups.conversations[e]){t.next=10;break}n(se(e)),t.next=19;break;case 10:return u=Object.values(o),p={},t.next=14,s();case 14:return d=t.sent,b=u.map(function(){var t=Object(O.a)(f.a.mark((function t(n){var r,s,o,i,u,l;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=n.entry,o=Object(h.b)(s.messageId),t.t0=Object,t.next=5,z(a(),[Object(h.b)(s.sender)],c,Object(h.b)(d));case 5:return t.t1=t.sent,i=t.t0.values.call(t.t0,t.t1)[0].username,u="TEXT"===s.payload.type?s.payload:{type:"FILE",fileType:s.payload.payload.fileType.type,fileHash:Object(h.b)(s.payload.payload.metadata.fileHash),fileName:s.payload.payload.metadata.fileName,fileSize:s.payload.payload.metadata.fileSize,thumbnail:null===(r=s.payload.payload.fileType.payload)||void 0===r?void 0:r.thumbnail},l={groupId:e,groupMessageId:o,author:i,payload:u,timestamp:Object(S.j)(s.created),readList:{}},p[o]=l,t.abrupt("return",o);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.next=18,Promise.all(b).then((function(e){return i.pinnedMessages=e}));case 18:n({type:q.l,pinnedMessages:Object(l.a)(Object(l.a)({},a().groups.pinnedMessages),p),conversations:Object(l.a)(Object(l.a)({},a().groups.conversations),{},Object(D.a)({},e,i))});case 19:t.next=24;break;case 21:return t.prev=21,t.t0=t.catch(1),t.abrupt("return",n(Object(y.a)("TOAST",{},{id:"redux.err.generic"})));case 24:case"end":return t.stop()}}),t,null,[[1,21]])})));return function(e,n,a){return t.apply(this,arguments)}}()},gn=function(){var e=Object(S.k)(),t=Object(N.h)().group,n=Object(a.useState)([]),r=Object(i.a)(n,2),c=r[0],s=r[1],p=Object(a.useState)(""),d=Object(i.a)(p,2),j=d[0],m=d[1],f=Object(a.useRef)(null),O=Object(a.useRef)(),h=Object(a.useRef)(null),g=Object(u.c)((function(e){return e.groups.conversations[t]})),y=Object(u.c)((function(e){return e.profile})),v=Object(u.c)((function(e){return e.groups.typing})),x=Object(u.c)((function(e){return e.preference})),_=x.readReceipt,E=x.typingIndicator;Object(a.useEffect)((function(){g&&e(hn(null===g||void 0===g?void 0:g.originalGroupId))}),[g,e]);return g?Object(b.jsxs)(o.G,{children:[Object(b.jsx)(On,{groupData:g}),Object(b.jsx)(o.j,{children:Object(b.jsx)(bn,{onReply:function(e){var t;h.current&&(null===h||void 0===h||null===(t=h.current)||void 0===t||t.reply(e))},groupId:g.originalGroupId,members:[].concat(Object(ae.a)(g.members),[g.creator]),messageIds:g.messages,chatList:f,readReceipt:_})}),Object(b.jsx)(ot,{profiles:v[g.originalGroupId]?v[g.originalGroupId]:[]}),Object(b.jsx)(yt,{ref:h,onSend:function(t){var n=Object(l.a)({},t),a=n.reply,r=n.setIsLoading,s=null,o=null;if(r(!0),j.length&&(s={groupId:g.originalGroupId,payloadInput:{type:"TEXT",payload:{payload:j}},sender:y.id,replyTo:a}),c.length){var i=c[0],u={type:"FILE",payload:{metadata:{fileName:i.metadata.fileName,fileSize:i.metadata.fileSize,fileType:i.metadata.fileType},fileType:i.fileType,fileBytes:i.fileBytes}};o={groupId:g.originalGroupId,payloadInput:u,sender:y.id,replyTo:a}}s?e(je(s)).then((function(t){t||e(me(s)),o&&e(je(o)).then((function(t){t||e(me(o)),r(!1),f.current.scrollToBottom()})),r(!1),f.current.scrollToBottom()})):o&&e(je(o)).then((function(t){t||e(me(o)),r(!1),f.current.scrollToBottom()}))},onChange:function(t){return function(t,n){if(E){var a=[].concat(Object(ae.a)(n.members),[n.creator]).filter((function(e){return e!==y.id}));e(le({groupId:n.originalGroupId,indicatedBy:y.id,members:a,isTyping:0!==t.length})),O.current&&clearTimeout(O.current),O.current=setTimeout((function(){return e(le({groupId:n.originalGroupId,indicatedBy:y.id,members:a,isTyping:!1}))}),500)}return m(t)}(t,g)},onFileSelect:function(e){return s(e)}})]}):Object(b.jsx)(o.B,{isOpen:!0})},yn=function(e){var t=e.onClickEdit,n=(e.onClickNotif,e.disabled);return Object(b.jsx)(o.f,{slot:"end",children:Object(b.jsx)(b.Fragment,{children:Object(b.jsx)(o.e,{onClick:t,disabled:!!n,children:Object(b.jsx)(o.q,{color:"medium",icon:I.G})})})})},vn=function(e){var t=e.onSegmentChange,n=e.value,a=Object(k.a)();return Object(b.jsx)(o.eb,{children:Object(b.jsxs)(o.N,{value:n,onIonChange:function(e){return t(e.detail.value)},children:[Object(b.jsx)(o.O,{value:"Info",children:Object(b.jsx)(o.y,{children:a.formatMessage({id:"app.group-chat.label-info"})})}),Object(b.jsx)(o.O,{value:"Media",children:Object(b.jsx)(o.y,{children:a.formatMessage({id:"app.group-chat.label-media"})})}),Object(b.jsx)(o.O,{value:"Files",children:Object(b.jsx)(o.y,{children:a.formatMessage({id:"app.group-chat.label-files"})})})]})})},xn=n(76),_n=n.n(xn),En=n(122),Tn=n.n(En),Sn=function(e){var t=e.onChange,n=e.onCancel,a=Object(k.a)();return Object(b.jsxs)(o.p,{children:[Object(b.jsx)(o.eb,{children:Object(b.jsxs)(o.f,{children:[Object(b.jsx)(o.bb,{className:Tn.a.contacts,children:a.formatMessage({id:"app.group-chat.add-member-contacts"})}),Object(b.jsx)(o.e,{className:Tn.a["close-button"],onClick:n,slot:"end",children:Object(b.jsx)(o.y,{className:Tn.a["close-label"],children:a.formatMessage({id:"app.group-chat.add-member-close"})})})]})}),Object(b.jsx)(o.eb,{children:Object(b.jsx)(o.M,{onIonChange:t})})]})},Nn=function(e){var t=e.contact,n=e.selected,a=e.onSelected;return Object(b.jsx)(o.v,{button:!0,onClick:function(){return a(t)},lines:"none",color:n?"primary":"",children:Object(b.jsx)(o.y,{children:t.username})},JSON.stringify(t.id))},In=function(e){var t=e.index,n=e.contacts,a=e.onSelected,c=e.selected;return Object(b.jsxs)(r.a.Fragment,{children:[Object(b.jsx)(o.w,{children:Object(b.jsx)(o.y,{children:t})}),n.map((function(e){return Object(b.jsx)(Nn,{onSelected:a,selected:!!c.includes(e),contact:e},JSON.stringify(e.id))}))]},t)},kn=n(142),Mn=n.n(kn),wn=function(e){var t=e.isOpen,n=e.onCancel,r=e.contacts,c=e.groupId,s=e.groupRevisionId,u=e.setLoading,l=e.members,p=e.setMembers,d=Object(k.a)(),j=Object(S.k)(),m=Object(a.useState)(""),f=Object(i.a)(m,2),O=f[0],h=f[1],g=Object(a.useState)([]),y=Object(i.a)(g,2),v=y[0],x=y[1],_=Object(S.e)(function(e){return Object.keys(e).filter((function(e){return-1===l.map((function(e){return e.id})).indexOf(e)}))}(r).map((function(e){return r[e]})).filter((function(e){return e.username.toLowerCase().includes(O.toLowerCase())}))),E=function(e){return x([].concat(Object(ae.a)(v),[e]))};return Object(b.jsxs)(o.E,{isOpen:t,children:[Object(b.jsx)(Sn,{onChange:function(e){return h(e.detail.value)},onCancel:n}),Object(b.jsxs)(o.j,{children:[Object(b.jsx)(o.z,{className:Mn.a["contacts-list"],children:Object.keys(_).map((function(e){var t=_[e];return Object(b.jsx)(In,{onSelected:E,index:e,contacts:t,selected:v},e)}))}),Object(b.jsx)(o.eb,{children:Object(b.jsx)(o.f,{slot:"end",children:Object(b.jsx)(o.e,{disabled:0===v.length,onClick:function(){u(!0);var e={members:v.map((function(e){return e.id})),groupId:c,groupRevisionId:s};j(ne(e)).then((function(e){if(!1!==e){var t=l.concat(v);p(t),x([]),u(!1)}else x([]),u(!1)}))},children:Object(b.jsx)(o.y,{className:Mn.a["add-label"],children:d.formatMessage({id:"app.group-chat.add-member"})})})})})]}),")"]})},Rn=n(83),Pn=n.n(Rn),Gn=function(e){var t=e.groupId,n=e.groupRevisionId,r=Object(S.k)(),c=Object(k.a)(),s=ut().showErrorToast,l=Object(a.useState)(!1),p=Object(i.a)(l,2),d=p[0],j=p[1],m=Object(a.useState)(!0),f=Object(i.a)(m,2),O=f[0],h=f[1],g=Object(a.useState)([]),y=Object(i.a)(g,2),v=y[0],x=y[1],_=Object(u.c)((function(e){return e.contacts.contacts})),E=Object(u.c)((function(e){return e.profile})),T=Object(u.c)((function(e){return e.groups.members})),N=Object(u.c)((function(e){return e.groups.conversations[t]}));Object(a.useEffect)((function(){var e=[];[].concat(Object(ae.a)(N.members),[N.creator]).forEach((function(t){T[t]&&e.push(T[t])})),x(e),h(!1)}),[N,T]);var M=function(e){return E.id===N.creator&&e.id!==N.creator?Object(b.jsx)(o.v,{lines:"none",slot:"end",button:!0,onClick:function(){return function(e){if(h(!0),N.members.length<=2)return h(!1),s({message:c.formatMessage({id:"app.group-chat.minimum-member-required-reached"})}),null;var t={members:[e.id],groupId:N.originalGroupId,groupRevisionId:N.originalGroupRevisionId};r(de(t)).then((function(e){if(!1!==e){var t=v.filter((function(t){return!e.members.includes(t.id)}));x(t)}h(!1)}))}(e)},children:Object(b.jsx)(o.q,{color:"danger",icon:I.Q})}):null};return Object(b.jsxs)(b.Fragment,{children:[O?Object(b.jsx)(o.B,{isOpen:O}):Object(b.jsx)(b.Fragment,{children:Object(b.jsxs)(o.x,{className:Pn.a["member-page"],children:[Object(b.jsxs)(o.v,{lines:"none",children:[Object(b.jsx)(o.q,{className:Pn.a.icon,icon:I.I}),Object(b.jsx)(o.y,{children:c.formatMessage({id:"app.group-chat.members"},{length:v.length})})]}),function(e){return E.id===e.creator?Object(b.jsxs)(o.v,{lines:"none",button:!0,onClick:function(){return j(!0)},children:[Object(b.jsx)(o.q,{className:Pn.a.icon,icon:I.K}),Object(b.jsx)(o.y,{children:c.formatMessage({id:"app.group-chat.add-members"})})]}):null}(N),Object(b.jsx)(o.v,{lines:"none",className:Pn.a["member-title"],children:Object(b.jsx)("h3",{children:c.formatMessage({id:"app.group-chat.members-label"})})}),function(e){return e.map((function(e){var t=e.id===N.creator;return Object(b.jsxs)(o.v,{lines:"none",children:[Object(b.jsxs)(o.y,{className:Pn.a["member-name"],children:[e.username,Object(b.jsx)("br",{}),t?c.formatMessage({id:"app.group-chat.admin-role"}):c.formatMessage({id:"app.group-chat.member-role"})]}),M(e)]},e.id)}))}(v)]})}),Object(b.jsx)(wn,{contacts:_,members:v,setMembers:x,isOpen:d,onCancel:function(){return j(!1)},groupId:t,groupRevisionId:n,setLoading:h})]})},Cn=function(e){var t=e.onCancel,n=e.onSave,a=e.setName,r=e.name,c=Object(k.a)();return Object(b.jsxs)("div",{className:_n.a.modal,children:[Object(b.jsx)(o.eb,{children:Object(b.jsx)(o.bb,{children:c.formatMessage({id:"app.group-chat.update-group-name-title"})})}),Object(b.jsxs)(o.v,{className:"input",children:[Object(b.jsx)(o.y,{color:"medium",position:"floating",children:c.formatMessage({id:"app.group-chat.update-group-name-placeholder"})}),Object(b.jsx)(o.u,{clearInput:!0,className:_n.a["ion-input"],value:r,onIonChange:function(e){return a(e.detail.value)}})]}),Object(b.jsxs)(o.f,{slot:"end",className:"input",children:[Object(b.jsx)(o.e,{slot:"end",onClick:t,children:Object(b.jsx)(o.y,{children:c.formatMessage({id:"app.group-chat.update-group-name-cancel"})})}),Object(b.jsx)(o.e,{disabled:!r.length,slot:"end",onClick:function(){n(r)},children:Object(b.jsx)(o.y,{children:c.formatMessage({id:"app.group-chat.update-group-name-save"})})})]})]})},An=function(){var e=Object(N.f)(),t=Object(N.h)().group,n=Object(S.k)(),r=Object(u.c)((function(e){return e.groups.conversations[t]})),c=Object(u.c)((function(e){return e.profile})),s=Object(u.c)((function(e){return e.groups})),l=s.conversations,p=s.messages,d=Object(u.c)((function(e){return e.groups.groupFiles})),j=Object(a.useState)(!1),m=Object(i.a)(j,2),f=m[0],O=m[1],h=Object(a.useState)(!1),g=Object(i.a)(h,2),y=g[0],v=g[1],x=Object(a.useState)({}),_=Object(i.a)(x,1)[0],E=Object(a.useState)({}),T=Object(i.a)(E,1)[0],k=Object(a.useState)([]),M=Object(i.a)(k,1)[0],w=Object(a.useState)([]),R=Object(i.a)(w,1)[0],P=Object(a.useState)("Info"),G=Object(i.a)(P,2),C=G[0],A=G[1],L=Object(a.useState)(""),D=Object(i.a)(L,2),H=D[0],F=D[1],U=Object(a.useRef)(null),B=function(e){void 0!==d[e.fileHash]?z(d[e.fileHash],e.fileName):n(he([e.fileHash])).then((function(t){t&&Object.keys(t).length>0&&z(t[e.fileHash],e.fileName)}))},z=function(e,t){var n=new Blob([e]),a=document.createElement("a");a.href=window.URL.createObjectURL(n),a.download=t,a.click()},q=function(e,a,r){var c=a;void 0!==c&&n(oe({groupId:t,lastFetched:c.groupMessageId,lastMessageTimestamp:c.timestamp,batchSize:5,payloadType:r})).then((function(t){e()}))};return Object(a.useEffect)((function(){void 0!==l[t]&&l[t].messages.forEach((function(e){var t=p[e];if(t&&"FILE"===t.payload.type)switch(t.payload.fileType){case"IMAGE":case"VIDEO":_[t.groupMessageId]||(_[t.groupMessageId]=!0,M.push(t));break;case"OTHER":T[t.groupMessageId]||(T[t.groupMessageId]=!0,R.push(t))}}))}),[l,p]),Object(a.useEffect)((function(){n(oe({groupId:t,batchSize:40,payloadType:{type:"MEDIA",payload:null}}))}),[]),Object(a.useEffect)((function(){n(oe({groupId:t,batchSize:40,payloadType:{type:"FILE",payload:null}}))}),[]),Object(b.jsx)(b.Fragment,{children:r?Object(b.jsxs)(o.G,{children:[Object(b.jsxs)(o.p,{className:_n.a.header,children:[Object(b.jsxs)(o.eb,{children:[Object(b.jsx)(o.f,{children:Object(b.jsx)(o.e,{onClick:function(){e.goBack()},className:"ion-no-padding",children:Object(b.jsx)(o.q,{slot:"icon-only",icon:I.e})})}),Object(b.jsx)(yn,{onClickEdit:function(){return O(!f),void v(!y)},onClickNotif:function(){},disabled:r.creator!==c.id})]}),Object(b.jsx)(o.bb,{className:_n.a.groupname,children:r.name}),Object(b.jsx)(vn,{value:C,onSegmentChange:function(e){var t,n;switch(e){case"Info":n=0;break;case"Media":n=1;break;case"Files":n=2;break;default:n=0}null===(t=U.current)||void 0===t||t.slideTo(n)}})]}),Object(b.jsx)(o.j,{children:Object(b.jsxs)(o.S,{ref:U,className:"slides",pager:!1,options:{initialSlide:0,speed:400},onIonSlideDidChange:function(){var e,t=["Info","Media","Files"];null===(e=U.current)||void 0===e||e.getActiveIndex().then((function(e){return A(t[e])}))},children:[Object(b.jsx)(o.R,{children:Object(b.jsx)(Gn,{groupId:t,groupRevisionId:r.originalGroupRevisionId})}),Object(b.jsx)(o.R,{children:Object(b.jsx)(Zt,{orderedMediaMessages:M,onDownload:function(e){return B(e)},onScrollBottom:function(e,t){return q(e,t,{type:"MEDIA",payload:null})}})}),Object(b.jsx)(o.R,{children:Object(b.jsx)(Xt,{orderedFileMessages:R,onDownload:function(e){return B(e)},onScrollBottom:function(e,t){return q(e,t,{type:"FILE",payload:null})}})})]})}),Object(b.jsx)(o.E,{isOpen:y,cssClass:"my-custom-modal-css",children:Object(b.jsx)(Cn,{setName:F,name:H,onCancel:function(){return v(!1)},onSave:function(e){return function(e){n(ye({name:e,groupId:r.originalGroupId,groupRevisionId:r.originalGroupRevisionId})).then((function(e){e&&(F(""),v(!1))}))}(e)}})})]}):Object(b.jsx)(o.B,{isOpen:!0})})},Ln=function(){var e=Object(N.h)().group,t=Object(k.a)(),n=Object(N.f)(),r=Object(S.k)(),c=Object(a.useState)(null),s=Object(i.a)(c,2),l=s[0],p=s[1],d=Object(u.c)((function(t){var n;return{conversation:t.groups.conversations[e],pinnedMesssages:null===(n=t.groups.conversations[e])||void 0===n?void 0:n.pinnedMessages}})),j=d.conversation,m=d.pinnedMesssages;return Object(a.useEffect)((function(){var t;r((t=e,function(){var e=Object(O.a)(f.a.mark((function e(n,a,r){var c,s,o,i,u,l,p;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=r.callZome,s=r.getAgentId,!(o=a().groups.conversations[t])){e.next=19;break}if(!(i=o.pinnedMessages)||0!==i.filter((function(e){return void 0===a().groups.pinnedMessages[e]})).length){e.next=16;break}return u=i.map((function(e){return a().groups.messages[e].author})),e.next=8,s();case 8:if(!(l=e.sent)){e.next=14;break}return e.next=12,z(a(),u,c,Object(h.b)(l));case 12:return p=e.sent,e.abrupt("return",i.map((function(e){var t=a().groups.pinnedMessages[e],n=p[t.author];return{id:t.groupMessageId,payload:t.payload,author:n?n.username:t.author,date:t.timestamp}})));case 14:e.next=17;break;case 16:n(hn(t));case 17:e.next=20;break;case 19:n(se(t));case 20:return e.abrupt("return",null);case 21:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}())).then((function(e){return p(e)}))}),[j,m]),Object(b.jsxs)(o.G,{children:[Object(b.jsx)(o.p,{children:Object(b.jsx)(o.eb,{children:Object(b.jsxs)(o.f,{children:[Object(b.jsx)(o.e,{onClick:function(){return n.push({pathname:"/g/".concat(e)})},className:"ion-no-padding",children:Object(b.jsx)(o.q,{slot:"icon-only",icon:I.e})}),Object(b.jsx)(o.bb,{children:t.formatMessage({id:"app.group-chat.pinned-message-title"})})]})})}),Object(b.jsx)(o.j,{children:l?Object(b.jsx)(on,{type:"group",onMessageClick:function(e){},messages:l}):null})]})},Dn=function(e,t){return function(){var n=Object(O.a)(f.a.mark((function n(a,r,c){var s;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=c.callZome,n.next=3,z(r(),e,s,t);case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}),n)})));return function(e,t,a){return n.apply(this,arguments)}}()},Hn=function(){var e=Object(a.useState)(),t=Object(i.a)(e,2),n=t[0],r=t[1],c=Object(N.h)().group,s=Object(u.c)((function(e){return e.profile})).id,o=Object(S.k)();return Object(b.jsx)(an,{messages:n,onDateSelect:function(e){o(ie({groupId:c,date:e,payloadType:{type:"ALL",payload:null}})).then((function(e){var t=e.messagesByGroup[c].map((function(t){var n=e.groupMessagesContents[t];return{id:n.groupId,author:{id:n.author},timestamp:n.timestamp,payload:n.payload,readList:n.readList,replyTo:n.replyTo}}));o(Dn(t.map((function(e){return e.author.id})),s)).then((function(e){r(t.map((function(t){return Object(l.a)(Object(l.a)({},t),{},{author:Object(l.a)({},e[t.author.id])})})))}))}))},prevHref:"/g/".concat(c),type:"group"})},Fn=function(){return Object(b.jsxs)(N.d,{children:[Object(b.jsx)(N.b,{path:"/g/:group",exact:!0,children:Object(b.jsx)(gn,{})}),Object(b.jsx)(N.b,{path:"/g/:group/details",exact:!0,children:Object(b.jsx)(An,{})}),Object(b.jsx)(N.b,{path:"/g/:group/search",exact:!0,children:Object(b.jsx)(Hn,{})}),Object(b.jsx)(N.b,{path:"/g/:group/pinned",exact:!0,children:Object(b.jsx)(Ln,{})})]})},Un=n(291),Bn=function(e){var t=e.contact,n=Object(N.f)();return Object(b.jsx)(o.v,{onClick:function(){return n.push({pathname:"/p/".concat(t.id),state:{profile:t}})},lines:"none",children:Object(b.jsx)(Ct,{nickname:t.username,id:t.id})},JSON.stringify(t))},zn=function(e){var t=e.char,n=e.contacts;return Object(b.jsxs)(r.a.Fragment,{children:[Object(b.jsx)(o.w,{children:Object(b.jsx)(o.y,{children:t})}),n.map((function(e){return Object(b.jsx)(Bn,{contact:e},JSON.stringify(e))}))]},t)},qn=n(177),Yn=n.n(qn),Vn=function(e){var t=e.contacts;return Object(b.jsx)(o.z,{className:Yn.a["contacts-list"],children:Object.keys(t).map((function(e){var n=t[e];return Object(b.jsx)(zn,{char:e,contacts:n},e)}))})},Zn=function(e){var t=e.onChange,n=e.noSearch,r=Object(a.useState)(!1),c=Object(i.a)(r,2),s=c[0],u=c[1];return Object(b.jsx)(o.p,{children:Object(b.jsx)(o.eb,{children:s?Object(b.jsx)(o.M,{onIonChange:function(e){return t(e)},showCancelButton:"always",debounce:500,onIonCancel:function(){return u(!1)}}):Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(o.f,{slot:"start",children:Object(b.jsx)(o.D,{})}),n?null:Object(b.jsx)(o.f,{slot:"end",children:Object(b.jsx)(o.e,{onClick:function(){return u(!0)},children:Object(b.jsx)(o.q,{icon:I.U,slot:"icon-only"})})})]})})})},Xn=function(e){var t=e.onClick;return Object(b.jsx)(o.l,{vertical:"bottom",horizontal:"end",slot:"fixed",children:Object(b.jsx)(o.m,{onClick:t,children:Object(b.jsx)(o.q,{icon:I.a})})})},Jn=n(178),Kn=n.n(Jn),Qn=function(e){var t=e.onChange,n=e.onCancel,a=Object(k.a)();return Object(b.jsx)(o.p,{children:Object(b.jsx)(o.eb,{children:Object(b.jsx)(o.M,{placeholder:a.formatMessage({id:"app.contacts.search"}),showCancelButton:"always",onIonChange:t,onIonCancel:n,debounce:700})})})},Wn=function(e){var t=e.contact,n=e.onCompletion,r=Object(a.useState)(!1),c=Object(i.a)(r,2),s=c[0],u=c[1],l=Object(S.k)();return Object(b.jsxs)(o.v,{lines:"none",children:[Object(b.jsx)(Ct,{nickname:t.username,id:t.id}),Object(b.jsx)(o.f,{slot:"end",children:s?Object(b.jsx)(o.T,{}):Object(b.jsx)(o.e,{onClick:function(){u(!0),l(vt(t)).then((function(e){e?n(t):u(!1)}))},children:Object(b.jsx)(o.q,{icon:I.a})})})]})},$n=function(e){var t=e.index,n=e.contacts,a=e.onCompletion;return Object(b.jsxs)(r.a.Fragment,{children:[Object(b.jsx)(o.w,{children:Object(b.jsx)(o.y,{children:t})}),n.map((function(e){return Object(b.jsx)(Wn,{contact:e,onCompletion:a},JSON.stringify(e.id))}))]})},ea=function(e){var t=e.isOpen,n=e.onCancel,r=ut().showToast,c=Object(k.a)(),s=Object(u.c)((function(e){return e.contacts.contacts})),p=Object(a.useState)([]),d=Object(i.a)(p,2),j=d[0],m=d[1],f=Object(S.k)(),O=Object(S.e)(j),h=function(e){r({message:c.formatMessage({id:"app.contacts.add-message"},{name:e.username}),color:"light",duration:1e3}),f({type:H.b,contacts:Object(l.a)({},s)}),m((function(t){return t.filter((function(t){return t.id!==e.id}))}))};return Object(b.jsxs)(o.E,{isOpen:t,onDidDismiss:n,children:[Object(b.jsx)(Qn,{onChange:function(e){var t;(t=e.detail.value).length>=3?f(E(t)).then((function(e){if(e){var n=e.filter((function(e){return e.username.includes(t)}));m(n)}})):t.length>0&&t.length<3?setTimeout(r({color:"warning",message:c.formatMessage({id:"app.contacts.search-nickname-warning"})}),300):m([])},onCancel:n}),Object(b.jsx)(o.j,{children:Object(b.jsx)(o.z,{className:Kn.a["contacts-list"],children:Object.keys(O).map((function(e){var t=O[e];return Object(b.jsx)($n,{onCompletion:h,index:e,contacts:t},e)}))})})]})},ta=n(179),na=n.n(ta),aa=function(){var e=Object(k.a)();return Object(b.jsxs)("div",{className:na.a["empty-contacts"],children:[Object(b.jsx)(o.q,{icon:I.T}),Object(b.jsx)(o.Y,{className:"ion-padding ion-margin-bottom",children:e.formatMessage({id:"app.contacts.empty-contact-list"})})]})},ra=function(){var e=Object(a.useState)(!1),t=Object(i.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(""),s=Object(i.a)(c,2),l=s[0],p=s[1],d=Object(a.useState)(),m=Object(i.a)(d,2),f=m[0],O=m[1],h=Object(S.k)(),g=Object(u.c)((function(e){return e.contacts.contacts}));Object(a.useEffect)((function(){O(!0),h(_t()).then((function(e){O(!1)}))}),[h]);var y=Object(S.e)(Object.values(g).filter((function(e){return e.username.toLowerCase().includes(l.toLowerCase())})));return Object(b.jsxs)(o.G,{children:[Object(b.jsx)(Zn,{onChange:function(e){return p(e.detail.value)}}),Object(b.jsxs)(o.j,{children:[f?Object(b.jsx)(j,{name:"crescent"}):0!==Object.values(g).length?Object(b.jsx)(Vn,{contacts:y}):Object(b.jsx)(aa,{}),Object(b.jsx)(ea,{contacts:g,isOpen:n,onCancel:function(){return r(!1)}}),Object(b.jsx)(Xn,{onClick:function(){return r(!0)}})]})]})},ca=n(180),sa=n.n(ca),oa=function(e){var t,n=e.conversation,a=e.myAgentId,r=e.onClick,c=Object(k.a)();return Object(b.jsxs)(o.v,{onClick:r,children:[Object(b.jsx)(o.b,{slot:"start",children:Object(b.jsx)("img",{className:sa.a.avatar,src:"group"===n.type?I.H:I.L,alt:"".concat(n.conversationName,"'s chat")})}),Object(b.jsxs)(o.y,{children:["group"===n.type?Object(b.jsx)("h2",{children:n.conversationName}):Object(b.jsx)(Ct,{nickname:n.conversationName,id:n.id,charToShow:10}),n.latestMessage.sender?Object(b.jsx)("h3",{children:n.latestMessage.sender.username}):null,Object(b.jsx)("p",{children:"TEXT"===n.latestMessage.payloadType?n.latestMessage.textPayload:a===n.latestMessage.sender.id?(t=n.latestMessage,c.formatMessage({id:"components.conversation.me-file-string"},{fileName:t.fileName})):function(e){return c.formatMessage({id:"components.conversation.other-file-string"},{fileName:e.fileName,name:e.sender.username})}(n.latestMessage)})]}),n.badgeCount>20?Object(b.jsx)(o.d,{slot:"",children:"20+"}):n.badgeCount>0?Object(b.jsx)(o.d,{slot:"",children:n.badgeCount}):null]})},ia=function(e){return function(t,n){var a=n().p2pmessages,r=a.conversations,c=a.messages,s=a.receipts,o=r[e].messages,i=0;return o.forEach((function(t){var n=c[t],a=n.receipts.map((function(e){return s[e]}));a.sort((function(e,t){var n=e.timestamp.getTime(),a=t.timestamp.getTime();return n>a?-1:n<a?1:0})),"read"!==a[0].status&&n.author.id===e&&(i+=1)})),i}},ua=n(181),la=n.n(ua),pa=function(){var e=Object(k.a)();return Object(b.jsxs)("div",{className:la.a["empty-conversations"],children:[Object(b.jsx)(o.q,{icon:I.T}),Object(b.jsx)(o.Y,{className:"ion-padding ion-margin-bottom",children:e.formatMessage({id:"app.conversations.empty-conversations"})})]})},da=n(182),ba=n.n(da),ja=function(){var e,t=Object(N.f)(),n=Object(S.k)(),a=Object(k.a)(),r=Object(u.c)((function(e){return e.contacts.contacts})),c=Object(u.c)((function(e){return e.profile})),s=Object(u.c)((function(e){return e.groups})),i=Object(u.c)((function(e){return e.p2pmessages}));return Object(b.jsxs)(o.G,{children:[Object(b.jsx)(Zn,{noSearch:!0,onChange:function(){}}),Object(b.jsxs)(o.j,{children:[(e=function(e,t){var s=[];if(Object.keys(t.conversations).length>0)for(var o in t.conversations)if(void 0!==r[o]){var i=r[o],u=t.conversations[o].messages[0],l=t.messages[u],p=void 0,d=null;if(l)p={id:l.p2pMessageEntryHash,sender:{id:l.author.id,username:l.author.id===c.id?"You":i.username},payloadType:l.payload.type,textPayload:Object(F.d)(l.payload)?l.payload.payload.payload:void 0,fileName:Object(F.d)(l.payload)?void 0:l.payload.fileName,timestamp:l.timestamp},d={type:"p2p",id:o,conversationName:i.username,latestMessage:p,badgeCount:n(ia(i.id))};else if(t.errMsgs[o][0]){var b=t.errMsgs[o][0];p={id:b.p2pMessageEntryHash,sender:{id:b.author.id,username:b.author.id===c.id?"You":i.username},payloadType:b.payload.type,textPayload:Object(F.d)(b.payload)?b.payload.payload.payload:void 0,fileName:Object(F.d)(b.payload)?void 0:b.payload.fileName,timestamp:b.timestamp},d={type:"p2p",id:o,conversationName:i.username,latestMessage:p,badgeCount:n(ia(i.id))}}d&&s.push(d)}if(Object.keys(e.conversations).length>0){var j=e.messages,m=e.members;Object.keys(e.conversations).forEach((function(t){var r,o=e.conversations[t].messages[0],i=j[o],u=null;if(i)r={id:i.groupMessageId,sender:m[i.author]?{id:m[i.author].id,username:m[i.author].username}:{id:c.id,username:c.username},payloadType:i.payload.type,timestamp:i.timestamp,textPayload:Object(F.d)(i.payload)?i.payload.payload.payload:void 0,fileName:Object(F.d)(i.payload)?void 0:i.payload.fileName},u={id:t,type:"group",conversationName:e.conversations[t].name,latestMessage:r,badgeCount:n(ce(t))};else if(e.errMsgs[t]){var l=e.errMsgs[t][0];r={id:l.groupMessageId,sender:l.author,payloadType:l.payload.type,timestamp:l.timestamp,textPayload:Object(F.d)(l.payload)?l.payload.payload.payload:void 0,fileName:Object(F.d)(l.payload)?void 0:l.payload.fileName},u={id:t,type:"group",conversationName:e.conversations[t].name,latestMessage:r,badgeCount:n(ce(t))}}else r={id:"no message",sender:void 0,payloadType:"TEXT",timestamp:new Date,textPayload:a.formatMessage({id:"app.conversations.no-group-messages"}),fileName:void 0},u={id:t,type:"group",conversationName:e.conversations[t].name,latestMessage:r,badgeCount:n(ce(t))};u&&s.push(u)}))}return s.sort((function(e,t){return e.latestMessage.timestamp.valueOf()<t.latestMessage.timestamp.valueOf()?1:-1})),s}(s,i),Object.keys(e).length>0?Object(b.jsx)(o.z,{className:ba.a.conversation,children:e.map((function(e){return Object(b.jsx)(oa,{conversation:e,myAgentId:c.id,onClick:function(){return function(e){return"group"===e.type?t.push("/g/".concat(e.id)):t.push({pathname:"/u/".concat(e.id),state:{username:e.conversationName}})}(e)}},e.id)}))}):Object(b.jsx)(pa,{})),Object(b.jsx)(o.l,{vertical:"bottom",horizontal:"end",slot:"fixed",children:Object(b.jsx)(o.m,{onClick:function(){t.push({pathname:"/compose",state:{contacts:Object(l.a)({},r)}})},children:Object(b.jsx)(o.q,{icon:I.G})})})]})]})},ma=n(183),fa=n.n(ma),Oa=function(){return Object(b.jsxs)(o.X,{children:[Object(b.jsxs)(o.K,{id:"home",children:[Object(b.jsx)(N.a,{exact:!0,path:"/home",to:"/home/messaging"}),Object(b.jsx)(N.b,{path:"/home/messaging",render:function(){return Object(b.jsx)(ja,{})},exact:!0}),Object(b.jsx)(N.b,{path:"/home/contacts",render:function(){return Object(b.jsx)(ra,{})},exact:!0})]}),Object(b.jsxs)(o.V,{slot:"bottom",className:fa.a["home-tab-bar"],children:[Object(b.jsxs)(o.W,{tab:"messaging",href:"/home/messaging",children:[Object(b.jsx)(o.q,{icon:I.k}),Object(b.jsx)(o.y,{children:Object(b.jsx)(Un.a,{id:"app.home.messaging-tab-bar"})})]}),Object(b.jsxs)(o.W,{tab:"contacts",href:"/home/contacts",children:[Object(b.jsx)(o.q,{icon:I.J}),Object(b.jsx)(o.y,{children:Object(b.jsx)(Un.a,{id:"app.home.contacts-tab-bar"})})]})]})]})},ha=n(77),ga=n.n(ha),ya=Object(a.createContext)([{},function(){},{},function(){}]),va=function(){var e=Object(a.useContext)(ya);if(!e)throw Error("No context found");return e},xa=function(e){var t=e.contact,n=e.onClick;return Object(b.jsx)(o.v,{onClick:function(){return n(t)},lines:"none",children:Object(b.jsx)(Ct,{nickname:t.username,id:t.id})})},_a=function(e){var t=e.char,n=e.contacts,a=va()[1],c=va()[3],s=function(e){c((function(t){return t[e.id]=e,t})),a((function(t){var n=Object(l.a)({},t);return delete n[e.id],n}))};return Object(b.jsxs)(r.a.Fragment,{children:[Object(b.jsx)(o.w,{children:Object(b.jsx)(o.y,{children:t})}),n.map((function(e){return Object(b.jsx)(xa,{contact:e,onClick:s},JSON.stringify(e))}))]},t)},Ea=function(e){var t=e.contacts,n=Object(S.e)(Object.values(t));return Object(b.jsx)(o.z,{className:ga.a["contacts-list"],children:Object.keys(n).map((function(e){var t=n[e];return Object(b.jsx)(_a,{char:e,contacts:t},e)}))})},Ta=n(184),Sa=n.n(Ta),Na=function(){var e=Object(k.a)(),t=Object(N.f)();return Object(b.jsx)(o.p,{className:Sa.a.header,children:Object(b.jsxs)(o.eb,{children:[Object(b.jsx)(o.f,{slot:"start",children:Object(b.jsx)(o.e,{onClick:function(){return t.push({pathname:"/home"})},className:"ion-no-padding",children:Object(b.jsx)(o.q,{slot:"icon-only",icon:I.e})})}),Object(b.jsx)(o.bb,{children:e.formatMessage({id:"app.new-conversation.header-title"})})]})})},Ia=n(143),ka=n.n(Ia),Ma=function(e){var t=e.contacts,n=e.onCloseButtonPress,r=e.onSearch,c=Object(a.useState)(""),s=Object(i.a)(c,2),u=s[0],l=s[1],p=Object(k.a)();return Object(a.useEffect)((function(){r(u)}),[u,r]),Object(b.jsxs)("div",{className:"".concat(ka.a.recipients," ion-padding"),children:[Object(b.jsxs)(o.y,{className:ka.a.to,children:[p.formatMessage({id:"app.new-conversation.to"}),":"]}),Object.values(t).map((function(e){return Object(b.jsxs)(o.h,{children:[Object(b.jsx)(o.y,{children:e.username}),Object(b.jsx)(o.q,{icon:I.p,onClick:function(){return n(e)}})]},JSON.stringify(e))})),Object(b.jsx)(o.u,{type:"text",placeholder:p.formatMessage({id:"app.new-conversation.search-placeholder"}),onIonChange:function(e){return l(e.detail.value)},value:u,debounce:500})]})},wa=function(){var e=Object(S.k)(),t=Object(k.a)(),n=Object(N.f)(),r=Object(N.g)(),c=ut().showErrorToast,s=Object(a.useState)({}),u=Object(i.a)(s,2),p=u[0],d=u[1],j=Object(a.useState)({}),m=Object(i.a)(j,2),f=m[0],O=m[1],h=Object(a.useState)(""),g=Object(i.a)(h,2),y=g[0],v=g[1],x=Object(a.useState)(""),_=Object(i.a)(x,2),E=_[0],T=_[1],M=Object(a.useState)([]),w=Object(i.a)(M,2),R=w[0],P=w[1],G=Object(a.useState)(!1),C=Object(i.a)(G,2),A=C[0],L=C[1];Object(a.useEffect)((function(){v("")}),[p,f]),Object(a.useEffect)((function(){return void 0!==r.state&&d(r.state.contacts),function(){return d({})}}),[r.state]);return Object(b.jsx)(ya.Provider,{value:[p,d,f,O],children:Object(b.jsxs)(o.G,{children:[Object(b.jsx)(o.B,{isOpen:A}),Object(b.jsx)(Na,{}),Object(b.jsxs)(o.j,{className:ga.a.list,children:[Object(b.jsx)(Ma,{contacts:f,onCloseButtonPress:function(e){O((function(t){return delete t[e.id],Object(l.a)({},t)})),d((function(t){return t[e.id]=e,Object(l.a)({},t)}))},onSearch:v}),Object(b.jsx)(Ea,{contacts:Object.values(p).filter((function(e){return e.username.includes(y)}))})]}),1===Object.values(f).length?Object(b.jsxs)("div",{className:ga.a.warning,children:[Object(b.jsx)(o.q,{icon:I.Y,color:"warning",className:ga.a["warning-icon"]}),Object(b.jsx)(o.Y,{color:"warning",children:"Currently, p2p message only gets sent when the receiver is online"})]}):null,Object(b.jsx)(yt,{onSend:function(){var a=Object.values(f);if(1===a.length)""!==E&&(L(!0),e(Object(wt.a)(a[0].id,E,"TEXT",void 0)).then((function(t){!t&&R.length<=0?(L(!1),e(Rt(a[0].id,E,"TEXT",void 0)),n.push({pathname:"/u/".concat(a[0].id),state:{username:a[0].username}})):t||e(Rt(a[0].id,E,"TEXT",void 0)),R.length<=0&&!0===t?(L(!1),n.push({pathname:"/u/".concat(a[0].id),state:{username:a[0].username}})):R.length&&R.forEach((function(t){e(Object(wt.a)(a[0].id,E,"FILE",void 0,t)).then((function(r){!0===r?(L(!1),n.push({pathname:"/u/".concat(a[0].id),state:{username:a[0].username}})):(e(Rt(a[0].id,E,"FILE",void 0,t)),L(!1),n.push({pathname:"/u/".concat(a[0].id),state:{username:a[0].username}}))}))}))}))),""===E&&R.length&&R.forEach((function(t){L(!0),e(Object(wt.a)(a[0].id,E,"FILE",void 0,t)).then((function(r){L(!1),!0===r||(e(Rt(a[0].id,E,"FILE",void 0,t)),L(!1)),n.push({pathname:"/u/".concat(a[0].id),state:{username:a[0].username}})}))}));else if(a.length>1){L(!0);var r=R.map((function(e){return{type:"FILE",payload:{metadata:{fileName:e.metadata.fileName,fileSize:e.metadata.fileSize,fileType:e.metadata.fileType},fileType:e.fileType,fileBytes:e.fileBytes}}}));e(fe(a,E,r)).then((function(e){L(!1),!1!==e&&n.push("/g/".concat(e.groupResult.originalGroupId))}))}else c({message:t.formatMessage({id:"app.new-conversation.no-contacts-toast"})})},onChange:function(e){return T(e)},onFileSelect:function(e){return P(e)}})]})})},Ra=n(185),Pa=n.n(Ra),Ga=function(e){var t=e.popover,n=e.dismiss,r=e.profile,c=Object(a.useState)(!1),s=Object(i.a)(c,2),p=s[0],d=s[1],j=Object(a.useState)(!1),m=Object(i.a)(j,2),f=m[0],O=m[1],h=r.id,g=Object(S.k)(),y=Object(k.a)(),v=Object(u.c)((function(e){return e.profile.username})),x=Object(u.c)((function(e){return e.contacts})),_=x.contacts,E=x.blocked;Object(a.useEffect)((function(){d(h in _),O(h in E)}),[_,E,h]);return Object(b.jsx)(o.H,Object(l.a)(Object(l.a)({},t.event?{event:t.event}:{}),{},{isOpen:t.isVisible,onDidDismiss:n,children:Object(b.jsxs)(o.z,{className:"".concat(Pa.a["popover-list"]),children:[!f&&p?Object(b.jsxs)(o.v,{onClick:function(){g(Et(r)).then((function(e){d(!e)}))},children:[Object(b.jsx)(o.q,{icon:I.M}),Object(b.jsx)(o.y,{className:"ion-padding-start",children:y.formatMessage({id:"app.contacts.remove"})})]}):Object(b.jsxs)(o.v,{disabled:f,onClick:function(){g(vt(r)).then((function(e){d(e)}))},children:[Object(b.jsx)(o.q,{icon:I.K}),Object(b.jsx)(o.y,{className:"ion-padding-start",children:y.formatMessage({id:"app.contacts.add"})})]}),v!==r.username?f?Object(b.jsxs)(o.v,{onClick:function(){g(Tt(r)).then((function(e){O(!e)}))},children:[Object(b.jsx)(o.q,{icon:I.h}),Object(b.jsx)(o.y,{className:"ion-padding-start",children:y.formatMessage({id:"app.contacts.unblock"})})]}):Object(b.jsxs)(o.v,{onClick:function(){g(xt(r)).then((function(e){O(e)}))},children:[Object(b.jsx)(o.q,{icon:I.h}),Object(b.jsx)(o.y,{className:"ion-padding-start",children:y.formatMessage({id:"app.contacts.block"})})]}):null]})}))},Ca=function(e){var t=e.profile,n=Object(a.useState)({isVisible:!1,event:void 0}),r=Object(i.a)(n,2),c=r[0],s=r[1];return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(o.f,{slot:"end",children:Object(b.jsx)(o.e,{onClick:function(e){e.persist(),s({isVisible:!0,event:e})},children:Object(b.jsx)(o.q,{icon:I.x})})}),Object(b.jsx)(Ga,{profile:t,popover:c,dismiss:function(){return s({isVisible:!1,event:void 0})}})]})},Aa=n(123),La=n.n(Aa),Da=function(){var e=Object(a.useRef)(!0),t=Object(N.g)().state,n=Object(N.f)(),r=Object(a.useState)(null),c=Object(i.a)(r,2),s=c[0],u=c[1];return Object(a.useEffect)((function(){return e.current=!0,function(){e.current=!1}}),[]),Object(a.useEffect)((function(){u(t.profile)}),[null===t||void 0===t?void 0:t.profile]),Object(b.jsxs)(o.G,{children:[Object(b.jsxs)(o.p,{className:La.a.header,children:[Object(b.jsxs)(o.eb,{children:[Object(b.jsx)(o.f,{children:Object(b.jsx)(o.e,{onClick:function(){console.log(t),n.push({pathname:(null===t||void 0===t?void 0:t.prev)?t.prev:"/home/contacts"})},className:"ion-no-padding",children:Object(b.jsx)(o.q,{slot:"icon-only",icon:I.e})})}),s?Object(b.jsx)(Ca,{profile:s}):null]}),Object(b.jsx)(o.eb,{className:La.a["profile-toolbar"],children:Object(b.jsx)(o.bb,{className:La.a.nickname,children:s?s.username:""})})]}),Object(b.jsx)(Qt,{id:t.profile.id,nickname:t.profile.username})]})},Ha=n(105),Fa=function(e){return function(t){t({type:Ha.a,language:e})}},Ua=[{language:"English",code:"en"},{language:"\u65e5\u672c\u8a9e",code:"jp"}],Ba=function(){var e=Object(k.a)(),t=Object(u.c)((function(e){return e.language.language})),n=Ua.find((function(e){return e.code===t})),a=Object(S.k)(),r=Object(N.f)();return Object(b.jsxs)(o.z,{children:[Object(b.jsx)(o.A,{children:e.formatMessage({id:"app.settings.language-label"})}),Object(b.jsx)(o.v,{children:Object(b.jsx)(o.P,{onIonChange:function(e){a(Fa(e.detail.value)),r.push("/")},slot:"end",value:n.code,children:Ua.map((function(e){return Object(b.jsx)(o.Q,{value:e.code,children:e.language},e.code)}))})})]})},za=function(e){return function(){var t=Object(O.a)(f.a.mark((function t(n,a,r){var c,s,o;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.callZome,s=Object.keys(e).map((function(t){return Object(D.a)({},t,e[t])})),t.next=4,c({zomeName:g.c.PREFERENCE,fnName:g.a[g.c.PREFERENCE].SET_PREFERENCE,payload:Object.assign.apply(Object,[{}].concat(Object(ae.a)(s)))});case 4:o=t.sent,n({type:Z.a,preference:{readReceipt:o.readReceipt,typingIndicator:o.typingIndicator}});case 6:case"end":return t.stop()}}),t)})));return function(e,n,a){return t.apply(this,arguments)}}()},qa=function(){var e=Object(u.c)((function(e){return e.preference})),t=e.typingIndicator,n=e.readReceipt,a=Object(S.k)(),r=Object(k.a)();return Object(b.jsxs)(o.z,{children:[Object(b.jsx)(o.A,{children:Object(b.jsx)(o.y,{children:Object(b.jsx)("h1",{children:r.formatMessage({id:"app.settings.preference-label"})})})}),Object(b.jsxs)(o.v,{children:[Object(b.jsx)(o.y,{children:r.formatMessage({id:"app.settings.typing-indicator-label"})}),Object(b.jsx)(o.db,{checked:t,onIonChange:function(){return a(za({typingIndicator:!t}))}})]}),Object(b.jsxs)(o.v,{children:[Object(b.jsx)(o.y,{children:r.formatMessage({id:"app.settings.read-receipt-label"})}),Object(b.jsx)(o.db,{checked:n,onIonChange:function(){return a(za({readReceipt:!n}))}})]})]})},Ya=function(){var e=Object(N.f)();return Object(b.jsx)(o.p,{children:Object(b.jsx)(o.eb,{children:Object(b.jsx)(o.f,{slot:"start",children:Object(b.jsx)(o.e,{onClick:function(){return e.push({pathname:"/home"})},className:"ion-no-padding",children:Object(b.jsx)(o.q,{slot:"icon-only",icon:I.e})})})})})},Va=n(186),Za=n.n(Va),Xa=function(){return Object(b.jsxs)(o.G,{children:[Object(b.jsx)(Ya,{}),Object(b.jsxs)(o.j,{className:Za.a["settings-list"],children:[Object(b.jsx)(qa,{}),Object(b.jsx)(Ba,{})]})]})},Ja=function(){var e=Object(a.useState)(!0),t=Object(i.a)(e,2),n=t[0],r=t[1],c=Object(S.k)();return Object(a.useEffect)((function(){c(function(){var e=Object(O.a)(f.a.mark((function e(t,n,a){var r,c,s,o,i,u,p,d,b,j,m,O,x,_,E,T,N;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.callZome,c=a.getAgentId,e.prev=1,e.next=4,r({zomeName:g.c.AGGREGATOR,fnName:g.a[g.c.AGGREGATOR].RETRIEVE_LATEST_DATA});case 4:return s=e.sent,e.next=7,c();case 7:return o=e.sent,i=Object(h.b)(o),console.log("ui latest data",s),t({type:v.a,id:i,nickname:s.userInfo.profile.nickname}),u={},p={},s.addedContacts.forEach((function(e){var t=e.agentPubKey;u[t]={id:t,username:e.profile.nickname}})),s.blockedContacts&&s.blockedContacts.forEach((function(e){var t=e.agentPubKey;p[t]={id:t,username:e.profile.nickname}})),t({type:H.b,contacts:u}),t({type:H.a,blocked:p}),t({type:Z.a,preference:{readReceipt:s.globalPreference.readReceipt,typingIndicator:s.globalPreference.typingIndicator}}),d=U(s.latestGroupMessages),b=s.groups.map((function(e){return{originalGroupId:Object(h.b)(e.groupId),originalGroupRevisionId:Object(h.b)(e.groupRevisionId),name:e.latestName,members:e.members.map((function(e){return Object(h.b)(e)})),createdAt:Object(S.j)(e.created),creator:Object(h.b)(e.creator),messages:d.messagesByGroup[Object(h.b)(e.groupId)],pinnedMessages:[]}})),j=s.memberProfiles.map((function(e){return{id:e.agentPubKey,username:e.profile.nickname}})),m=n().groups.conversations,b.forEach((function(e){m[e.originalGroupId]=e})),O=n().groups.messages,O=Object(l.a)(Object(l.a)({},O),d.groupMessagesContents),x=n().groups.members,j.forEach((function(e){x[e.id]=e})),t({type:q.k,messages:O,conversations:m,members:x}),_=Object(l.a)({},n().contacts.contacts),E=Object(l.a)({},n().profile),T=Object(l.a)(Object(l.a)({},_),{},Object(D.a)({},E.id,{id:E.id,username:E.username})),N=Object(V.a)(s.latestP2pMessages,T),t(Object(Y.a)(N)),e.abrupt("return",null);case 36:e.prev=36,e.t0=e.catch(1),t(Object(y.a)("TOAST",{},{id:"redux.err.generic"}));case 39:case"end":return e.stop()}}),e,null,[[1,36]])})));return function(t,n,a){return e.apply(this,arguments)}}()).then((function(e){return r(!1)}))}),[]),n?Object(b.jsx)(j,{}):Object(b.jsxs)(o.U,{contentId:"main",children:[Object(b.jsx)(L,{}),Object(b.jsx)(o.K,{id:"main",children:Object(b.jsxs)(N.d,{children:[Object(b.jsx)(N.b,{path:"/home",render:function(){return Object(b.jsx)(Oa,{})}}),Object(b.jsx)(N.b,{path:"/compose",exact:!0,component:wa}),Object(b.jsx)(N.b,{path:"/settings",exact:!0,component:Xa}),Object(b.jsx)(N.b,{path:"/g/:group",component:Fn}),Object(b.jsx)(N.b,{path:"/u/:id",component:ln}),Object(b.jsx)(N.b,{path:"/p/:id",exact:!0,component:Da}),Object(b.jsx)(N.b,{path:"/blocked",exact:!0,component:X}),Object(b.jsx)(N.a,{from:"/",to:"/home"})]})})]})},Ka=n(106),Qa=n(124),Wa=n.n(Qa),$a=function(){var e=Object(N.f)();return Object(b.jsx)(o.G,{children:Object(b.jsx)(o.j,{fullscreen:!0,children:Object(b.jsxs)("div",{className:Wa.a.landing,children:[Object(b.jsx)(o.r,{src:"assets/icon/kizuna_logo.png",className:Wa.a.logo}),Object(b.jsx)("div",{className:Wa.a.actions,children:Object(b.jsx)(o.J,{children:Object(b.jsx)(o.e,{onClick:function(){return e.push({pathname:"/register"})},className:"ion-margin-bottom",children:Object(b.jsx)(Un.a,{id:"app.landing.register"})})})})]})})})},er=n(94),tr=n.n(er),nr=function(){var e=Object(a.useState)(""),t=Object(i.a)(e,2),n=t[0],r=t[1],c=Object(k.a)(),s=Object(N.f)();return Object(b.jsxs)(o.G,{children:[Object(b.jsx)(o.p,{children:Object(b.jsx)(o.eb,{className:tr.a.toolbar,children:Object(b.jsx)(o.f,{slot:"start",children:Object(b.jsx)(o.e,{onClick:function(){return s.push({pathname:"/"})},className:"ion-no-padding",children:Object(b.jsx)(o.q,{slot:"icon-only",icon:I.e})})})})}),Object(b.jsx)(o.j,{children:Object(b.jsxs)("div",{className:tr.a.login,children:[Object(b.jsx)("div",{className:tr.a.form,children:Object(b.jsxs)("div",{children:[Object(b.jsx)(o.y,{className:tr.a.label,children:c.formatMessage({id:"app.login.username-label"})}),Object(b.jsx)(o.u,{value:n,onIonChange:function(e){return r(e.detail.value)},placeholder:c.formatMessage({id:"app.login.username-placeholder"})})]})}),Object(b.jsx)(o.e,{onClick:function(){},children:c.formatMessage({id:"app.login.login"})})]})}),Object(b.jsx)(o.B,{isOpen:!1})]})},ar=n(195),rr=n(95),cr=n.n(rr),sr=function(e){var t=e.error,n=e.className,r=Object(ar.a)(e,["error","className"]),c=Object(a.useState)(!1),s=Object(i.a)(c,2),u=s[0],p=s[1];return Object(a.useEffect)((function(){p(!!t)}),[t]),Object(b.jsxs)(o.x,{children:[Object(b.jsx)(o.u,Object(l.a)({className:"".concat(cr.a.input," ").concat(u?cr.a["error-input"]:""," ").concat(n)},r)),Object(b.jsx)("div",{className:cr.a["error-container"],children:u?Object(b.jsx)(o.y,{color:"danger",className:"ion-text-wrap ".concat(cr.a.error),children:t}):null})]})},or=n(96),ir=n.n(or),ur=function(){var e=Object(a.useState)(""),t=Object(i.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(null),s=Object(i.a)(c,2),u=s[0],l=s[1],p=Object(a.useState)(!1),d=Object(i.a)(p,2),j=d[0],m=d[1],f=Object(S.k)(),O=Object(k.a)();return Object(b.jsxs)(o.G,{children:[Object(b.jsx)(o.p,{children:Object(b.jsx)(o.eb,{className:ir.a.toolbar,children:Object(b.jsx)(o.f,{slot:"start",children:Object(b.jsx)(o.c,{defaultHref:"/"})})})}),Object(b.jsxs)(o.j,{children:[Object(b.jsxs)("div",{className:ir.a.register,children:[Object(b.jsx)("div",{className:ir.a.form,children:Object(b.jsxs)("div",{children:[Object(b.jsx)(o.y,{className:ir.a.label,children:O.formatMessage({id:"app.register.username-label"})}),Object(b.jsx)(sr,{value:n,onIonChange:function(e){var t;r(e.detail.value),l((t=e.detail.value,/^[a-zA-Z0-9_](?!.*?[._]{2})[a-zA-Z0-9_.]{2,15}$/.test(t)&&e.detail.value.length>=3?null:O.formatMessage({id:"app.register.error-invalid-username"})))},placeholder:O.formatMessage({id:"app.register.username-placeholder"}),error:u,debounce:600})]})}),Object(b.jsx)(o.e,{onClick:function(){m(!0),f(x(n)).then((function(e){e||m(!1)}))},disabled:!!u,children:O.formatMessage({id:"app.register.register"})})]}),Object(b.jsx)(o.B,{isOpen:j})]})]})},lr=function(){return Object(b.jsxs)(Ka.a,{children:[Object(b.jsx)(N.b,{path:"/",component:$a}),Object(b.jsx)(N.b,{path:"/register",component:ur}),Object(b.jsx)(N.b,{path:"/login",component:nr})]})},pr=function(){var e=Object(u.c)((function(e){return e.profile})).username,t=Object(a.useState)(!0),n=Object(i.a)(t,2),r=n[0],c=n[1],s=Object(S.k)();return Object(a.useEffect)((function(){s(_()).then((function(e){c(!1)}))}),[s]),r?Object(b.jsx)(j,{}):null!==e?Object(b.jsx)(Ja,{}):Object(b.jsx)(lr,{})};Object(o.nb)({mode:"md"});var dr=function(){return Object(b.jsx)(pr,{})},br=function(e){var t=e.children,n=Object(u.c)((function(e){return e.error.errors})),r=ut().showErrorToast,c=Object(S.k)(),s=Object(k.a)();return Object(a.useEffect)((function(){if(n.length>0){var e=n[0],t=e.intl?{message:s.formatMessage({id:e.intl.id},e.intl.value)}:{};r(Object(l.a)(Object(l.a)({},e.options),t)),c(Object(y.b)())}}),[n,c,s,r]),Object(b.jsx)(b.Fragment,{children:t})},jr=n(292),mr=n(70),fr=n.n(mr),Or=function(){var e=Object(a.useState)(0),t=Object(i.a)(e,2),n=t[0],r=t[1],c=Object(S.k)(),s=[{language:"English",code:"en"},{language:"Japanese",code:"jp"}];return Object(b.jsx)(o.G,{children:Object(b.jsxs)("div",{className:fr.a.page,children:[Object(b.jsx)("div",{className:fr.a["language-container"],children:s.map((function(e,t){var a=e.language;return Object(b.jsx)(o.Y,{className:"".concat(fr.a.language).concat(n===t?" ".concat(fr.a.selected):""),onClick:function(){return r(t)},children:Object(b.jsx)("p",{children:a})},a)}))}),Object(b.jsx)("div",{className:fr.a["button-container"],children:Object(b.jsx)(o.e,{onClick:function(){c(Fa(s[n].code))},className:"".concat(fr.a.button),children:"Select"})})]})})},hr={en:n(187),jp:n(188)},gr=function(e){var t=e.children,n=Object(S.k)(),a=Object(u.c)((function(e){var t=e.language.language;if(t)return t;var a=localStorage.getItem("language");return a&&n(Fa(a)),null}));return a?Object(b.jsx)(jr.a,{messages:hr[a],defaultLocale:"en",locale:"en",children:t}):Object(b.jsx)(Or,{})},yr=function(e){var t=e.children;return Object(b.jsx)(o.a,{children:t})},vr=n(80),xr=function(e){var t=e.children;return Object(b.jsx)(Ka.a,{children:t})},_r=function(e){var t=e.children,n=Object(a.useState)(!1),r=Object(i.a)(n,2),c=r[0],s=r[1],p=Object(a.useState)(!1),d=Object(i.a)(p,2),j=d[0],m=d[1],f=Object(u.c)((function(e){return e.language.language})),O=Object(a.useState)({}),h=Object(i.a)(O,2),g=h[0],y=h[1];Object(a.useEffect)((function(){s(j)}),[j]);var v=function(){m(!1),s(!1)};function x(e){return void 0!==e.split}Object(a.useEffect)((function(){j||y({})}),[j]);return Object(b.jsxs)(it.Provider,{value:{showToast:function(e){y(e),m(!0)},dismissToast:v,showErrorToast:function(e){if("en"===f){var t=null===e||void 0===e?void 0:e.message;if(t){var n=x(t)?160*t.split(" ").length:160*t.value.split(" ").length;y(Object(l.a)({color:"danger",duration:n},e))}}else if("jp"===f){var a=null===e||void 0===e?void 0:e.message;if(a){var r=x(a)?100*Object(ae.a)(a).length:100*Object(ae.a)(a.value).length;y(Object(l.a)({color:"danger",duration:r},e))}}else y(Object(l.a)({color:"danger"},e));m(!0)}},children:[Object(b.jsx)(o.cb,Object(l.a)({isOpen:c,onDidDismiss:v,duration:1500},g)),t]})},Er=function(e){var t=e.children;return Object(b.jsx)(vr.a,{children:Object(b.jsx)(yr,{children:Object(b.jsx)(xr,{children:Object(b.jsx)(gr,{children:Object(b.jsx)(_r,{children:Object(b.jsx)(br,{children:t})})})})})})};n(241);s.a.render(Object(b.jsx)(Er,{children:Object(b.jsx)(dr,{})}),document.getElementById("root"))}],[[242,3,4]]]);
//# sourceMappingURL=main.5540699b.chunk.js.map